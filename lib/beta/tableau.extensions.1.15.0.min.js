(()=>{var e={1808:e=>{!function(){var t=new RegExp("^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$","i");function r(e){for(var t="",r=0;r<e;r++)t+=(65536*(1+Math.random())|0).toString(16).substring(1);return t}function a(e){if(!e)throw new TypeError("Invalid argument; `value` has no value.");this.value=a.EMPTY,e&&e instanceof a?this.value=e.toString():e&&"[object String]"===Object.prototype.toString.call(e)&&a.isGuid(e)&&(this.value=e),this.equals=function(e){return a.isGuid(e)&&this.value==e},this.isEmpty=function(){return this.value===a.EMPTY},this.toString=function(){return this.value},this.toJSON=function(){return this.value}}a.EMPTY="00000000-0000-0000-0000-000000000000",a.isGuid=function(e){return e&&(e instanceof a||t.test(e.toString()))},a.create=function(){return new a([r(2),r(1),r(1),r(1),r(3)].join("-"))},a.raw=function(){return[r(2),r(1),r(1),r(1),r(3)].join("-")},e.exports?e.exports=a:"undefined"!=typeof window&&(window.Guid=a)}()},6416:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(7112);class n extends i.TableauEvent{constructor(e){super(a.TableauEventType.DashboardLayoutChanged),this._dashboardLayoutChangeDetails=e}get dashboardLayoutChangeDetails(){return this._dashboardLayoutChangeDetails}}t.DashboardLayoutChangedEvent=n},1672:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(5136),n=r(4144);class s extends n.TableauWorksheetEvent{constructor(e,t,r){super(a.TableauEventType.FilterChanged,e),this._fieldName=t,this._fieldId=r}get fieldName(){return this._fieldName}get fieldId(){return this._fieldId}getFilterAsync(){return this._worksheet.getFiltersAsync().then((e=>{const t=this.fieldId?e.find((e=>e.fieldId===this.fieldId),this):e.find((e=>e.fieldName===this.fieldName),this);if(!t)throw new i.TableauError(a.ErrorCodes.MissingFilter,`cannot find filter: ${this._fieldName}`);return t}))}}t.FilterChangedEvent=s},5572:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(4144);class n extends i.TableauWorksheetEvent{constructor(e){super(a.TableauEventType.MarkSelectionChanged,e)}getMarksAsync(){return this.worksheet.getSelectedMarksAsync()}}t.MarksSelectedEvent=n},864:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(5136),n=r(4592),s=r(3848),o=r(3248);class l extends o.TableauSheetEvent{constructor(e,t){super(a.TableauEventType.ParameterChanged,t),this._globalFieldName=e}getParameterAsync(){return i.ApiServiceRegistry.get(s.ExtensionsRegistryId).getService("parameters-service").findParameterByGlobalFieldNameAsync(this._globalFieldName).then((e=>{if(void 0===e)throw new i.TableauError(a.ErrorCodes.MissingParameter,`Cannot find parameter: ${this._globalFieldName}`);return new n.Parameter(e,this.sheet)}))}}t.ParameterChangedEvent=l},3464:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(4144);class n extends i.TableauWorksheetEvent{constructor(e){super(a.TableauEventType.SummaryDataChanged,e)}}t.SummaryDataChangedEvent=n},7112:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableauEvent=class{constructor(e){this._type=e}get type(){return this._type}}},3248:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7112);class i extends a.TableauEvent{constructor(e,t){super(e),this._sheet=t}get sheet(){return this._sheet}}t.TableauSheetEvent=i},4144:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(3248);class i extends a.TableauSheetEvent{constructor(e,t){super(e,t),this._worksheet=t}get worksheet(){return this._worksheet}}t.TableauWorksheetEvent=i},4164:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(7112);class n extends i.TableauEvent{constructor(e){super(a.TableauEventType.WorkbookFormattingChanged),this._formatting=e}get formatting(){return this._formatting}}t.WorkbookFormattingChangedEvent=n},4712:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(4144);class n extends i.TableauWorksheetEvent{constructor(e,t){super(a.TableauEventType.WorksheetFormattingChanged,e),this._formatting=t}get formatting(){return this._formatting}}t.WorksheetFormattingChangedEvent=n},92:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BentonSansFontFamilyName="Benton Sans",t.BentonSansLowDPIFontFamilyName="Benton Sans Low-DPI",t.BentonSansBookFontFaceName="Benton Sans Book",t.BentonSansBookItalicFontFaceName="Benton Sans Book Italic",t.BentonSansSemiDemiFontFaceName="Benton Sans SemiDemi",t.BentonSansSemiDemiItalicFontFaceName="Benton Sans SemiDemi Italic",t.BentonSansLightFontFaceName="Benton Sans Light",t.BentonSansMediumFontFaceName="Benton Sans Medium",t.SupportedBentonSansFontFaces=[t.BentonSansBookFontFaceName,t.BentonSansBookItalicFontFaceName,t.BentonSansSemiDemiFontFaceName,t.BentonSansSemiDemiItalicFontFaceName,t.BentonSansLightFontFaceName,t.BentonSansMediumFontFaceName]},8396:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectedServer=class{constructor(e,t,r,a){this._userId=e,this._siteId=t,this._siteNamespace=r,this._workbookId=a}get userId(){return this._userId}get siteId(){return this._siteId}get siteNamespace(){return this._siteNamespace}get workbookId(){return this._workbookId}}},5920:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(5136),i=r(3848);class n extends a.WorkbookImpl{getAllDataSourcesAsync(){return a.ApiServiceRegistry.get(i.ExtensionsRegistryId).getService("data-source-service").getAllDataSourcesAsync().then((e=>{const t=e,r=[];return Object.values(t.dataSources).forEach((e=>{r.push(this.createDataSourceFromInfo(e))})),r}))}createDataSourceFromInfo(e){const t=new a.DataSourceImpl(e,i.ExtensionsRegistryId),r=new a.DataSource(t);return t.initializeWithPublicInterfaces(r),r}}t.ExtensionWorkbookImpl=n},976:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(3448),n=r(5136),s=r(4252),o=r(9224),l=r(5548),d=r(893),c=r(520),u=r(3032),h=r(1964),p=r(8012),m=r(7e3),g=r(6616),y=r(3848),I=r(92),v=r(5920),S=r(7269),T=r(5436),b=r(2200),f=r(1024);t.ExtensionsImpl=class{initializeAsync(e,t){return this._initializationPromise||(this._initializationPromise=new Promise(((r,a)=>{var s;const o={isAlpha:n.ApiVersion.Instance.isAlpha};if(S.LegacyInternalApiDispatcherHolder.hasDesktopApiDispatcherPromise(o))null===(s=S.LegacyInternalApiDispatcherHolder.getDesktopDispatcherPromise(o))||void 0===s||s.then((r=>this.onDispatcherReceived(r,e,t))).then((e=>{r(e)})).catch((e=>{a(e)}));else{const s=this.onDispatcherReceived.bind(this);n.doCrossFrameBootstrap(window,i.INTERNAL_CONTRACT_VERSION,o).then((r=>s(r,e,t))).then((e=>{r(e)})).catch((e=>{a(e)}))}}))),this._initializationPromise}createVizImageAsync(e){return n.ApiServiceRegistry.get(y.ExtensionsRegistryId).getService("viz-service").createVizImageAsync(e)}setClickThroughAsync(e){return n.ApiServiceRegistry.get(y.ExtensionsRegistryId).getService("UIService").setClickThroughAsync(e,this.extensionZoneId)}isDashboardExtensionLocator(e){if(!e.dashboardPath)throw new n.TableauError(a.ErrorCodes.InternalError,"Unexpected error during initialization.");return!0}onDispatcherReceived(e,t,r){let a=e(i.INTERNAL_CONTRACT_VERSION);g.registerInitializationExtensionsServices(a);const s=n.ApiServiceRegistry.get(y.ExtensionsRegistryId).getService("InitializationService"),l=r?Object.keys(r):[];return s.initializeDashboardExtensionsAsync(t,l).then((e=>{const t=e.extensionEnvironment.platformVersion?e.extensionEnvironment.platformVersion:{major:1,minor:9,fix:0};return n.VersionedExternalApiDispatcher.needsVersionConverter(t)&&(a=new n.VersionedExternalApiDispatcher(a,t)),n.registerAllSharedServices(a,y.ExtensionsRegistryId),g.registerAllExtensionsServices(a),e.extensionDashboardInfo&&this.isDashboardExtensionLocator(e.extensionInstance.locator)&&(this.dashboardContent=this.initializeDashboardContent(e.extensionDashboardInfo,e.extensionInstance.locator.dashboardPath),this.extensionZoneId=e.extensionDashboardInfo.extensionZoneId),e.extensionWorksheetInfo&&(this.worksheetContent=this.initializeWorksheetContent(e.extensionWorksheetInfo)),this.environment=new c.Environment(e.extensionEnvironment),this.settings=this.initializeSettings(e.extensionSettingsInfo),this.ui=new h.UI(new f.UIImpl),this.workbook=new o.Workbook(new v.ExtensionWorkbookImpl),e.extensionEnvironment.workbookFormatting&&(this.initializeTableauFonts(a,e.extensionEnvironment.workbookFormatting),this.applyAllFormatting(e.extensionEnvironment.workbookFormatting)),this.initializeContextMenuCallbacks(r),this.initializeWorkbookFormattingChangedEventCallback(a),e.extensionDialogPayload}))}applyAllFormatting(e){if(this._styleElement||(this._styleElement=document.createElement("style"),this._styleElement.id="Tableau-Extension-Formatting",document.head.appendChild(this._styleElement)),!this._styleElement.sheet||!e)return;const t=this._styleElement.sheet;for(;t.cssRules.length>0;)t.deleteRule(t.cssRules.length-1);e.formattingSheets.map((e=>{this.applyFormattingSheetToStyleSheet(e,t)}))}applyFormattingSheetToStyleSheet(e,t){let r="";const a=e.cssProperties;a.fontFamily&&(r+="font-family: "+a.fontFamily.toString()+"; "),a.fontSize&&(r+="font-size: "+a.fontSize.toString()+"; "),a.fontWeight&&(r+="font-weight: "+a.fontWeight.toString()+"; "),a.fontStyle&&(r+="font-style: "+a.fontStyle.toString()+"; "),a.textDecoration&&(r+="text-decoration: "+a.textDecoration.toString()+"; "),a.color&&(r+="color: "+a.color+"; ");const i="."+e.classNameKey+" { "+r+" }";t.insertRule(i,t.cssRules.length)}initializeWorkbookFormattingChangedEventCallback(e){n.ApiServiceRegistry.get(y.ExtensionsRegistryId).getService("notification-service").registerHandler(i.NotificationId.WorkbookFormattingChanged,(()=>!0),(t=>{t&&(this.initializeTableauFonts(e,t),this.applyAllFormatting(t))}))}initializeTableauFonts(e,t){const r=[...I.SupportedBentonSansFontFaces,...b.SupportedTableauFontFaces];if(t.formattingSheets.forEach((e=>{e.cssProperties.fontFamily&&r.push(e.cssProperties.fontFamily)})),r.length>0){const t={[i.ParameterId.FontNameListItems]:r};e.execute(i.VerbId.GetFonts,t).then((e=>{this.loadFonts(e.result)})).catch()}}loadFonts(e){e.forEach((e=>{b.SupportedTableauFontFaces.includes(e.fontName)?this.loadTableauFonts(e):I.SupportedBentonSansFontFaces.includes(e.fontName)?this.loadBentonSansFonts(e):document.fonts.add(new FontFace(e.fontName,e.fontBinaryInfo))}))}initializeDashboardContent(e,t){const r=new n.SheetInfoImpl(e.name,a.SheetType.Dashboard,{width:e.size.w,height:e.size.h},void 0,!0),i=new n.DashboardImpl(r,e.zones,t,y.ExtensionsRegistryId,null,e.activeDashboardObjectId),o=new s.Dashboard(i);return new d.DashboardContent(o)}initializeWorksheetContent(e){const t=new n.SheetInfoImpl(e.visualId.worksheet,a.SheetType.Worksheet,{width:e.size.w,height:e.size.h},void 0,!0),r=new n.WorksheetImpl(t,y.ExtensionsRegistryId,e.visualId,null,null,e.backgroundColor,p.WorkbookFormattingEnvUtil.convertToWorkbookFormatting(e.formatting)),i=new l.Worksheet(r);return new m.WorksheetContent(i)}initializeSettings(e){const t=new T.SettingsImpl(e);return new u.Settings(t)}initializeContextMenuCallbacks(e){n.ApiServiceRegistry.get(y.ExtensionsRegistryId).getService("notification-service").registerHandler(i.NotificationId.ContextMenuClick,(()=>!0),(t=>{if(e){if(!e[t.id])throw new n.TableauError(a.ErrorCodes.InternalError,`Received unexpected context menu Id from event: ${t.id}`);e[t.id]()}}))}loadTableauFonts(e){switch(e.fontName){case b.TableauBookFontFaceName:document.fonts.add(new FontFace(b.TableauBookFontFamilyName,e.fontBinaryInfo,{weight:"normal",style:"normal"}));break;case b.TableauLightFontFaceName:document.fonts.add(new FontFace(b.TableauLightFontFamilyName,e.fontBinaryInfo,{weight:"normal",style:"normal"}));break;case b.TableauRegularFontFaceName:document.fonts.add(new FontFace(b.TableauRegularFontFamilyName,e.fontBinaryInfo,{weight:"normal",style:"normal"}));break;case b.TableauSemiBoldFontFaceName:document.fonts.add(new FontFace(b.TableauSemiboldFontFamilyName,e.fontBinaryInfo,{weight:"normal",style:"normal"})),document.fonts.add(new FontFace(b.TableauRegularFontFamilyName,e.fontBinaryInfo,{weight:"bold",style:"normal"}));break;case b.TableauBoldFontFaceName:document.fonts.add(new FontFace(b.TableauBoldFontFamilyName,e.fontBinaryInfo,{weight:"normal",style:"normal"})),document.fonts.add(new FontFace(b.TableauBoldFontFamilyName,e.fontBinaryInfo,{weight:"bold",style:"normal"})),document.fonts.add(new FontFace(b.TableauMediumFontFamilyName,e.fontBinaryInfo,{weight:"bold",style:"normal"})),document.fonts.add(new FontFace(b.TableauSemiboldFontFamilyName,e.fontBinaryInfo,{weight:"bold",style:"normal"}));break;case b.TableauMediumFontFaceName:document.fonts.add(new FontFace(b.TableauMediumFontFamilyName,e.fontBinaryInfo,{weight:"normal",style:"normal"})),document.fonts.add(new FontFace(b.TableauLightFontFamilyName,e.fontBinaryInfo,{weight:"bold",style:"normal"})),document.fonts.add(new FontFace(b.TableauBookFontFamilyName,e.fontBinaryInfo,{weight:"bold",style:"normal"}));break;default:throw new n.TableauError(a.ErrorCodes.InternalError,`'attempted to load unsupported font: ${e.fontName}.'`)}}loadBentonSansFonts(e){switch(e.fontName){case I.BentonSansBookFontFaceName:document.fonts.add(new FontFace(I.BentonSansFontFamilyName,e.fontBinaryInfo,{weight:"normal",style:"normal"})),document.fonts.add(new FontFace(I.BentonSansLowDPIFontFamilyName,e.fontBinaryInfo,{weight:"100",style:"normal"}));break;case I.BentonSansLightFontFaceName:document.fonts.add(new FontFace(I.BentonSansFontFamilyName,e.fontBinaryInfo,{weight:"100",style:"normal"}));break;case I.BentonSansMediumFontFaceName:document.fonts.add(new FontFace(I.BentonSansFontFamilyName,e.fontBinaryInfo,{weight:"bold",style:"normal"})),document.fonts.add(new FontFace(I.BentonSansLowDPIFontFamilyName,e.fontBinaryInfo,{weight:"bold",style:"normal"}));break;case I.BentonSansSemiDemiFontFaceName:document.fonts.add(new FontFace(I.BentonSansLowDPIFontFamilyName,e.fontBinaryInfo,{weight:"normal",style:"normal"}));break;case I.BentonSansBookItalicFontFaceName:document.fonts.add(new FontFace(I.BentonSansFontFamilyName,e.fontBinaryInfo,{style:"italic"}));break;case I.BentonSansSemiDemiItalicFontFaceName:document.fonts.add(new FontFace(I.BentonSansLowDPIFontFamilyName,e.fontBinaryInfo,{style:"italic"}));break;default:throw new n.TableauError(a.ErrorCodes.InternalError,`'attempted to load unsupported font: ${e.fontName}.'`)}}}},7269:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(3448);!function(e){function t(e){var t;return e&&void 0!==e.isAlpha||window.__warningIssued?(null===(t=e)||void 0===t?void 0:t.isAlpha)&&window.__platformIsOfficialRelease&&window.__tableauDesktopDispatcher.then((e=>{e(a.INTERNAL_CONTRACT_VERSION).execute(a.VerbId.BlockExtension,{}).catch()})).catch():(console.warn("This is a beta version of the Extensions API. Please upgrade to an official release."),window.__warningIssued=!0),window.__tableauDesktopDispatcher}e.getDesktopDispatcherPromise=t,e.hasDesktopApiDispatcherPromise=function(e){return!!t(e)}}(t.LegacyInternalApiDispatcherHolder||(t.LegacyInternalApiDispatcherHolder={}))},5436:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(3448),n=r(5136),s=r(7112),o=r(3848);class l extends s.TableauEvent{constructor(e){super(a.TableauEventType.SettingsChanged),this._newSettings=e}get newSettings(){return this._newSettings}}class d{constructor(e){this._saveInProgress=!1,this.initializeSettings(e)}erase(e){n.ErrorHelpers.verifyParameter(e,"key"),this._currentSettings[e]&&(this.verifySettingsAreUnlocked(),delete this._currentSettings[e],this._isModified=!0)}get(e){return n.ErrorHelpers.verifyParameter(e,"key"),this._currentSettings[e]}getAll(){return Object.assign({},this._currentSettings)}get isModified(){return this._isModified}saveAsync(){return this.verifySettingsAreUnlocked(),this._isModified?(this._saveInProgress=!0,n.ApiServiceRegistry.get(o.ExtensionsRegistryId).getService("SettingsService").saveSettingsAsync(this._currentSettings).then((e=>(this._saveInProgress=!1,this._isModified=!1,void 0===this._currentSettings?this._currentSettings=e:Object.assign(this._currentSettings,e),e)),(e=>(this._saveInProgress=!1,Promise.reject(e))))):Promise.resolve(this._currentSettings)}set(e,t){n.ErrorHelpers.verifyStringParameter(e,"key"),n.ErrorHelpers.verifyParameter(t,"value"),this.verifySettingsAreUnlocked(),this._currentSettings[e]=t,this._isModified=!0}initializeEvents(){const e=new Array;let t;try{t=n.ApiServiceRegistry.get(o.ExtensionsRegistryId).getService("notification-service")}catch(t){return e}const r=new n.SingleEventManagerImpl(a.TableauEventType.SettingsChanged);return t.registerHandler(i.NotificationId.SettingsChanged,(()=>!0),(e=>{this._currentSettings=e.newSettings,r.triggerEvent((()=>new l(e.newSettings)))})),e.push(r),e}initializeSettings(e){n.ErrorHelpers.verifyParameter(e,"settingsInfo"),n.ErrorHelpers.verifyParameter(e.settingsValues,"settingsInfo.SettingsValues"),this._currentSettings=e.settingsValues,this._isModified=!1}verifySettingsAreUnlocked(){if(this._saveInProgress)throw new n.TableauError(a.ErrorCodes.SettingSaveInProgress,d.ASYNC_SAVE_IN_PROGRESS)}}t.SettingsImpl=d,d.ASYNC_SAVE_IN_PROGRESS="Async Save is in progress, updating settings is not allowed."},2200:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableauBookFontFamilyName="Tableau Book",t.TableauLightFontFamilyName="Tableau Light",t.TableauRegularFontFamilyName="Tableau Regular",t.TableauMediumFontFamilyName="Tableau Medium",t.TableauSemiboldFontFamilyName="Tableau Semibold",t.TableauBoldFontFamilyName="Tableau Bold",t.TableauBookFontFaceName="Tableau Book",t.TableauBoldFontFaceName="Tableau Bold",t.TableauLightFontFaceName="Tableau Light",t.TableauMediumFontFaceName="Tableau Medium",t.TableauRegularFontFaceName="Tableau Regular",t.TableauSemiBoldFontFaceName="Tableau Semi Bold",t.SupportedTableauFontFaces=[t.TableauBookFontFaceName,t.TableauBoldFontFaceName,t.TableauLightFontFaceName,t.TableauMediumFontFaceName,t.TableauRegularFontFaceName,t.TableauSemiBoldFontFaceName]},1024:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(7419),n=r(3448),s=r(5136),o=r(7112),l=r(3848);class d extends o.TableauEvent{constructor(e){super(a.TableauEventType.DialogMessageReceived),this.message=e}}t.DialogMessageEvent=d,t.UIImpl=class{constructor(){}displayDialogAsync(e,t,r){const o=s.ApiServiceRegistry.get(l.ExtensionsRegistryId).getService("UIService"),d=s.ApiServiceRegistry.get(l.ExtensionsRegistryId).getService("notification-service");return new Promise(((l,c)=>{o.displayDialogAsync(e,t||"",r).then((()=>{const e=d.registerHandler(n.NotificationId.ExtensionDialogUpdate,(()=>!0),(t=>{if(t.isCloseEvent){if(void 0===t.closePayload)throw new s.TableauError(a.ErrorCodes.InternalError,"closePayload is undefined");l(t.closePayload)}else c(new s.TableauError(i.ErrorCodes.DialogClosedByUser,"Extension dialog closed by user."));e()}))})).catch((e=>{c(e)}))}))}sendDialogMessageAsync(e,t){s.ApiServiceRegistry.get(l.ExtensionsRegistryId).getService("UIService").sendDialogMessageAsync(e,t)}closeDialog(e){s.ApiServiceRegistry.get(l.ExtensionsRegistryId).getService("UIService").closeDialog(e)}initializeEvents(){const e=new Array;let t;try{t=s.ApiServiceRegistry.get(l.ExtensionsRegistryId).getService("notification-service")}catch(t){return e}const r=new s.SingleEventManagerImpl(a.TableauEventType.DialogMessageReceived);return t.registerHandler(n.NotificationId.ExtensionDialogMessage,(()=>!0),(e=>{r.triggerEvent((()=>new d(e.message)))})),e.push(r),e}}},4252:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(3448),n=r(5136),s=r(6416),o=r(4164),l=r(3848),d=r(3192),c=r(8512),u=r(5548);class h extends c.Sheet{constructor(e){super(e),this._dashboardImpl=e,e.initializeWithPublicInterfaces(),this.initializeEvents().forEach((e=>this.addNewEventType(e)))}get worksheets(){return this._dashboardImpl.worksheetsImpl.map((e=>new u.Worksheet(e)))}get objects(){return this._dashboardImpl.objects.map((e=>new d.DashboardObject(e)))}get activeDashboardObjectId(){return this._dashboardImpl.activeDashboardObjectId}get activeDashboardName(){return this._dashboardImpl.activeDashboardName}setZoneVisibilityAsync(e){return this._dashboardImpl.setDashboardObjectVisibilityAsync(e)}setDashboardObjectVisibilityAsync(e){return this._dashboardImpl.setDashboardObjectVisibilityAsync(e)}getDashboardObjectById(e){const t=this._dashboardImpl.getDashboardObjectById(e);return t&&new d.DashboardObject(t)}initializeEvents(){const e=new Array;let t;try{t=n.ApiServiceRegistry.get(l.ExtensionsRegistryId).getService("notification-service")}catch(t){return e}const r=new n.SingleEventManagerImpl(a.TableauEventType.DashboardLayoutChanged);t.registerHandler(i.NotificationId.DashboardLayoutChanged,(()=>!0),(e=>{const t=this._dashboardImpl.updateZones(e.zones,e.activeZoneId,e.activeDashboardName);r.triggerEvent((()=>new s.DashboardLayoutChangedEvent(t)))})),e.push(r);const d=new n.SingleEventManagerImpl(a.TableauEventType.WorkbookFormattingChanged);return t.registerHandler(i.NotificationId.WorkbookFormattingChanged,(()=>!0),(e=>{d.triggerEvent((()=>new o.WorkbookFormattingChangedEvent(e)))})),e.push(d),e}moveAndResizeDashboardObjectsAsync(e){return this._dashboardImpl.moveAndResizeDashboardObjectsAsync(e)}replayAnimationAsync(e){return this._dashboardImpl.replayAnimationAsync(e)}getFiltersAsync(){return this._dashboardImpl.getFiltersAsync()}applyFilterAsync(e,t,r,a){return this._dashboardImpl.applyFilterAsync(e,t,r,a)}}t.Dashboard=h},3192:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(4252),i=r(5548);t.DashboardObject=class{constructor(e){this._dashboardObjectImpl=e}get dashboard(){return new a.Dashboard(this._dashboardObjectImpl.dashboardImpl)}get type(){return this._dashboardObjectImpl.type}get position(){return this._dashboardObjectImpl.position}get size(){return this._dashboardObjectImpl.size}get worksheet(){if(this._dashboardObjectImpl.worksheetImpl)return new i.Worksheet(this._dashboardObjectImpl.worksheetImpl)}get name(){return this._dashboardObjectImpl.name}get isFloating(){return this._dashboardObjectImpl.isFloating}get isVisible(){return this._dashboardObjectImpl.isVisible}get id(){return this._dashboardObjectImpl.id}get fieldId(){return this._dashboardObjectImpl.fieldId}}},4592:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(3448),n=r(5136),s=r(864),o=r(3848);class l extends n.EventListenerManager{constructor(e,t){super(),this.parameterImpl=e,this.initializeEvents(t).forEach((e=>this.addNewEventType(e)))}get name(){return this.parameterImpl.name}get currentValue(){return this.parameterImpl.currentValue}get dataType(){return this.parameterImpl.dataType}get allowableValues(){return this.parameterImpl.allowableValues}get id(){return this.parameterImpl.id}changeValueAsync(e){return this.parameterImpl.changeValueAsync(e)}initializeEvents(e){n.ErrorHelpers.verifyInternalValue(e,"sheet");const t=new Array;let r;try{r=n.ApiServiceRegistry.get(o.ExtensionsRegistryId).getService("notification-service")}catch(e){return t}const l=new n.SingleEventManagerImpl(a.TableauEventType.ParameterChanged);return r.registerHandler(i.NotificationId.ParameterChanged,(e=>e===this.parameterImpl.id),(t=>{l.triggerEvent((()=>new s.ParameterChangedEvent(t,e)))})),t.push(l),t}}t.Parameter=l},8512:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(5136),n=r(4592);class s extends i.EventListenerManager{constructor(e){super(),this._sheetImpl=e}get name(){return this._sheetImpl.name}get sheetType(){return this._sheetImpl.sheetType}get size(){if(this.isValidSize(this._sheetImpl.size))return this._sheetImpl.size;throw new i.TableauError(a.EmbeddingErrorCodes.ImplementationError,"Size not implemented")}isValidSize(e){const t=e;return void 0!==t.width&&void 0!==t.height}findParameterAsync(e){return this._sheetImpl.findParameterAsync(e).then((e=>new Promise(e?t=>t(new n.Parameter(e,this)):e=>e(void 0))))}getParametersAsync(){return this._sheetImpl.getParametersAsync().then((e=>e.map((e=>new n.Parameter(e,this)))))}}t.Sheet=s},9224:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Workbook=class{constructor(e){this._workbookImpl=e}getAllDataSourcesAsync(){return this._workbookImpl.getAllDataSourcesAsync()}}},5548:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(7419),n=r(3448),s=r(5136),o=r(1672),l=r(5572),d=r(3464),c=r(4712),u=r(3848),h=r(4252),p=r(8512);class m extends p.Sheet{constructor(e){super(e),this._worksheetImpl=e,this.initializeEvents().forEach((e=>this.addNewEventType(e)))}get parentDashboard(){if(null==this._worksheetImpl.parentDashboard)throw new s.TableauError(a.SharedErrorCodes.ImplementationError,"Parent dashboard not implemented");return new h.Dashboard(this._worksheetImpl.parentDashboard)}get backgroundColor(){if(null==this._worksheetImpl.backgroundColor)throw new s.TableauError(a.SharedErrorCodes.ImplementationError,"Worksheet background color is not available");return this._worksheetImpl.backgroundColor}get formatting(){if(null==this._worksheetImpl.formatting)throw new s.TableauError(a.SharedErrorCodes.ImplementationError,"Worksheet formatting information is not available");return this._worksheetImpl.formatting}initializeEvents(){const e=new Array;let t;try{t=s.ApiServiceRegistry.get(u.ExtensionsRegistryId).getService("notification-service")}catch(t){return e}const r=new s.SingleEventManagerImpl(i.TableauEventType.MarkSelectionChanged);t.registerHandler(n.NotificationId.SelectedMarksChanged,(e=>{const t=e;return this.visualIdsAreEqual(t,this._worksheetImpl.visualId)}),(()=>r.triggerEvent((()=>new l.MarksSelectedEvent(this)))));const a=new s.SingleEventManagerImpl(i.TableauEventType.FilterChanged);t.registerHandler(n.NotificationId.FilterChanged,(e=>{const t=e;return this._worksheetImpl.visualId.worksheet===t.visualId.worksheet}),(e=>{a.triggerEvent((()=>new o.FilterChangedEvent(this,e.fieldName,e.fieldId)))}));const h=new s.SingleEventManagerImpl(i.TableauEventType.SummaryDataChanged);t.registerHandler(n.NotificationId.SummaryDataChanged,(e=>{const t=e;return this._worksheetImpl.visualId.worksheet===t.visualId.worksheet}),(e=>{h.triggerEvent((()=>new d.SummaryDataChangedEvent(this)))}));const p=new s.SingleEventManagerImpl(i.TableauEventType.WorksheetFormattingChanged);return t.registerHandler(n.NotificationId.WorksheetFormattingChanged,(e=>{const t=e;return this._worksheetImpl.visualId.worksheet===t.visualId.worksheet}),(e=>{p.triggerEvent((()=>new c.WorksheetFormattingChangedEvent(this,e)))})),e.push(r),e.push(a),e.push(h),e.push(p),e}applyFilterAsync(e,t,r,a){return this._worksheetImpl.applyFilterAsync(e,t,r,a)}applyRangeFilterAsync(e,t){return this._worksheetImpl.applyRangeFilterAsync(e,t)}applyHierarchicalFilterAsync(e,t,r,a){return this._worksheetImpl.applyHierarchicalFilterAsync(e,t,r,a)}applyRelativeDateFilterAsync(e,t){return this._worksheetImpl.applyRelativeDateFilterAsync(e,t)}clearFilterAsync(e){return this._worksheetImpl.clearFilterAsync(e)}getDataSourcesAsync(){return this._worksheetImpl.getDataSourcesAsync()}getFiltersAsync(){return this._worksheetImpl.getFiltersAsync()}getSelectedMarksAsync(){return this._worksheetImpl.getSelectedMarksAsync()}getHighlightedMarksAsync(){return this._worksheetImpl.getHighlightedMarksAsync()}getSummaryDataAsync(e){return this._worksheetImpl.getSummaryDataAsync(e)}getSummaryDataReaderAsync(e,t){return this._worksheetImpl.getSummaryDataReaderAsync(e,t)}getSummaryColumnsInfoAsync(){return this._worksheetImpl.getSummaryColumnsInfoAsync()}getUnderlyingDataAsync(e){return console.warn("Worksheet.getUnderlyingDataAsync is deprecated. Please use Worksheet.getUnderlyingTablesAsync and Worksheet.getUnderlyingTableDataAsync"),this._worksheetImpl.getUnderlyingDataAsync(e)}getUnderlyingTablesAsync(){return this._worksheetImpl.getUnderlyingTablesAsync()}getUnderlyingTableDataAsync(e,t){return this._worksheetImpl.getUnderlyingTableDataAsync(e,t)}getUnderlyingTableDataReaderAsync(e,t,r){return this._worksheetImpl.getUnderlyingTableDataReaderAsync(e,t,r)}getVisualSpecificationAsync(){return this._worksheetImpl.getVisualSpecificationAsync()}addMarksCardFieldsAsync(e,t,r,a){return this._worksheetImpl.addMarksCardFieldsAsync(e,t,r,a)}moveMarksCardFieldAsync(e,t,r,a=1){return this._worksheetImpl.moveMarksCardFieldAsync(e,t,r,a)}spliceMarksCardFieldsAsync(e,t,r,a,i){return this._worksheetImpl.spliceMarksCardFieldsAsync(e,t,r,a,i)}clearSelectedMarksAsync(){return this._worksheetImpl.clearSelectedMarksAsync()}selectMarksByIDAsync(e,t){return this._worksheetImpl.selectMarksByIdAsync(e,t)}selectMarksByValueAsync(e,t){return this._worksheetImpl.selectMarksByValueAsync(e,t)}selectMarksByIdAsync(e,t){return this._worksheetImpl.selectMarksByIdAsync(e,t)}annotateMarkAsync(e,t){return this._worksheetImpl.annotateMarkAsync(e,t)}getAnnotationsAsync(){return this._worksheetImpl.getAnnotationsAsync()}removeAnnotationAsync(e){return this._worksheetImpl.removeAnnotationAsync(e)}hoverTupleAsync(e,t,r=!0){return this._worksheetImpl.hoverTupleAsync(e,t,r)}selectTuplesAsync(e,t,r){return this._worksheetImpl.selectTuplesAsync(e,t,r)}getTooltipTextAsync(e){return this._worksheetImpl.getTooltipTextAsync(e)}leaveMarkNavigationAsync(){return this._worksheetImpl.leaveMarkNavigationAsync()}editAliasesDialogAsync(e){return this._worksheetImpl.editAliasesDialogAsync(e)}visualIdsAreEqual(e,t){return e&&t&&e.worksheet===t.worksheet&&e.dashboard===t.dashboard&&e.storyboard===t.storyboard&&e.storyPointID===t.storyPointID}}t.Worksheet=m},893:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DashboardContent=class{constructor(e){this._dashboard=e}get dashboard(){return this._dashboard}}},520:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(5136),i=r(8396),n=r(8012);t.Environment=class{constructor(e){this._apiVersion=a.ApiVersion.Instance&&a.ApiVersion.Instance.formattedValue,this._context=a.InternalToExternalEnumMappings.extensionContext.convert(e.extensionContext),this._formatting=n.WorkbookFormattingEnvUtil.convertToWorkbookFormatting(e.workbookFormatting),this._language=e.extensionLanguage,this._country=e.extensionCountry,this._locale=e.extensionLocale,this._mode=a.InternalToExternalEnumMappings.extensionMode.convert(e.extensionMode),this._operatingSystem=e.operatingSystem,this._tableauVersion=e.tableauVersion,this._uniqueUserId=e.uniqueUserId,e.userId&&(this.connectedServer=new i.ConnectedServer(e.userId,e.siteId,e.siteNamespace,e.workbookId),this.featureFlags=e.featureFlags)}get apiVersion(){return this._apiVersion}get context(){return this._context}get workbookFormatting(){return this._formatting}get language(){return this._language}get country(){return this._country}get locale(){return this._locale}get mode(){return this._mode}get operatingSystem(){return this._operatingSystem}get tableauVersion(){return this._tableauVersion}get uniqueUserId(){return this._uniqueUserId}}},5408:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Extensions=class{constructor(e){this.extensionImpl=e,this.extensionImpl=e}get dashboardContent(){return this.extensionImpl.dashboardContent}get worksheetContent(){return this.extensionImpl.worksheetContent}get environment(){return this.extensionImpl.environment}get settings(){return this.extensionImpl.settings}get ui(){return this.extensionImpl.ui}get workbook(){return this.extensionImpl.workbook}get dashboardObjectId(){return this.extensionImpl.extensionZoneId}initializeAsync(e){return this.extensionImpl.initializeAsync(!1,e).then()}initializeDialogAsync(){return this.extensionImpl.initializeAsync(!0)}createVizImageAsync(e){return this.extensionImpl.createVizImageAsync(e)}setClickThroughAsync(e){return this.extensionImpl.setClickThroughAsync(e)}}},3032:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(5136);class i extends a.EventListenerManager{constructor(e){super(),this._settingsImpl=e,this._settingsImpl.initializeEvents().forEach((e=>this.addNewEventType(e)))}erase(e){this._settingsImpl.erase(e)}get(e){return this._settingsImpl.get(e)}getAll(){return this._settingsImpl.getAll()}get isModified(){return this._settingsImpl.isModified}saveAsync(){return this._settingsImpl.saveAsync()}set(e,t){this._settingsImpl.set(e,t)}}t.Settings=i},1964:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(5136);class i extends a.EventListenerManager{constructor(e){super(),this._impl=e,this._impl.initializeEvents().forEach((e=>this.addNewEventType(e)))}displayDialogAsync(e,t,r){return this._impl.displayDialogAsync(e,t,r)}sendDialogMessageAsync(e,t){return this._impl.sendDialogMessageAsync(e,t)}closeDialog(e){this._impl.closeDialog(e)}}t.UI=i},8012:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(5136);t.WorkbookFormattingEnvUtil=class{static convertToWorkbookFormatting(e){if(e)return{formattingSheets:e.formattingSheets.map((e=>{return{classNameKey:a.InternalToExternalEnumMappings.classNameKey.convert(e.classNameKey),cssProperties:(t=e.classNameKey,r=e.cssProperties,"tableau-row-dividers"===t||"tableau-column-dividers"===t?{borderColor:r.borderColor,borderStyle:r.borderStyle,borderWidth:r.borderWidth}:{fontFamily:r.fontFamily,fontSize:r.fontSize,fontWeight:r.fontWeight,fontStyle:r.fontStyle,textDecoration:r.textDecoration,color:r.color})};var t,r}))}}}},7e3:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorksheetContent=class{constructor(e){this._worksheet=e}get worksheet(){return this._worksheet}}},6336:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(3448),i=r(5136);class n extends i.ServiceImplBase{get serviceName(){return"InitializationService"}initializeDashboardExtensionsAsync(e,t){const r={[a.ParameterId.FunctionName]:"initializeDashboardExtensionsAsync",[a.ParameterId.ExtensionContextMenuIds]:t,[a.ParameterId.IsExtensionDialog]:e};return this.execute(a.VerbId.InitializeExtension,r).then((e=>e.result))}}t.InitializationServiceImpl=n},5432:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(3448),n=r(5136);class s extends n.ServiceImplBase{get serviceName(){return"SettingsService"}saveSettingsAsync(e){const t={[i.ParameterId.FunctionName]:"saveSettingsAsync",[i.ParameterId.SettingsValues]:e};return this.execute(i.VerbId.SaveExtensionSettings,t).then((e=>{const t=e.result;if(!t||!t.settingsValues)throw new n.TableauError(a.ErrorCodes.InternalError,"Unexpected error savings settings.");return t.settingsValues}))}}t.SettingsServiceImpl=s},752:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(3448),n=r(5136),s=a.DialogStyle.Window;class o extends n.ServiceImplBase{get serviceName(){return"UIService"}displayDialogAsync(e,t,r){const o={[i.ParameterId.FunctionName]:"displayDialogAsync",[i.ParameterId.ExtensionDialogUrl]:e,[i.ParameterId.ExtensionDialogPayload]:t},l=r&&r.height?r.height:400,d=r&&r.width?r.width:600,c=r&&r.dialogStyle?r.dialogStyle:s;if(l<=0||d<=0)throw new n.TableauError(a.ErrorCodes.InvalidParameter,"Size parameters for displayDialogAsync must be positive");return o[i.ParameterId.ExtensionDialogH]=l,o[i.ParameterId.ExtensionDialogW]=d,n.ErrorHelpers.verifyEnumValue(c,a.DialogStyle,"DialogStyle"),o[i.ParameterId.ExtensionDialogStyle]=n.ExternalToInternalEnumMappings.dialogStyles.convert(c),this.execute(i.VerbId.DisplayDialog,o).then((e=>{switch(e.result){case i.ExtensionDialogResult.DialogAlreadyOpen:throw new n.TableauError(a.ErrorCodes.DialogAlreadyOpen,"There already exists an open dialog for this extension.");case i.ExtensionDialogResult.InvalidDomain:throw new n.TableauError(a.ErrorCodes.InvalidDomainDialog,"The url of an extension dialog must match the domain of the parent extension.");default:return}}))}closeDialog(e){const t={[i.ParameterId.FunctionName]:"closeDialog"};return e&&(t[i.ParameterId.ExtensionDialogPayload]=e),this.execute(i.VerbId.CloseDialog,t).then((()=>{}))}sendDialogMessageAsync(e,t){const r={[i.ParameterId.FunctionName]:"sendDialogMessage",[i.ParameterId.ExtensionDialogMessage]:e};return t&&(r[i.ParameterId.ExtensionDialogUrl]=t),this.execute(i.VerbId.SendDialogMessage,r).then((()=>{}))}setClickThroughAsync(e,t){if(n.ErrorHelpers.verifyParameterType(e,"boolean","clickThroughEnabled"),void 0===t||t<=0)throw new n.TableauError(a.ErrorCodes.InternalError,"Extension Id is invalid.");const r={[i.ParameterId.ExtensionZoneId]:t,[i.ParameterId.ClickThroughEnabled]:e};return this.execute(i.VerbId.SetClickThrough,r).then((()=>{}))}}t.UIServiceImpl=o},6616:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(5136),i=r(6336),n=r(5432),s=r(752),o=r(3848);t.registerAllExtensionsServices=function(e){a.ApiServiceRegistry.get(o.ExtensionsRegistryId).registerService(new n.SettingsServiceImpl(e,o.ExtensionsRegistryId)),a.ApiServiceRegistry.get(o.ExtensionsRegistryId).registerService(new s.UIServiceImpl(e,o.ExtensionsRegistryId))},t.registerInitializationExtensionsServices=function(e){a.ApiServiceRegistry.get(o.ExtensionsRegistryId).registerService(new i.InitializationServiceImpl(e,o.ExtensionsRegistryId))}},3848:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionsRegistryId=0},268:(e,t,r)=>{"use strict";function a(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),a(r(4171));var i=r(3536);t.ApiMenuType=i.ApiMenuType,t.CrosstabFileFormat=i.CrosstabFileFormat,t.DeviceType=i.DeviceType,t.EmbeddingErrorCodes=i.EmbeddingErrorCodes,t.EmbeddingTableauEventType=i.TableauEventType,t.FileFormats=i.FileFormats,t.PrintOrientation=i.PrintOrientation,t.PrintPageSize=i.PrintPageSize,t.PrintScaling=i.PrintScaling,t.PulseErrorMessageVisibility=i.PulseErrorMessageVisibility,t.PulseLayout=i.PulseLayout,t.PulseTimeDimension=i.PulseTimeDimension,t.SheetSizeBehavior=i.SheetSizeBehavior,t.TableauDialogType=i.TableauDialogType,t.Toolbar=i.Toolbar,a(r(828)),a(r(3432)),a(r(1480)),a(r(5488))},5840:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(4744);t.ErrorCodes=a.ErrorCodes,t.ExtensionContext=a.ExtensionContext,t.ExtensionMode=a.ExtensionMode,t.TableauEventType=a.TableauEventType,t.VizImageEncodingType=a.VizImageEncodingType,t.VizImagePaletteType=a.VizImagePaletteType,t.VizImageSizeSettingAlignmentType=a.VizImageSizeSettingAlignmentType,t.VizImageSizeSettingType=a.VizImageSizeSettingType,t.VizImageSortDirectionType=a.VizImageSortDirectionType,function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(5488))},7419:(e,t,r)=>{"use strict";function a(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),a(r(268)),a(r(5840))},4171:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),(r=t.AskDataAttributes||(t.AskDataAttributes={})).Origin="origin",r.ShowEmbed="show-embed",r.ShowPin="show-pin",r.ShowSave="show-save",r.ShowShare="show-share"},3536:(e,t)=>{"use strict";var r,a,i,n,s,o,l,d,c,u,h,p,m,g,y,I;Object.defineProperty(t,"__esModule",{value:!0}),(I=t.CrosstabFileFormat||(t.CrosstabFileFormat={})).CSV="csv",I.Excel="xlsx",(y=t.DeviceType||(t.DeviceType={})).Default="default",y.Desktop="desktop",y.Tablet="tablet",y.Phone="phone",(g=t.EmbeddingErrorCodes||(t.EmbeddingErrorCodes={})).AuthFailed="auth-failed",g.BrowserNotCapable="browser-not-capable",g.DownloadWorkbookNotAllowed="download-workbook-not-allowed",g.FilterCannotBePerformed="filter-cannot-be-performed",g.IndexOutOfRange="index-out-of-range",g.InternalError="internal-error",g.InvalidCustomViewName="invalid-custom-view-name",g.InvalidDateParameter="invalid-date-parameter",g.invalidFilterFieldNameOrValue="invalid-filter-field-name",g.InvalidParameter="invalid-parameter",g.InvalidTimeDimension="invalid-time-dimension",g.InvalidSize="invalid-size",g.InvalidSheetType="invalid-sheet-type",g.InvalidSizeBehavior="invalid-size-behavior",g.InvalidSizeBehaviorOnWorksheet="invalid-size-behavior-on-worksheet",g.InvalidUrl="invalid-url",g.MissingMaxSize="missing-max-size",g.MissingMinSize="missing-min-size",g.MissingMinMaxSize="missing-min-max-size",g.MissingParameter="missing-parameter",g.MissingRangeNForRelativeDateFilters="missing-range-n-for-relative-date-filters",g.NoUrlForHiddenWorksheet="no-url-for-hidden-worksheet",g.NoUrlOrParentElementNotFound="no-url-or-parent-element-not-found",g.NotActiveSheet="not-active-sheet",g.NullOrEmptyParameter="null-or-empty-parameter",g.SheetNotInWorkbook="sheet-not-in-workbook",g.StaleDataReference="stale-data-reference",g.UnknownAuthError="unknown-auth-error",g.UnsupportedEventName="unsupported-event-name",g.VizAlreadyInManager="viz-already-in-manager",g.ImplementationError="wrong-implementation",g.NotImplemented="not-implemented",g.EventInitializationError="event-initialization-error",g.IncompatibleVersionError="incompatible-version-error",g.UnknownDialogType="unknown-dialog-type",g.FilterMissingOrNotImplemented="filter-missing-not-implemented",g.StoryPointIdMismatch="storypoint-id-mismatch",(m=t.FileFormats||(t.FileFormats={})).PDF="pdf",m.PNG="png",(p=t.PrintOrientation||(t.PrintOrientation={})).Portrait="portrait",p.Landscape="landscape",(h=t.PrintPageSize||(t.PrintPageSize={})).Letter="letter",h.Legal="legal",h.Note="note",h.Folio="folio",h.Tabloid="tabloid",h.Ledger="ledger",h.Statement="statement",h.Executive="executive",h.A3="A3",h.A4="A4",h.A5="A5",h.B4="B4",h.B5="B5",h.Quarto="quarto",h.Unspecified="unspecified",(u=t.PrintScaling||(t.PrintScaling={})).Automatic="automatic",u.Perc25="25%",u.Perc50="50%",u.Perc60="60%",u.Perc75="75%",u.Perc80="80%",u.Perc90="90%",u.Perc100="100%",u.Perc200="200%",u.Perc400="400%",u.AtMost1PageHigh="at-most-1-page-high",u.AtMost2PagesHigh="at-most-2-pages-high",u.AtMost1PageWide="at-most-1-page-wide",u.AtMost2PagesWide="at-most-2-pages-wide",(c=t.RevertVizSelection||(t.RevertVizSelection={})).All="all",c.Axes="axes",c.Filters="filters",c.Sorts="sorts",c.Shelves="shelves",(d=t.ToolbarButtons||(t.ToolbarButtons={})).Alerts="alerts",d.AskData="askData",d.CustomViews="customViews",d.DataDetails="dataDetails",d.Share="share",d.Subscribe="subscribe",(l=t.Toolbar||(t.Toolbar={})).Top="top",l.Bottom="bottom",l.Hidden="hidden",(o=t.SheetSizeBehavior||(t.SheetSizeBehavior={})).Automatic="automatic",o.Exactly="exactly",o.Range="range",o.AtLeast="atleast",o.AtMost="atmost",(s=t.PulseLayout||(t.PulseLayout={})).Default="default",s.Card="card",s.Ban="ban",(n=t.PulseTimeDimension||(t.PulseTimeDimension={})).Today="Today",n.Yesterday="Yesterday",n.WeekToDate="WeekToDate",n.LastWeek="LastWeek",n.MonthToDate="MonthToDate",n.LastMonth="LastMonth",n.QuarterToDate="QuarterToDate",n.LastQuarter="LastQuarter",n.YearToDate="YearToDate",n.LastYear="LastYear",(i=t.PulseErrorMessageVisibility||(t.PulseErrorMessageVisibility={})).Visible="visible",i.Hidden="hidden",i.Suppressed="suppressed",(a=t.TableauEventType||(t.TableauEventType={})).CustomViewLoaded="customviewloaded",a.CustomViewRemoved="customviewremoved",a.CustomViewSaved="customviewsaved",a.CustomViewSetDefault="customviewsetdefault",a.EditButtonClicked="editbuttonclicked",a.EditInDesktopButtonClicked="editindesktopbuttonclicked",a.FilterChanged="filterchanged",a.FirstVizSizeKnown="firstvizsizeknown",a.FirstInteractive="firstinteractive",a.CustomMarkContextMenuEvent="custommarkcontextmenu",a.MarkSelectionChanged="markselectionchanged",a.ParameterChanged="parameterchanged",a.ToolbarStateChanged="toolbarstatechanged",a.WorkbookReadyToClose="workbookreadytoclose",a.WorkbookPublished="workbookpublished",a.WorkbookPublishedAs="workbookpublishedas",a.UrlAction="urlaction",a.TabSwitched="tabswitched",a.StoryPointSwitched="storypointswitched",a.VizLoadError="vizloaderror",a.IframeSrcUpdated="iframesrcupdated",a.SummaryDataChanged="summarydatachanged",a.ReadyToReceiveAuthToken="readytoreceiveauthtoken",a.FirstPulseMetricSizeKnown="firstpulsemetricsizeknown",a.PulseError="pulseerror",a.PulseFiltersChanged="pulsefilterschanged",a.PulseInsightDiscovered="pulseinsightdiscovered",a.PulseMetricSizeChanged="pulsemetricsizechanged",a.PulseTimeDimensionChanged="pulsetimedimensionchanged",a.PulseUrlChanged="pulseurlchanged",(t.ApiMenuType||(t.ApiMenuType={})).Ubertip="ubertip",(r=t.TableauDialogType||(t.TableauDialogType={})).ExportPDF="export-pdf",r.ExportPowerPoint="export-powerpoint",r.ExportData="export-data",r.ExportCrossTab="export-cross-tab",r.ExportWorkbook="export-workbook",r.Share="share"},828:(e,t)=>{"use strict";var r,a,i;Object.defineProperty(t,"__esModule",{value:!0}),(i=t.PulseAttributes||(t.PulseAttributes={})).DisableExploreFilter="disable-explore-filter",i.Layout="layout",i.OnFirstInteractive="onFirstInteractive",i.OnFirstPulseMetricSizeKnown="onFirstPulseMetricSizeKnown",i.OnPulseUrlError="onPulseError",i.OnPulseFiltersChanged="onPulseFiltersChanged",i.OnPulseInsightDiscovered="onPulseInsightDiscovered",i.OnPulseMetricSizeChanged="onPulseMetricSizeChanged",i.OnPulseTimeDimensionChanged="onPulseTimeDimensionChanged",i.OnPulseUrlChanged="onPulseUrlChanged",i.TimeDimension="time-dimension",i.TokenOptional="token-optional",(a=t.PulseChildElements||(t.PulseChildElements={})).IframeStyle="iframe-style",a.ThemeParameter="theme-parameter",a.PulseFilter="pulse-filter",(r=t.PulseChildElementAttributes||(t.PulseChildElementAttributes={})).Name="name",r.Field="field",r.Value="value",r.Type="type"},3432:(e,t)=>{"use strict";var r,a,i,n,s;Object.defineProperty(t,"__esModule",{value:!0}),(s=t.VizSharedAttributes||(t.VizSharedAttributes={})).TouchOptimize="touch-optimize",s.HideEditInDesktopButton="hide-edit-in-desktop-button",s.SuppressDefaultEditBehavior="suppress-default-edit-behavior",s.DisableVersionCheck="disable-version-check",s.OnEditInDesktopButtonClicked="onEditInDesktopButtonClicked",s.OnFirstVizSizeKnown="onFirstVizSizeKnown",s.OnFirstInteractive="onFirstInteractive",(n=t.VizAttributes||(t.VizAttributes={})).DisableUrlActionsPopups="disable-url-actions",n.HideTabs="hide-tabs",n.Toolbar="toolbar",n.InstanceIdToClone="instance-id-to-clone",n.Device="device",n.HideEditButton="hide-edit-button",n.OnEditButtonClicked="onEditButtonClicked",n.OnFilterChanged="onFilterChanged",n.OnCustomMarkContextMenuEvent="onCustomMarkContextMenuEvent",n.OnMarkSelectionChanged="onMarkSelectionChanged",n.OnParameterChanged="onParameterChanged",n.OnToolbarStateChanged="onToolbarStateChanged",n.OnUrlAction="onUrlAction",n.OnTabSwitched="onTabSwitched",n.OnCustomViewLoaded="onCustomViewLoaded",n.OnCustomViewRemoved="onCustomViewRemoved",n.OnCustomViewSaved="onCustomViewSaved",n.OnCustomViewSetDefault="onCustomViewSetDefault",n.OnStoryPointSwitched="onStoryPointSwitched",n.OnSummaryDataChanged="onSummaryDataChanged",n.OnReadyToReceiveAuthToken="onReadyToReceiveAuthToken",(i=t.VizAuthoringAttributes||(t.VizAuthoringAttributes={})).OnWorkbookPublished="onWorkbookPublished",i.OnWorkbookPublishedAs="onWorkbookPublishedAs",i.OnWorkbookReadyToClose="onWorkbookReadyToClose",i.HideCloseButton="hide-close-button",(a=t.VizChildElements||(t.VizChildElements={})).VizFilter="viz-filter",a.VizParameter="viz-parameter",a.CustomParameter="custom-parameter",a.IframeStyle="iframe-style",(r=t.VizChildElementAttributes||(t.VizChildElementAttributes={})).Field="field",r.Value="value",r.Name="name"},1480:(e,t)=>{"use strict";var r,a,i,n;Object.defineProperty(t,"__esModule",{value:!0}),(n=t.WebComponentAttributes||(t.WebComponentAttributes={})).Src="src",n.Width="width",n.Height="height",n.Token="token",n.Debug="debug",n.IframeAuth="iframe-auth",n.OnVizLoadError="onvizloaderror",n.ForceTokenSync="force-token-sync",(i=t.EmbeddedIframeAttributes||(t.EmbeddedIframeAttributes={})).Loading="iframe-attr-loading",i.Style="iframe-attr-style",i.Class="iframe-attr-class",(a=t.WebComponentChildElements||(t.WebComponentChildElements={})).CustomParameter="custom-parameter",a.IframeStyle="iframe-style",(r=t.WebComponentChildElementAttributes||(t.WebComponentChildElementAttributes={})).Field="field",r.Value="value",r.Name="name"},4744:e=>{"use strict";var t;!function(e){let t,r,a,i,n,s,o,l,d;!function(e){e.APINotInitialized="api-not-initialized",e.VisibilityError="visibility-error",e.DialogAlreadyOpen="dialog-already-open",e.DialogClosedByUser="dialog-closed-by-user",e.InternalError="internal-error",e.InvalidDomainDialog="invalid-dialog-domain",e.InvalidParameter="invalid-parameter",e.MissingFilter="missing-filter",e.MissingParameter="missing-parameter",e.ServerError="server-error",e.SettingSaveInProgress="setting-save-in-progress",e.UnsupportedEventName="unsupported-event-name",e.UnsupportedMethodForDataSourceType="unsupported-method-for-data-source-type"}(t=e.ErrorCodes||(e.ErrorCodes={})),function(e){e.Desktop="desktop",e.Server="server",e.Cloud="cloud",e.PublicWeb="public-web",e.PublicDesktop="public-desktop"}(r=e.ExtensionContext||(e.ExtensionContext={})),function(e){e.Authoring="authoring",e.Viewing="viewing"}(a=e.ExtensionMode||(e.ExtensionMode={})),function(e){e.DialogMessageReceived="dialog-message-received",e.FilterChanged="filter-changed",e.MarkSelectionChanged="mark-selection-changed",e.SummaryDataChanged="summary-data-changed",e.ParameterChanged="parameter-changed",e.SettingsChanged="settings-changed",e.DashboardLayoutChanged="dashboard-layout-changed",e.WorkbookFormattingChanged="workbook-formatting-changed",e.WorksheetFormattingChanged="worksheet-formatting-changed"}(i=e.TableauEventType||(e.TableauEventType={})),function(e){e.Discrete="discrete",e.Continuous="continuous"}(n=e.VizImageEncodingType||(e.VizImageEncodingType={})),function(e){e.Ascending="ascending",e.Descending="descending"}(s=e.VizImageSortDirectionType||(e.VizImageSortDirectionType={})),function(e){e.CustomDiverging="custom-diverging",e.CustomSequential="custom-sequential"}(o=e.VizImagePaletteType||(e.VizImagePaletteType={})),function(e){e.Fixed="fixed",e.Manual="manual"}(l=e.VizImageSizeSettingType||(e.VizImageSizeSettingType={})),function(e){e.Right="right",e.Left="left",e.Center="center"}(d=e.VizImageSizeSettingAlignmentType||(e.VizImageSizeSettingAlignmentType={}))}(t||(t={})),e.exports=t},4912:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),(r=t.SharedErrorCodes||(t.SharedErrorCodes={})).CrosstabCreationError="crosstab-creation-error",r.DataCreationError="data-creation-error",r.InvalidAggregationFieldName="invalid-aggregation-field-name",r.InvalidFilterFieldName="invalid-filter-name",r.InvalidFilterFieldValue="invalid-filter-fieldValue",r.InvalidSelectionDate="invalid-selection-date",r.InvalidSelectionFieldName="invalid-selection-fieldName",r.InvalidSelectionValue="invalid-selection-value",r.InvalidSelectionSheet="invalid-selection-sheet",r.InternalError="internal-error",r.InvalidParameter="invalid-parameter",r.PDFCreationError="pdf-creation-error",r.PowerPointCreationError="powerpoint-creation-error",r.NotActiveSheet="not-active-sheet",r.ImplementationError="wrong-implementation",r.ApiExecutionError="api-execution-error",r.ServerError="server-error",r.Timeout="timeout"},808:e=>{"use strict";var t;!function(e){let t,r,a,i,n,s,o,l,d,c,u,h,p,m,g,y,I,v,S,T,b,f,E,A,P,_,w,D,C;!function(e){e.Cluster="cluster",e.Forecast="forecast",e.TrendLine="trend-line"}(t=e.AnalyticsObjectType||(e.AnalyticsObjectType={})),function(e){e.Mark="mark",e.Point="point",e.Area="area"}(r=e.AnnotationType||(e.AnnotationType={})),function(e){e.Discrete="discrete",e.Continuous="continuous",e.Unknown="unknown"}(a=e.ColumnType||(e.ColumnType={})),function(e){e.WorksheetTitle="tableau-worksheet-title",e.Worksheet="tableau-worksheet",e.Tooltip="tableau-tooltip",e.StoryTitle="tableau-story-title",e.DashboardTitle="tableau-dashboard-title",e.Pane="tableau-pane",e.RowDividers="tableau-row-dividers",e.ColumnDividers="tableau-column-dividers"}(i=e.ClassNameKey||(e.ClassNameKey={})),function(e){e.Blank="blank",e.Worksheet="worksheet",e.QuickFilter="quick-filter",e.ParameterControl="parameter-control",e.PageFilter="page-filter",e.Legend="legend",e.Title="title",e.Text="text",e.Image="image",e.WebPage="web-page",e.Extension="extension"}(n=e.DashboardObjectType||(e.DashboardObjectType={})),function(e){e.Show="show",e.Hide="hide"}(s=e.DashboardObjectVisibilityType||(e.DashboardObjectVisibilityType={})),function(e){e.String="string",e.Int="int",e.Float="float",e.Bool="bool",e.Date="date",e.DateTime="date-time",e.Spatial="spatial",e.Unknown="unknown"}(o=e.DataType||(e.DataType={})),function(e){e.Added="added",e.Removed="removed",e.IsFloatingChanged="is-floating-changed",e.IsVisibleChanged="is-visible-changed",e.PositionChanged="position-changed",e.SizeChanged="size-changed",e.NameChanged="name-changed",e.Selected="selected",e.Deselected="deselected",e.DashboardChanged="dashboard-changed"}(l=e.DashboardLayoutChange||(e.DashboardLayoutChange={})),function(e){e.Last="last",e.LastN="last-n",e.Next="next",e.NextN="next-n",e.Current="current",e.ToDate="to-date"}(d=e.DateRangeType||(e.DateRangeType={})),function(e){e.Window="window",e.Modal="modal",e.Modeless="modeless"}(c=e.DialogStyle||(e.DialogStyle={})),function(e){e.Column="column",e.Row="row",e.Page="page",e.Filter="filter",e.MarksType="marks-type",e.MeasureValues="measure-values",e.Color="color",e.Size="size",e.Label="label",e.Detail="detail",e.Tooltip="tooltip",e.Shape="shape",e.Path="path",e.Angle="angle",e.Geometry="geometry",e.Custom="custom"}(u=e.EncodingType||(e.EncodingType={})),function(e){e.Sum="sum",e.Avg="avg",e.Min="min",e.Max="max",e.Stdev="stdev",e.Stdevp="stdevp",e.Var="var",e.Varp="varp",e.Collect="collect",e.Count="count",e.Countd="countd",e.Median="median",e.Attr="attr",e.None="none",e.Year="year",e.Qtr="qtr",e.Month="month",e.Day="day",e.Hour="hour",e.Minute="minute",e.Second="second",e.Week="week",e.Weekday="weekday",e.MonthYear="month-year",e.Mdy="mdy",e.End="end",e.TruncYear="trunc-year",e.TruncQtr="trunc-qtr",e.TruncMonth="trunc-month",e.TruncWeek="trunc-week",e.TruncDay="trunc-day",e.TruncHour="trunc-hour",e.TruncMinute="trunc-minute",e.TruncSecond="trunc-second",e.Quart1="quart1",e.Quart3="quart3",e.Skewness="skewness",e.Kurtosis="kurtosis",e.InOut="in-out",e.User="user"}(h=e.FieldAggregationType||(e.FieldAggregationType={})),function(e){e.Dimension="dimension",e.Measure="measure",e.Unknown="unknown"}(p=e.FieldRoleType||(e.FieldRoleType={})),function(e){e.Categorical="categorical",e.Range="range",e.Hierarchical="hierarchical",e.RelativeDate="relative-date"}(m=e.FilterType||(e.FilterType={})),function(e){e.Add="add",e.All="all",e.Replace="replace",e.Remove="remove"}(g=e.FilterUpdateType||(e.FilterUpdateType={})),function(e){e.Relevant="relevant",e.Database="database"}(y=e.FilterDomainType||(e.FilterDomainType={})),function(e){e.NullValues="null-values",e.NonNullValues="non-null-values",e.AllValues="all-values"}(I=e.FilterNullOption||(e.FilterNullOption={})),function(e){e.AllValues="all-values",e.OnlyNativeValues="only-native-values",e.OnlyFormattedValues="only-formatted-values"}(v=e.IncludeDataValuesOption||(e.IncludeDataValuesOption={})),function(e){e.Bar="bar",e.Line="line",e.Area="area",e.Square="square",e.Circle="circle",e.Shape="shape",e.Text="text",e.Map="map",e.Pie="pie",e.GanttBar="gantt-bar",e.Polygon="polygon",e.Heatmap="heatmap",e.VizExtension="viz-extension"}(S=e.MarkType||(e.MarkType={})),function(e){e.All="all",e.List="list",e.Range="range"}(T=e.ParameterValueType||(e.ParameterValueType={})),function(e){e.Years="years",e.Quarters="quarters",e.Months="months",e.Weeks="weeks",e.Days="days",e.Hours="hours",e.Minutes="minutes",e.Seconds="seconds"}(b=e.PeriodType||(e.PeriodType={})),function(e){e.RunningTotal="running-total",e.Difference="difference",e.PercentDifference="percent-difference",e.PercentOfTotal="percent-of-total",e.Rank="rank",e.Percentile="percentile",e.MovingAverage="moving-average",e.YTDTotal="ytd-total",e.CompoundGrowthRate="compound-growth-rate",e.YearOverYearGrowth="year-over-year-growth",e.YTDGrowth="ytd-growth",e.Undefined="undefined"}(f=e.QuickTableCalcType||(e.QuickTableCalcType={})),function(e){e.Replace="select-replace",e.Add="select-add",e.Remove="select-remove"}(E=e.SelectionUpdateType||(e.SelectionUpdateType={})),function(e){e.Simple="select-options-simple",e.Toggle="select-options-toggle"}(A=e.SelectOptions||(e.SelectOptions={})),function(e){e.Dashboard="dashboard",e.Story="story",e.Worksheet="worksheet"}(P=e.SheetType||(e.SheetType={})),function(e){e.Increasing="increasing",e.Decreasing="decreasing"}(_=e.SortDirection||(e.SortDirection={})),function(e){e.Linear="linear",e.Logarithmic="logarithmic",e.Exponential="exponential",e.Polynomial="polynomial"}(w=e.TrendLineModelType||(e.TrendLineModelType={})),function(e){e.Slow="slow",e.Normal="normal",e.Fast="fast"}(D=e.ReplaySpeedType||(e.ReplaySpeedType={})),function(e){e.AllSelected="all-selected",e.NoneSelected="none-selected",e.SomeSelected="some-selected",e.UnknownSelected="unknown-selected"}(C=e.HierarchicalLevelSelectionState||(e.HierarchicalLevelSelectionState={})),e.ZoneVisibilityType=Object.assign({},s)}(t||(t={})),e.exports=t},5488:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(4912));var a=r(808);t.AnalyticsObjectType=a.AnalyticsObjectType,t.AnnotationType=a.AnnotationType,t.ClassNameKey=a.ClassNameKey,t.ColumnType=a.ColumnType,t.DashboardLayoutChange=a.DashboardLayoutChange,t.DashboardObjectType=a.DashboardObjectType,t.DashboardObjectVisibilityType=a.DashboardObjectVisibilityType,t.DataType=a.DataType,t.DateRangeType=a.DateRangeType,t.DialogStyle=a.DialogStyle,t.EncodingType=a.EncodingType,t.FieldAggregationType=a.FieldAggregationType,t.FieldRoleType=a.FieldRoleType,t.FilterDomainType=a.FilterDomainType,t.FilterNullOption=a.FilterNullOption,t.FilterType=a.FilterType,t.FilterUpdateType=a.FilterUpdateType,t.HierarchicalLevelSelectionState=a.HierarchicalLevelSelectionState,t.IncludeDataValuesOption=a.IncludeDataValuesOption,t.MarkType=a.MarkType,t.ParameterValueType=a.ParameterValueType,t.PeriodType=a.PeriodType,t.QuickTableCalcType=a.QuickTableCalcType,t.ReplaySpeedType=a.ReplaySpeedType,t.SelectOptions=a.SelectOptions,t.SelectionUpdateType=a.SelectionUpdateType,t.SheetType=a.SheetType,t.SortDirection=a.SortDirection,t.TrendLineModelType=a.TrendLineModelType,t.ZoneVisibilityType=a.ZoneVisibilityType},3448:(e,t,r)=>{"use strict";function a(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0});const i=r(5892);t.INTERNAL_CONTRACT_VERSION=i,a(r(6716)),a(r(1080)),a(r(5824)),a(r(4547)),a(r(2400)),a(r(2496)),a(r(2472)),a(r(552)),a(r(3256)),a(r(7204)),a(r(4528)),a(r(3388)),a(r(3760)),t.MESSAGING_VERSION={major:1,minor:0,fix:0}},6716:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(1080);class i{static isSpecial(e){return e.length>2&&"%"===e[0]&&"%"===e[e.length-1]}static parseBoolean(e){const t=e.toLowerCase();return"true"!==t&&"false"!==t?this.specialValueIndicator:"true"===t}static parseNumber(e){const t=Number(e);return isNaN(t)?this.specialValueIndicator:t}static parseDate(e){const t=new Date(e);return Number.isNaN(t.getTime())?null:t}static parseDateTime(e){const t=e.replace(" ","T").concat("Z"),r=new Date(t);return Number.isNaN(r.getTime())?null:r}static convertValueAsStringToValue(e,t){if(null!=e){if(this.isSpecial(e))return e;switch(t){case a.DataType.Bool:return this.parseBoolean(e);case a.DataType.Int:case a.DataType.Float:return this.parseNumber(e);case a.DataType.Date:return null===this.parseDate(e)?this.specialValueIndicator:e;case a.DataType.DateTime:return null===this.parseDateTime(e)?this.specialValueIndicator:e;case a.DataType.Spatial:case a.DataType.String:default:return e}}}static convertValueToNativeValue(e,t){if(null==e)return null;switch(t){case a.DataType.Bool:case a.DataType.Int:case a.DataType.Float:return"string"==typeof e?null:e;case a.DataType.Date:return this.parseDate(e);case a.DataType.DateTime:return this.parseDateTime(e);case a.DataType.String:return this.isSpecial(e)?null:e;case a.DataType.Spatial:default:return e}}static convertStringValueToNativeValue(e,t){return this.convertValueToNativeValue(this.convertValueAsStringToValue(e,t),t)}}t.DataTypeConverter=i,i.specialValueIndicator="%null%"},1080:(e,t)=>{"use strict";var r,a,i,n,s,o,l,d,c,u,h,p,m,g,y,I,v,S,T,b,f,E,A,P,_,w,D,C,F,x,M,k,N,R;Object.defineProperty(t,"__esModule",{value:!0}),(R=t.ExtensionContext||(t.ExtensionContext={})).Desktop="desktop",R.Server="server",R.Unknown="unknown",R.Cloud="cloud",R.PublicWeb="public-web",R.PublicDesktop="public-desktop",(N=t.ExtensionMode||(t.ExtensionMode={})).Authoring="authoring",N.Viewing="viewing",N.Unknown="unknown",(k=t.AnnotateEnum||(t.AnnotateEnum={})).Mark="mark",k.Point="point",k.Area="area",(M=t.ColumnType||(t.ColumnType={})).Discrete="discrete",M.Continuous="continuous",M.Unknown="unknown",(x=t.DashboardObjectType||(t.DashboardObjectType={})).Blank="blank",x.Worksheet="worksheet",x.QuickFilter="quick-filter",x.ParameterControl="parameter-control",x.PageFilter="page-filter",x.Legend="legend",x.Title="title",x.Text="text",x.Image="image",x.WebPage="web-page",x.Extension="extension",(F=t.DataType||(t.DataType={})).String="string",F.Int="int",F.Float="float",F.Bool="bool",F.Date="date",F.DateTime="date-time",F.Spatial="spatial",F.Unknown="unknown",(C=t.DialogStyle||(t.DialogStyle={})).Window="window",C.Modal="modal",C.Modeless="modeless",(D=t.EncodedDataType||(t.EncodedDataType={})).Number="number",D.String="string",D.Date="date",D.Boolean="boolean",(w=t.ErrorCodes||(t.ErrorCodes={})).INITIALIZATION_ERROR="initialization-error",w.INTERNAL_ERROR="internal-error",w.MISSING_ENUM_MAPPING="missing-enum-mapping",w.MISSING_PARAMETER="missing-parameter",w.PERMISSION_DENIED="permission-denied",w.PRES_MODEL_PARSING_ERROR="pres-model-parsing-error",w.VERSION_NOT_CONFIGURED="version-not-configured",w.VISIBILITY_ERROR="visibility-error",w.UNKNOWN_VERB_ID="unknown-verb-id",(_=t.FieldAggregationType||(t.FieldAggregationType={})).Sum="sum",_.Avg="avg",_.Min="min",_.Max="max",_.Stdev="stdev",_.Stdevp="stdevp",_.Var="var",_.Varp="varp",_.Collect="collect",_.Count="count",_.Countd="countd",_.Median="median",_.Attr="attr",_.None="none",_.Year="year",_.Qtr="qtr",_.Month="month",_.Day="day",_.Hour="hour",_.Minute="minute",_.Second="second",_.Week="week",_.Weekday="weekday",_.MonthYear="month-year",_.Mdy="mdy",_.End="end",_.TruncYear="trunc-year",_.TruncQtr="trunc-qtr",_.TruncMonth="trunc-month",_.TruncWeek="trunc-week",_.TruncDay="trunc-day",_.TruncHour="trunc-hour",_.TruncMinute="trunc-minute",_.TruncSecond="trunc-second",_.Quart1="quart1",_.Quart3="quart3",_.Skewness="skewness",_.Kurtosis="kurtosis",_.InOut="in-out",_.User="user",(P=t.FieldRoleType||(t.FieldRoleType={})).Dimension="dimension",P.Measure="measure",P.Unknown="unknown",(A=t.FilterUpdateType||(t.FilterUpdateType={})).Add="add",A.All="all",A.Replace="replace",A.Remove="remove",(E=t.SheetType||(t.SheetType={})).Dashboard="dashboard",E.Story="story",E.Worksheet="worksheet",(f=t.DomainRestrictionType||(t.DomainRestrictionType={})).All="all",f.List="list",f.Range="range",(b=t.DateStepPeriod||(t.DateStepPeriod={})).Years="years",b.Quarters="quarters",b.Months="months",b.Weeks="weeks",b.Days="days",b.Hours="hours",b.Minutes="minutes",b.Seconds="seconds",(T=t.FilterNullOption||(t.FilterNullOption={})).NullValues="nullvalues",T.NonNullValues="nonnullvalues",T.AllValues="allvalues",(S=t.FilterDomainType||(t.FilterDomainType={})).Relevant="relevant",S.Database="database",(v=t.SelectionUpdateType||(t.SelectionUpdateType={})).Replace="select-replace",v.Add="select-add",v.Remove="select-remove",(I=t.SelectOptions||(t.SelectOptions={})).Simple="select-options-simple",I.Toggle="select-options-toggle",I.Menu="select-options-menu",I.Range="select-options-range",I.Search="select-options-search",(y=t.QuantitativeIncludedValues||(t.QuantitativeIncludedValues={})).IncludeNull="include-null",y.IncludeNonNull="include-non-null",y.IncludeAll="include-all",(g=t.HierarchicalLevelSelectionState||(t.HierarchicalLevelSelectionState={})).AllSelected="all-selected",g.NoneSelected="none-selected",g.SomeSelected="some-selected",g.UnknownSelected="unknown-selected",(m=t.MarkType||(t.MarkType={})).Bar="bar",m.Line="line",m.Area="area",m.Square="square",m.Circle="circle",m.Shape="shape",m.Text="text",m.Map="map",m.Pie="pie",m.GanttBar="gantt-bar",m.Polygon="polygon",m.Heatmap="heatmap",m.VizExtension="viz-extension",(p=t.FilterType||(t.FilterType={})).Categorical="categorical",p.Range="range",p.RelativeDate="relativeDate",p.Hierarchical="hierarchical",(h=t.DateRangeType||(t.DateRangeType={})).Last="last",h.LastN="lastN",h.Next="next",h.NextN="nextN",h.Current="current",h.ToDate="toDate",(u=t.ExtensionDialogResult||(t.ExtensionDialogResult={})).DialogAlreadyOpen="dialog-already-open",u.InvalidDomain="invalid-domain",u.Success="success",(c=t.ApiShowDataTableFormat||(t.ApiShowDataTableFormat={})).NativeValuesOnly="native-values-only",c.FormattedValuesOnly="formatted-values-only",c.NativeAndFormattedValues="native-and-formatted-values",(d=t.PageSizeOption||(t.PageSizeOption={})).Letter="letter",d.Legal="legal",d.Note="note",d.Folio="folio",d.Tabloid="tabloid",d.Ledger="ledger",d.Statement="statement",d.Executive="executive",d.A3="a3",d.A4="a4",d.A5="a5",d.B4="b4",d.B5="b5",d.Quarto="quarto",d.Unspecified="unspecified",(l=t.PageOrientation||(t.PageOrientation={})).Printer="printer",l.Portrait="portrait",l.Landscape="landscape",(o=t.ScaleMode||(t.ScaleMode={})).ScaleAuto="auto",o.ScalePercentage="percent",o.ScaleFitPages="fit-pages",(s=t.PageScalingOption||(t.PageScalingOption={})).ScalePctAuto="auto",s.ScalePct400="pct400",s.ScalePct200="pct200",s.ScalePct100="pct100",s.ScalePct90="pct90",s.ScalePct80="pct80",s.ScalePct75="pct75",s.ScalePct60="pct60",s.ScalePct50="pct50",s.ScalePct25="pct25",(n=t.FitPages||(t.FitPages={})).FitOneHigh="fit0x1",n.FitTwoHigh="fit0x2",n.FitOneWide="fit1x0",n.FitTwoWide="fit2x0",(i=t.EncodingType||(t.EncodingType={})).Color="color",i.Size="size",i.Label="label",i.Detail="detail",i.Tooltip="tooltip",i.Shape="shape",i.Path="path",i.Angle="angle",i.Geometry="geometry",i.Custom="custom",(a=t.PulseTimeDimension||(t.PulseTimeDimension={})).Today="Today",a.Yesterday="Yesterday",a.WeekToDate="WeekToDate",a.LastWeek="LastWeek",a.MonthToDate="MonthToDate",a.LastMonth="LastMonth",a.QuarterToDate="QuarterToDate",a.LastQuarter="LastQuarter",a.YearToDate="YearToDate",a.LastYear="LastYear",(r=t.PulseErrorMessageVisibility||(t.PulseErrorMessageVisibility={})).Visible="visible",r.Hidden="hidden",r.Suppressed="suppressed"},5824:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),(r=t.NotificationId||(t.NotificationId={})).CustomMarkContextMenuClicked="custom-mark-context-menu-clicked",r.ContextMenuClick="context-menu-click",r.CustomViewRemoved="custom-view-removed",r.CustomViewSaved="custom-view-saved",r.CustomViewSetDefault="custom-view-set-default",r.CustomViewsLoaded="custom-views-loaded",r.DashboardLayoutChanged="dashboard-layout-changed",r.EditButtonClicked="edit-button-clicked",r.EditInDesktopButtonClicked="edit-in-desktop-button-clicked",r.ExtensionDialogUpdate="extension-dialog-update",r.ExtensionDialogMessage="extension-dialog-message",r.FilterChanged="filter-changed",r.FirstVizSizeKnown="first-viz-size-known",r.FirstPulseMetricSizeKnown="first-pulse-metric-size-known",r.ParameterChanged="parameter-changed",r.PulseError="pulse-error",r.PulseFiltersChanged="pulse-filters-changed",r.PulseMetricSizeChanged="pulse-metric-size-changed",r.PulseInsightDiscovered="pulse-insight-discovered",r.PulseInteractive="pulse-interactive",r.PulseTimeDimensionChanged="pulse-time-dimension-changed",r.PulseUrlChanged="pulse-url-changed",r.SelectedMarksChanged="selected-marks-changed",r.SettingsChanged="settings-changed",r.SummaryDataChanged="summary-data-changed",r.TestConversionNotification="test-conversion-notification",r.ToolbarStateChanged="toolbar-state-changed",r.VizInteractive="viz-interactive",r.AskDataInteractive="ask-data-interactive",r.WorkbookReadyToClose="workbook-ready-to-close",r.WorkbookFormattingChanged="workbook-formatting-changed",r.WorkbookPublished="workbook-published",r.WorkbookPublishedAs="workbook-published-as",r.WorksheetFormattingChanged="worksheet-formatting-changed",r.UrlAction="url-action",r.TabSwitched="tab-switched",r.StoryPointSwitched="story-point-switched",r.ReadyToReceiveAuthToken="ready-to-receive-auth-token"},4547:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),(r=t.ParameterId||(t.ParameterId={})).ActiveTablesInfo="active-tables-info",r.AnchorDate="anchor-date",r.AnnotateEnum="annotate-enum",r.AnnotationList="annotation-list",r.ApplyWorksheetFormatting="apply-worksheet-formatting",r.CategoricalDomain="categorical-domain",r.ClickThroughEnabled="click-through-enabled",r.Columns="columns",r.ColumnsToInclude="columns-to-include",r.ColumnsToIncludeById="columns-to-include-by-id",r.ConnectionDescriptionSummaries="connection-description-summaries",r.CurrentSheetType="current-sheet-type",r.CustomView="custom-view",r.CustomViewIsDefault="custom-view-is-default",r.CustomViewIsPublic="custom-view-is-public",r.CustomViewLuid="custom-view-luid",r.CustomViewName="custom-view-name",r.CustomViews="custom-views",r.Dashboard="dashboard",r.DashboardFilters="dashboard-filters",r.DashboardName="dashboard",r.DashboardObjectPositionAndSizeUpdate="dashboard-object-position-and-size-update",r.DashboardObjectPositionAndSizeUpdateList="dashboard-object-position-and-size-update-list",r.DataRowIndex="data-row-index",r.DataSchema="data-schema",r.DataSource="data-source",r.DataSourceDataTable="data-source-data-table",r.DataSourceId="data-source-id",r.DataSourceName="data-source-name",r.DataTable="data-table",r.DataTableReader="data-table-reader",r.DateRangeType="date-range-type",r.DeleteCount="delete-count",r.DeltaTimeMs="delta-time-ms",r.DimValSelectionModels="dimensionValueSelectionModels",r.DomainType="domain-type",r.EmbeddingAbstractQuery="embedding-abstract-query",r.EmbeddingBootstrapInfo="embedding-bootstrap-info",r.EncodingType="encoding-type",r.ExportCrosstabSheetMap="export-crosstab-sheet-map",r.ExportFile="export-file",r.ExportOriginUrl="export-origin-url",r.ExportPdfOptions="export-pdf-options",r.ExtensionBootstrapInfo="extension-bootstrap-info",r.ExtensionContextMenuIds="extension-context-menu-ids",r.ExtensionDialogH="extension-dialog-height",r.ExtensionDialogMessage="extension-dialog-message",r.ExtensionDialogPayload="extension-dialog-payload",r.ExtensionDialogResult="extension-dialog-result",r.ExtensionDialogStyle="extension-dialog-style",r.ExtensionDialogUrl="extension-dialog-url",r.ExtensionDialogW="extension-dialog-width",r.ExtensionLocator="extension-locator",r.ExtensionSettingsInfo="extension-settings-info",r.ExtensionZoneId="extension-zone-id",r.ExternalMenuDescription="external-menu-description",r.ExternalMenuHeader="external-menu-header",r.ExternalMenuItemDisplayName="external-menu-item-display-name",r.ExternalMenuItemId="external-menu-item-id",r.Field="field",r.FieldCount="field-count",r.FieldId="field-id",r.FieldName="field-name",r.FilterLevels="filter-levels",r.FilterRangeMax="filter-range-max",r.FilterRangeMin="filter-range-min",r.FilterRangeNullOption="filter-range-null-option",r.FilterUpdateType="filter-update-type",r.FilterValues="filter-values",r.FontNameListItems="font-name-list-items",r.FormattedText="formatted-text",r.FunctionName="function-name",r.FromIndex="from-index",r.HierValSelectionModels="hierarchicalValueSelectionModels",r.HighlightedData="highlighted-data",r.HoverTupleInteraction="hover-tuple-interaction",r.IgnoreAliases="ignore-aliases",r.IgnoreSelection="ignore-selection",r.IncludeAllColumns="include-all-columns",r.InvalidAggFieldName="invalid-agg-field-name",r.InvalidDates="invalid-dates",r.InvalidFieldCaption="invalid-field-caption",r.InvalidFields="invalid-fields",r.InvalidValues="invalid-values",r.IsAnalyticsAssistantAvailable="is-analytics-assistant-available",r.IsExcludeMode="is-exclude",r.IsExtensionDialog="is-extension-dialog",r.IsFromCalcDialog="is-from-calc-dialog",r.JoinDescription="join-description",r.LogicalTableId="logical-table-id",r.LogicalTableInfoList="logical-table-info-list",r.MarksCardIndex="marks-card-index",r.MaxHeight="max-height",r.MaxRows="max-rows",r.MaxWidth="max-width",r.MinHeight="min-height",r.MinWidth="min-width",r.PageRowCount="page-row-count",r.ParameterCaption="paremeter-caption",r.ParameterError="parameter-error",r.ParameterFieldName="parameter-field-name",r.ParameterInfo="parameter-info",r.ParameterInfos="parameter-infos",r.ParameterValue="parameter-value",r.PeriodType="period-type",r.PulseFieldName="fieldName",r.PulseFieldNames="fieldNames",r.PulseFilterDomainType="domainType",r.PulseFilterDomainSearchTerm="searchTerm",r.PulsePageSize="pageSize",r.PulseNextPageToken="nextPageToken",r.PulseFilters="filters",r.PulseTimeDimension="timeDimension",r.QuantitativeDomain="quantitative-dmain",r.QuantRangeSelectionModels="quantativeRangeSelectionModels",r.RangeN="range-n",r.ReplaySpeed="replay-speed",r.SelectedData="selected-data",r.SelectedSheetNames="selected-sheet-names",r.Selection="selection",r.SelectionList="selection-list",r.SelectionUpdateType="selectionUpdateType",r.SelectTuplesInteraction="select-tuples-interaction",r.SendNotifications="send-notifications",r.SettingsValues="settings-values",r.SharedFilterSheets="shared-filter-sheets",r.SharedFiltersInfo="shared-filters-info",r.SheetIdentifier="sheet-identifier",r.SheetName="sheet-name",r.SheetPath="sheet-path",r.ShouldRefreshDS="should-refresh-ds",r.ShowDataTableFormat="show-data-table-format",r.StartIndex="start-index",r.State="state",r.StoryPointIndex="story-point-index",r.StoryPointInfo="story-point-info",r.SwitchToSheetName="switch-to-sheet-name",r.TargetPoint="target-point",r.TestConversionParameter="test-conversion-parameter",r.Text="formatted-text",r.ToIndex="to-index",r.TooltipContext="tooltip-context",r.TooltipTextRequest="tooltip-text-request",r.TooltipText="tooltip-text",r.UnderlyingDataTable="underlying-data-table",r.UnderlyingSummaryDataTable="underlying-summary-data-table",r.Url="url",r.UseTabDelimiters="use-tab-delimiters",r.ViewDataTableCacheId="view-data-table-cache-id",r.ViewDataTableId="view-data-table-id",r.VisualId="visual-id",r.VisualSpecification="visual-specification",r.VizAPIInputJson="vizapi-input-json",r.VizAPIStateWithDataModel="vizapi-state-with-data-model",r.VizAPIStateWarningMsg="vizapi-state-warning-msg",r.VizAPISVG="vizapi-svg",r.WorksheetName="worksheet-name",r.WorksheetFilters="worksheet-filters",r.ZoneIdsVisibilityMap="zone-ids-visibility-map"},2400:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),(r=t.VerbId||(t.VerbId={})).ActivateNextStoryPoint="activate-next-story-point",r.ActivatePreviousStoryPoint="activate-previous-story-point",r.ActivateSheet="activateSheet",r.ActivateStoryPoint="activate-story-point",r.AddMarksCardFields="add-marks-card-fields",r.AppendExternalMenuItem="append-external-menu-item",r.ApplyCategoricalFilter="categorical-filter",r.ApplyPulseFilters="apply-pulse-filters",r.ApplyPulseTimeDimension="apply-pulse-time-dimension",r.ApplyRangeFilter="range-filter",r.ApplyRelativeDateFilter="apply-relative-date-Filter",r.Authenticate="authenticate",r.BlockExtension="block-extension",r.ChangeParameterValue="change-parameter-value",r.ChangeSharedFilter="change-shared-filter",r.ClearAllPulseFilters="clear-all-pulse-filters",r.ClearFilter="clear-filter",r.ClearPulseFilters="clear-pulse-filters",r.ClearSelectedMarks="clear-selected-marks",r.CloseDialog="close-dialog",r.CreateAnnotation="create-annotation",r.DashboardCategoricalFilter="dashboard-categorical-filter",r.DisplayDialog="display-dialog",r.DownloadWorkbook="download-workbook",r.EditAliasesDialog="edit-aliases-dialog",r.ExecuteExternalMenuItem="execute-external-menu-item",r.ExportCrosstab="export-crosstab",r.ExportCrosstabCsvDownload="export-crosstab-csv-download",r.ExportCrosstabExcelDownload="export-crosstab-excel-download",r.ExportData="export-data",r.ExportDataDownload="export-data-download",r.ExportImage="export-image",r.ExportPdf="export-pdf",r.ExportPdfDownload="export-pdf-download",r.ExportPowerpoint="export-powerpoint",r.ExportPowerpointDownload="export-powerpoint-download",r.FindParameter="find-parameter",r.GetActiveTables="get-active-tables",r.GetAllDataSources="get-all-data-sources",r.GetAnnotations="get-annotations",r.GetCategoricalDomain="get-categorical-domain",r.GetConnectionDescriptionSummaries="get-connection-description-summaries",r.GetCurrentSrc="get-current-src",r.GetCustomViews="get-custom-views",r.GetDashboardFilters="get-dashboard-filters",r.GetDataSource="get-datasource",r.GetDataSourceData="get-datasource-data",r.GetDataSources="get-data-sources",r.GetDataSummaryData="get-summary-data",r.GetDataSummaryDataReader="get-summary-data-reader",r.GetDataTableReaderPage="get-data-table-reader-page",r.GetEmbeddingAbstractQueryWithDataModel="get-embedding-abstract-query-with-data-model",r.GetEmbeddingClientInfo="get-embedding-client-info",r.GetVizStateWithDataModel="get-viz-state-with-data-model",r.GetExportCrosstabSheetMap="get-export-crosstab-sheet-map",r.GetExportPdfOptions="get-export-pdf-options",r.GetField="get-field",r.GetFieldAndDataSource="get-field-and-datasource",r.GetVisualSpecification="get-visual-specification",r.GetFilters="get-filters",r.GetFonts="get-fonts",r.GetHighlightedMarks="get-highlighted-marks",r.GetJoinDescription="get-join-description",r.GetLogicalTableData="get-logical-table-data",r.GetLogicalTableDataReader="get-logical-table-data-reader",r.GetLogicalTables="get-logical-tables",r.GetParametersForSheet="get-parameters-for-sheet",r.GetPulseCategoricalDomain="get-pulse-categorical-domain",r.GetPulseFilters="get-pulse-filters",r.GetPulseTimeDimension="get-pulse-time-dimension",r.GetRangeDomain="get-range-domain",r.GetSelectedMarks="get-selected-marks",r.GetSharedFilter="get-shared-filter",r.GetTooltipText="get-tooltip-text",r.GetUnderlyingData="get-underlying-data",r.GetUnderlyingTableData="get-underlying-table-data",r.GetUnderlyingTableDataReader="get-underlying-table-data-reader",r.GetUnderlyingTables="get-underlying-tables",r.HierarchicalFilter="hierachical-filter",r.InitializeExtension="initialize-extension",r.IsAnalyticsAssistantAvailable="is-analytics-assistant-available",r.LaunchAnalyticsAssistant="launch-analytics-assistant",r.MoveAndResizeZones="move-and-resize-zones",r.MoveMarksCardField="move-marks-card-field",r.RaiseLeaveMarkNavNotification="raise-leave-mark-nav-notification",r.RaiseHoverTupleNotification="raise-hover-tuple-notification",r.RaiseSelectTuplesNotification="raise-select-tuples-notification",r.Redo="redo",r.RefreshDataSource="refresh-data-source",r.ReleaseDataTableReader="release-data-table-reader",r.RemoveAnnotation="remove-annotation",r.RemoveCustomView="remove-custom-view",r.RemoveExternalMenuItem="remove-external-menu-item",r.RenameExternalMenu="rename-external-menu",r.ReplayAnimation="replay-animation",r.RevertStoryPoint="revert-story-point",r.RevertWorkbook="revert-workbook",r.SaveExtensionSettings="save-extension-settings",r.SaveWorkbookAsCustomView="save-workbook-as-custom-view",r.SelectByValue="select-by-value",r.SetActiveCustomViewAsDefault="set-active-custom-view-as-default",r.SetAutoUpdate="set-auto-update",r.SetClickThrough="set-click-through",r.SendDialogMessage="send-dialog-message",r.SetVizStateWithDataModel="set-viz-state-with-data-model",r.SetSheetSize="set-sheet-size",r.SetZoneVisibility="set-zone-visibility",r.Share="share",r.ShowCustomView="show-custom-view",r.SpliceMarksCardFields="splice-marks-card-fields",r.TestConversionVerb="test-conversion-verb",r.Undo="undo",r.UpdateCustomView="update-custom-view",r.VizAPI="viz-api"},2496:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),(r=t.AskDataOptionNames||(t.AskDataOptionNames={})).token="token",r.origin="origin",r.showEmbed="showEmbed",r.showPin="showPin",r.showSave="showSave",r.showShare="showShare",r.debug=":jsdebug",r.ApiID=":apiID",r.ApiExternalVersion=":apiExternalVersion",r.ApiInternalVersion=":apiInternalVersion",r.AskDataWebComponent=":askDataWebComponent"},2472:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),(r=t.PulseOptionNames||(t.PulseOptionNames={})).embed="embed",r.token="token",r.disableExploreFilter="disableExploreFilter",r.layout="embed_layout",r.theme="embed_theme",r.ApiExternalVersion=":apiExternalVersion",r.ApiInternalVersion=":apiInternalVersion",r.PulseWebComponent=":pulseWebComponent"},552:(e,t)=>{"use strict";var r,a,i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.ONE="1",e.ALERTS=":alerts",e.ALIAS="alias",e.ALLOW_DEFERRED_BOOTSTRAP=":allowDeferredBootstrap",e.ALLOW_AUTOGEN_WORKSHEET_PHONE_LAYOUTS="allowAutogenWorksheetPhoneLayouts",e.API_ID=":apiID",e.APP=":app",e.ATTACHMENT="attachment",e.IS_IPAD_APP="app",e.ANIMATE_TRANSITION=":animate_transition",e.ASCENDING="ascending",e.AUTHENTICATION="authentication",e.ATTRIBUTES="attributes",e.AUTHORING_SHEET=":authSheet",e.AXIS="axis",e.BOOTSTRAP_WHEN_NOTIFIED=":bootstrapWhenNotified",e.BROWSER_BACK_BUTTON_UNDO=":browserBackButtonUndo",e.BROWSER_RENDERING_ON="isBrowserRendering",e.BROWSER_RENDERING_THRESHOLD="browserRenderingThreshold",e.CHARSET="charset",e.CLIENT_DIMENSION="clientDimension",e.CLIENT_IP="client_ip",e.CLIENT_NUM="clientNum",e.COLON_EMBEDDED=":embedded",e.COLON_MOBILE=":mobile",e.COLON_DEEP_LINKING_DISABLED=":deepLinkingDisabled",e.COLON_WATERMARK=":watermark",e.COMMENTS=":comments",e.COMMENTING_ENABLED=":commentingEnabled",e.COMMENTING_MENTIONS_ENABLED=":commentingMentions",e.CONNECTION="connection",e.CREATED_BY_FEATURE="createdByFeature",e.CRYPTED_PASSWORD="crypted",e.CSSDEBUG=":cssdebug",e.CSV="csv",e.CUSTOM_VIEWS=":customViews",e.CV=":cv",e.CV_ID="cvId",e.DASHBOARD_PORT_SIZE="dashboardPortSize",e.DATA_DETAILS=":dataDetails",e.DATASOURCE="datasource",e.DEBUG=":debug",e.DELAY=":delay",e.DEPTH="depth",e.DEVICE_TYPE=":device",e.DEVICE_PIXEL_RATIO="devicePixelRatio",e.DEVICE_PREVIEW_MODE=":devicepreviewmode",e.DIMENSIONS=":dimensions",e.DISABLE_SHARED_SESSIONS=":disable_shared_sessions",e.DISABLE_URL_ACTIONS_POPUPS=":disableUrlActionsPopups",e.DIRECTION="direction",e.DISPLAY_OVERLAY=":display_overlay",e.DISPLAY_SHARE=":display_share",e.DISPLAY_SPINNER=":display_spinner",e.DISPLAY_STATIC_IMAGE=":display_static_image",e.DISPLAY_TABS="display_tabs",e.DISPLAY_VIEW_COUNT=":display_count",e.IGNORE_STICKY_SESSION=":ignore_sticky_session",e.INCREMENT_VIEW_COUNT=":increment_view_count",e.DOCMODE="docmode",e.DOMAIN="domain",e.DO_WORK="do_work",e.DX="dx",e.DY="dy",e.EDIT_DATA_ALERT=":editDataAlert",e.EMBED=":embed",e.EMBEDDED="embedded",e.ENCRYPTED="encrypted",e.API_EXTERNAL_VERSION=":apiExternalVersion",e.API_INTERNAL_VERSION=":apiInternalVersion",e.EXCLUDE="exclude",e.EXPORT_FORMAT=":export_format",e.FIELDNAME="fieldname",e.FIELD_NAME="field_name",e.FIELD_SEP="field_sep",e.FILE="file",e.FILTER_TILE_SIZE="filterTileSize",e.FN="fn",e.FOCUS="focus",e.FORCE_CACHE="force_cache",e.FORMAT="format",e.FORMAT_DATA_VALUE_LOCALLY="formatDataValueLocally",e.FROM_WG=":from_wg",e.GRAPHQL_DATABASE_ID=":graphQLDatabaseId",e.GRAPHQL_TABLE_ID=":graphQLTableId",e.GUID=":guid",e.H="h",e.HIDDEN="hidden",e.HIDE_CLOSE_BUTTON=":hideCloseButton",e.HIDE_EDIT_BUTTON=":hideEditButton",e.HIDE_EDIT_IN_DESKTOP_BUTTON=":hideEditInDesktopButton",e.HIGH_DPI=":highdpi",e.IMAGE_SIZE_LIMIT="imageSizeLimit",e.TRANSPARENT_LINE_MARKS_LIMIT="transparentLineMarkLimit",e.CLIENT_RENDER_PIXEL_LIMIT="clientRenderPixelLimit",e.IN="in",e.INSTANCE_ID=":iid",e.IS_GUEST_REDIRECT_FROM_VIZPORTAL=":isGuestRedirectFromVizportal",e.IS_MARK_ANIMATION_ENABLED="isMarkAnimationEnabled",e.IS_VIZPORTAL=":isVizPortal",e.INPUT_="input_string",e.JSDEBUG=":jsdebug",e.JSON="json",e.JSON_ONLY=":jsonOnly",e.KEEPFILE="keepfile",e.KEY="key",e.LANGUAGE="language",e.LANGUAGE_REQUESTED=":language",e.LINKTARGET=":linktarget",e.LOAD_ORDER_ID=":loadOrderID",e.LOAD_NEWEST_REVISION=":loadNewestRevision",e.LOCAL_PATHS=":localPaths",e.LOCALE="locale",e.LOCATION_ID="locationid",e.LOCATION_TYPE="locationtype",e.WORKBOOK_LOCALE="workbookLocale",e.MAXROWS="maxrows",e.MAX_AGE="maxAge",e.MAX_ROWS="maxRows",e.METHOD="method",e.MOBILE="mobile",e.MODIFIER="modifier",e.NAME="name",e.NAV_TYPE="navType",e.NAV_SRC="navSrc",e.NOATTACHMENT="no-attachment",e.NO_OVERWRITE="no_overwrite",e.OPEN_AUTHORING_IN_TOP_WINDOW=":openAuthoringInTopWindow",e.OPENID_HD=":openid_hd",e.OPENID_LOGIN_HINT=":openid_login_hint",e.OAUTHREQUEST="oauthrequest",e.OAUTH_CREDENTIAL_IDS="oauth_credential_ids",e.OFFLINE_MODE=":offlinemode",e.ORIGIN=":origin",e.OVERLAY=":overlay",e.P="p",e.PATH="path",e.PANE_RESOLVER_X="paneResolverX",e.PANE_RESOLVER_Y="paneResolverY",e.PARAM="param",e.PARENT_ID="parent_id",e.PASSWORD="password",e.PATTERN="pattern",e.PIXEL_RATIO=":pixelratio",e.PREFIX=":prefix",e.PREVIEW=":preview",e.PRIMARY_CONTENT_URL="primary_content_url",e.PROJECT="project",e.PROTOCOL="protocol",e.PSEUDO=":pseudo",e.QUERY="query",e.R="r",e.RANGE_TYPE="range_type",e.RECORD_SEP="record_sep",e.RECORD_CLIENT_PERFORMANCE=":record_client_performance",e.RECORD_PERFORMANCE=":record_performance",e.RECOVER_OLD_SESSION_ID=":recover_old_session_id",e.RECOVER_SESSION_STATE_TICKETS=":recover_session_state_tickets",e.REFRESH=":refresh",e.REFRESHUNMODIFIED=":refreshunmodified",e.REGION="region",e.RELOAD_ON_CUSTOM_VIEW_SAVE=":reloadOnCustomViewSave",e.RENDER=":render",e.RENDER_MAPS_CLIENT_SIDE="renderMapsClientSide",e.RETRY=":retry",e.REUSE="reuse",e.REUSE_FOREVER="reuse_forever",e.REVERT=":revert",e.SAVE_DB_PASSWORDS="save_db_passwords",e.SELECT_X="select_x",e.SELECT_Y="select_y",e.SESSION_FEATURE_PREFIX=":ff_",e.SESSION_FLAGS=":session_feature_flags",e.SHARE_BUTTON="share_button",e.SHEET_ID="sheet_id",e.SHARED="shared",e.SHOWALL="showall",e.SHOW_APP_BANNER=":showAppBanner",e.SHOW_ASK_DATA=":showAskData",e.SHOW_PARAMS="showParams",e.SHOW_SHARE_OPTIONS=":showShareOptions",e.SIZE=":size",e.SOURCE="source",e.STATE="state",e.STICKY_SESSION_KEY="stickySessionKey",e.SUBSCRIPTIONS=":subscriptions",e.SUMMARY="summary",e.SUPPRESS_DEFAULT_EDIT_BEHAVIOR=":suppressDefaultEditBehavior",e.SYNC_SESSION=":sync_session",e.SYNC_SESSION_STATE="sync_session_state",e.TABS=":tabs",e.TARGET="target",e.TARGET_SITE="target_site",e.TOOLBAR=":toolbar",e.TOOLTIP=":tooltip",e.TS="ts",e.UNDERLYING_TABLE_ID="underlying_table_id",e.UNDERLYING_TABLE_CAPTION="underlying_table_caption",e.UPDATE_TYPE="update_type",e.USE_GUEST=":useGuest",e.USE_INLINE_IMAGES="use_inline_images",e.USERAGENT="useragent",e.USERNAME="username",e.VALUE="value",e.VERBOSE_MODE="verboseMode",e.VIEW_ID="views_id",e.VIZ_SNAPSHOT_ID="viz_snapshot_id",e.VW=":vw",e.W="w",e.WORKSHEET_PORT_SIZE="worksheetPortSize",e.WATERMARK="watermark",e.WATERMARK_MARGIN=":watermark_margin",e.WB=":wb",e.WHICH="which",e.X="x",e.Y="y",e.ZID="zid",e.ZONE_ID="zone_id",e.KEYCHAIN_VERSION="keychain_version",e.DATASOURCE_ID="datasource_id",e.DATASOURCE_NAME="datasource_name",e.LENS_ID="lens_id",e.WIDTH="width",e.HEIGHT="height",e.LAYOUT_VIEWS="views",e.LAYOUT_MENUS="menus",e.LAYOUT_GEOMETRY="geometry",e.LAYOUT_PAGES="pages",e.LAYOUT_CACHEURL="cacheurl",e.LAYOUT_SHEET="sheet",e.LAYOUT_DEPTH="depth"}(r||(r={})),function(e){e.SHOW_VIZ_HOME=":showVizHome"}(a||(a={})),(i=t.VizOptionNames||(t.VizOptionNames={})).Size=":size",i.Embed=":embed",i.ApiInternalVersion=":apiInternalVersion",i.ApiExternalVersion=":apiExternalVersion",i.ShowVizHome=":showVizHome",i.Jsdebug=":jsdebug",i.BootstrapWhenNotified=":bootstrapWhenNotified",i.NavType="navType",i.NavSrc="navSrc",i.debug=":jsdebug",i.ApiID=":apiID",i.disableUrlActionsPopups=":disableUrlActionsPopups",i.hideTabs=":tabs",i.toolbar=":toolbar",i.device=":device",i.instanceIdToClone=":iid",i.touchOptimize="mobile",i.hideEditButton=":hideEditButton",i.hideEditInDesktopButton=":hideEditInDesktopButton",i.suppressDefaultEditBehavior=":suppressDefaultEditBehavior",i.hideCloseButton=":hideCloseButton"},3256:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(1808),i=r(3448),n=r(1680),s=r(4020),o=r(7204);t.CrossFrameMessenger=class{constructor(e,t,r){this.thisWindow=e,this.otherWindow=t,this.otherWindowOrigin=r}startListening(){if(!this.unregisterFunction){const e=this.onMessageReceived.bind(this);this.thisWindow.addEventListener("message",e,!0),this.unregisterFunction=()=>this.thisWindow.removeEventListener("message",e,!0)}}stopListening(){this.unregisterFunction&&(this.unregisterFunction(),this.unregisterFunction=void 0)}setInitializeMessageHandler(e){this.initializeMessageHandler=e}setCommandResponseMessageHandler(e){this.commandResponseMessageHandler=e}setCommandMessageHandler(e){this.commandMessageHandler=e}setNotificationMessageHandler(e){this.notificationMessageHandler=e}setHandshakeMessageHandler(e){this.handshakeMessageHandler=e}prepareInitializationMessage(e,t,r){const i={msgGuid:a.raw(),msgType:o.MessageType.Initialize,crossFrameVersion:t,apiVersion:e,options:r};return this.prepareMessage(i)}prepareCommandMessage(e,t){const r={msgGuid:a.raw(),msgType:o.MessageType.Command,verbId:e,parameters:t};return this.prepareMessage(r)}prepareCommandResponseMessage(e,t,r){const i={msgGuid:a.raw(),msgType:o.MessageType.CommandResponse,commandGuid:e,data:t,error:r};return r&&(i.error=JSON.parse(JSON.stringify(r))),this.prepareMessage(i)}prepareNotificationMessage(e,t){const r={msgGuid:a.raw(),msgType:o.MessageType.Notification,notificationId:e,data:t};return this.prepareMessage(r)}prepareAckMessage(){const e={msgGuid:a.raw(),msgType:o.MessageType.Ack,platformVersion:i.INTERNAL_CONTRACT_VERSION};return this.prepareMessage(e)}prepareMessage(e){if(!this.otherWindow||!this.otherWindowOrigin)throw"Other window not initialized, cannot dispatch messages";return new n.CrossFramePreparedMessage(e,this.otherWindow,this.otherWindowOrigin)}onMessageReceived(e){if(this.otherWindow&&e.source!==this.otherWindow)return;if(!e.data)return;const t=e.data;if(s.isMessage(t))switch(t.msgType){case o.MessageType.Initialize:if(!s.isInitMessage(t)||!this.initializeMessageHandler)return;this.initializeMessageHandler(t,e.source);break;case o.MessageType.CommandResponse:if(!s.isCommandResponseMessage(t)||!this.commandResponseMessageHandler)return;this.commandResponseMessageHandler(t,e.source);break;case o.MessageType.Command:if(!s.isCommandMessage(t)||!this.commandMessageHandler)return;this.commandMessageHandler(t,e.source);break;case o.MessageType.Notification:if(!s.isNotificationMessage(t)||!this.notificationMessageHandler)return;this.notificationMessageHandler(t,e.source);break;case o.MessageType.Handshake:if(!s.isHandshakeMessage(t)||!this.handshakeMessageHandler)return;this.handshakeMessageHandler(t,e.source)}}setOtherWindow(e){this.otherWindow=e}setOtherWindowOrigin(e){this.otherWindowOrigin=e}}},1680:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CrossFramePreparedMessage=class{constructor(e,t,r){this._message=e,this._target=t,this._origin=r}get messageGuid(){return this._message.msgGuid}send(){return this._target.postMessage(this._message,this._origin),this}}},4020:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(1808),i=r(5824),n=r(7204),s=new Set([i.NotificationId.EditButtonClicked,i.NotificationId.EditInDesktopButtonClicked,i.NotificationId.WorkbookPublished,i.NotificationId.WorkbookReadyToClose,i.NotificationId.ReadyToReceiveAuthToken]);function o(e){if(!e)return!1;const t=e;return!!(t&&t.msgGuid&&t.msgType)&&(!!a.isGuid(t.msgGuid)&&("string"==typeof t.msgType&&!([n.MessageType.Command,n.MessageType.CommandResponse,n.MessageType.Initialize,n.MessageType.Notification,n.MessageType.Handshake].indexOf(t.msgType)<0)))}function l(e){if(!e)return!1;const t=e;return"object"==typeof t&&"number"==typeof t.fix&&"number"==typeof t.minor&&"number"==typeof t.major}t.isMessage=o,t.isVersion=l,t.isInitMessage=function(e){if(!o(e))return!1;const t=e;return!!(t.msgType===n.MessageType.Initialize&&t.apiVersion&&l(t.apiVersion)&&t.crossFrameVersion&&l(t.crossFrameVersion))},t.isCommandResponseMessage=function(e){if(!o(e))return!1;const t=e;return!(t.msgType!==n.MessageType.CommandResponse||!a.isGuid(t.commandGuid)||!t.data&&!t.error)},t.isCommandMessage=function(e){if(!o(e))return!1;const t=e;return!(t.msgType!==n.MessageType.Command||!t.parameters||"object"!=typeof t.parameters||!t.verbId||"string"!=typeof t.verbId)},t.isNotificationMessage=function(e){if(!o(e))return!1;const t=e;return!(t.msgType!==n.MessageType.Notification||!t.data&&!s.has(t.notificationId)||!t.notificationId||"string"!=typeof t.notificationId)},t.isHandshakeMessage=function(e){return!!o(e)&&e.msgType===n.MessageType.Handshake}},7204:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),(r=t.MessageType||(t.MessageType={})).Initialize="initialize",r.Notification="notification",r.Command="command",r.CommandResponse="command-response",r.Handshake="v-handshake",r.Ack="v-ack"},1600:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IdentityVersionConverter=class{upgradeExecuteCall(e,t){return{verb:e,parameters:t}}downgradeExecuteReturn(e){return e}downgradeNotification(e){return e}}},2320:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StackingVersionConverter=class{constructor(e,t,r,a,i){if(this._externalMajorVersion=e,this._platformMajorVersion=t,this._upgradeExecuteTranslations=r,this._downgradeExecuteTranslations=a,this._downgradeNotificationTranslations=i,this._externalMajorVersion>this._platformMajorVersion)throw new Error(`Cannot convert between external version ${this._externalMajorVersion} and ${this._platformMajorVersion}`)}static fromData(e,t,r,a,i){return new this(e.major,t.major,r,a,i)}upgradeExecuteCall(e,t){let r={verb:e,parameters:t};for(const e of this._upgradeExecuteTranslations)r=e(r.verb,r.parameters);return r}downgradeExecuteReturn(e){let t=e;for(const e of this._downgradeExecuteTranslations)t=e(t);return t}downgradeNotification(e){let t=e;for(const e of this._downgradeNotificationTranslations)t=e(t);return t}}},3760:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(1600),i=r(2320),n=r(720);function s(e,t){return e.major===t.major&&e.minor===t.minor}function o(e,t,r,n,o){const d=e.major,c=e.minor,u=t.major;if(d>u)throw new Error(`External version must be less than or equal to platform version.\n    externalMajorVersion=${d} platformMajorVersion=${u}`);if(s(e,t))return new a.IdentityVersionConverter;const h=l(d,u,c,r),p=l(d,u,c,n),m=l(d,u,c,o);return p.reverse(),m.reverse(),i.StackingVersionConverter.fromData(e,t,h,p,m)}function l(e,t,r,a){const i=[];for(let n=e;n<=t;n++)if(n in a){const t=n===e?r:0,s=d(Object.keys(a[n]));for(let e=t;e<=s;e++)e in a[n]&&i.push(...a[n][e])}return i}function d(e){return e.map((e=>Number(e))).reduce(((e,t)=>e>t?e:t))}t.VersionLessThan=function(e,t){return!(e.major>t.major)&&(e.major<t.major||e.minor<t.minor)},t.VersionEqualTo=s,t.ExecuteMinorUpgrades={1:{9:[]}},t.ExecuteMinorDowngrades={1:{5:[n.DowngradeWorksheetNames],9:[],175:[n.DowngradeWorksheetFomatting175],182:[n.DowngradeExtensionEnvironmentContext]}},t.NotificationMinorDowngrades={1:{9:[],10:[n.DowngradeFlipboardZoneID],175:[n.DowngradeWorksheetFomattingNotification175]}},t.CreateVersionConverter=function(e,r){return o(e,r,t.ExecuteMinorUpgrades,t.ExecuteMinorDowngrades,t.NotificationMinorDowngrades)},t.CreateVersionConverterWithTranslators=o,t.GetMaximumMinorIndex=d},720:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(3448),i=r(5824);t.DowngradeWorksheetNames=function(e){const t=e.result;return void 0!==t.extensionDashboardInfo&&t.extensionDashboardInfo.zones.forEach((e=>{e.sheetInfo&&(e.name=e.sheetInfo.name)})),e},t.DowngradeFlipboardZoneID=function(e){if(e.notificationId===i.NotificationId.SelectedMarksChanged){const t=e.data;void 0===t.flipboardZoneID&&(t.flipboardZoneID=0)}return e};const n=["tableau-row-dividers","tableau-column-dividers","tableau-pane"];t.DowngradeWorksheetFomatting175=e=>function(e,t){var r,a;const i=e.result;return(null===(a=null===(r=i)||void 0===r?void 0:r.extensionWorksheetInfo)||void 0===a?void 0:a.formatting)&&(i.extensionWorksheetInfo.formatting.formattingSheets=i.extensionWorksheetInfo.formatting.formattingSheets.filter((e=>!t.includes(e.classNameKey)))),e}(e,n),t.DowngradeWorksheetFomattingNotification175=e=>function(e,t){if(e.notificationId===i.NotificationId.WorksheetFormattingChanged){const r=e.data;e.data=r.formattingSheets.filter((e=>!t.includes(e.classNameKey)))}return e}(e,n),t.DowngradeExtensionEnvironmentContext=function(e){const t=e.result;if(void 0!==t.extensionEnvironment){const e=t.extensionEnvironment.extensionContext;e===a.ExtensionContext.PublicWeb||e===a.ExtensionContext.Cloud?t.extensionEnvironment.extensionContext=a.ExtensionContext.Server:e===a.ExtensionContext.PublicDesktop&&(t.extensionEnvironment.extensionContext=a.ExtensionContext.Desktop)}return e}},4528:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExternalIdentityVersionConverter=class{downgradeExecuteCall(e,t){return{verb:e,parameters:t}}upgradeExecuteReturn(e,t,r){return e}upgradeNotification(e){return e}}},5768:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExternalStackingVersionConverter=class{constructor(e,t,r,a,i){if(this._externalVersion=e,this._platformVersion=t,this._downgradeExecuteCallTranslations=r,this._upgradeExecuteReturnTranslations=a,this._upgradeNotificationTranslations=i,this._externalVersion.major>this._platformVersion.major)throw new Error(`Cannot convert between external version ${this._externalVersion.major}\n      and ${this._platformVersion.major}`)}downgradeExecuteCall(e,t){let r={verb:e,parameters:t};for(const e of this._downgradeExecuteCallTranslations)r=e(r.verb,r.parameters);return r}upgradeExecuteReturn(e,t,r){let a=e;for(const e of this._upgradeExecuteReturnTranslations)a=e(a,t,r);return a}upgradeNotification(e){let t=e;for(const e of this._upgradeNotificationTranslations)t=e(t);return t}}},3388:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(3760),i=r(4528),n=r(5768);function s(e,t,r,s,l){const d=e.major,c=t.major,u=t.minor;if(d>c)throw new Error(`External version must be less than or equal to platform version.\n    externalMajorVersion=${d} platformMajorVersion=${c}`);if(d<c||a.VersionEqualTo(e,t))return new i.ExternalIdentityVersionConverter;const h=o(c,u,r),p=o(c,u,s),m=o(c,u,l);return h.reverse(),new n.ExternalStackingVersionConverter(e,t,h,p,m)}function o(e,t,r){const i=[];if(e in r){const n=t,s=a.GetMaximumMinorIndex(Object.keys(r[e]));for(let t=n;t<=s;t++)t in r[e]&&i.push(...r[e][t])}return i}t.ExecuteMinorDowngradeCallExternal={1:{9:[]}},t.ExecuteMinorUpgradeReturnExternal={1:{9:[]}},t.ExecuteMinorUpgradeNotification={1:{9:[]}},t.CreateExternalCompatibleVersionConverter=function(e,r){return s(e,r,t.ExecuteMinorDowngradeCallExternal,t.ExecuteMinorUpgradeReturnExternal,t.ExecuteMinorUpgradeNotification)},t.CreateExternalCompatibleVersionConverterWithTranslators=s},5136:(e,t,r)=>{"use strict";function a(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0});var i=r(2808);t.ApiVersion=i.ApiVersion,a(r(5184));var n=r(8540);t.CrossFrameDispatcher=n.CrossFrameDispatcher;var s=r(8340);t.DataSource=s.DataSource;var o=r(1044);t.ExternalToInternalEnumMappings=o.ExternalToInternalEnumMappings;var l=r(6557);t.InternalToExternalEnumMappings=l.InternalToExternalEnumMappings;var d=r(2680);t.EventListenerManager=d.EventListenerManager;var c=r(1072);t.Field=c.Field;var u=r(2520);t.CustomViewImpl=u.CustomViewImpl;var h=r(1940);t.DashboardImpl=h.DashboardImpl;var p=r(6488);t.DashboardObjectImpl=p.DashboardObjectImpl;var m=r(2180);t.DataSourceImpl=m.DataSourceImpl;var g=r(8552);t.ParameterImpl=g.ParameterImpl;var y=r(8332);t.SheetImpl=y.SheetImpl;var I=r(8736);t.SheetInfoImpl=I.SheetInfoImpl;var v=r(5144);t.SingleEventManagerImpl=v.SingleEventManagerImpl;var S=r(6804);t.StoryImpl=S.StoryImpl;var T=r(2608);t.StoryPointImpl=T.StoryPointImpl;var b=r(6068);t.StoryPointInfoImpl=b.StoryPointInfoImpl;var f=r(3044);t.WorkbookImpl=f.WorkbookImpl;var E=r(6500);t.WorksheetImpl=E.WorksheetImpl;var A=r(6368);t.Point=A.Point,a(r(8672)),a(r(3008));var P=r(1832);t.ClientInfoServiceImpl=P.ClientInfoServiceImpl;var _=r(1288);t.NotificationServiceImpl=_.NotificationServiceImpl;var w=r(8808);t.NotificationServiceImplBase=w.NotificationServiceImplBase,t.Registration=w.Registration;var D=r(1776);t.ServiceImplBase=D.ServiceImplBase;var C=r(4109);t.SizeServiceImpl=C.SizeServiceImpl;var F=r(2248);t.StoryActivationServiceImpl=F.StoryActivationServiceImpl;var x=r(6664);t.TableauError=x.TableauError;var M=r(1724);t.Deferred=M.Deferred;var k=r(7480);t.ErrorHelpers=k.ErrorHelpers;var N=r(5044);t.ExportHelpers=N.ExportHelpers;var R=r(2780);t.SheetUtils=R.SheetUtils;var V=r(1576);t.VersionNumber=V.VersionNumber;var O=r(8648);t.VersionedExternalApiDispatcher=O.VersionedExternalApiDispatcher},2808:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(1576);class i{static get Instance(){return i._instance}static SetVersionNumber(e,t){i._instance=new a.VersionNumber(e,t)}}t.ApiVersion=i},716:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionSummary=class{constructor(e){this._connectionInfo=e}get name(){return this._connectionInfo.name}get id(){return this._connectionInfo.id}get serverURI(){return this._connectionInfo.serverURI}get type(){return this._connectionInfo.type}}},5184:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(3448),i=r(8540);t.doCrossFrameBootstrap=function(e,t,r){return new Promise(((n,s)=>{let o;o=function(e){try{return e.self!==e.parent}catch(e){return!0}}(e)?e.parent:e.opener,o||s("This extension is not running inside an iframe, desktop, or popup window. Initialization failed.");const l=new a.CrossFrameMessenger(e,o,"*"),d=l.prepareInitializationMessage(t,a.MESSAGING_VERSION,r);l.setCommandResponseMessageHandler((function(e){e.commandGuid===d.messageGuid&&n((()=>new i.CrossFrameDispatcher(l)))})),l.startListening(),d.send()}))}},8540:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419);t.CrossFrameDispatcher=class{constructor(e){if(this._messenger=e,this._pendingPromises={},this._notificationHandlers=[],!this._messenger)throw"Missing messenger object";this._messenger.setCommandResponseMessageHandler(this.onCommandResponse.bind(this)),this._messenger.setNotificationMessageHandler(this.onNotification.bind(this))}execute(e,t){const r=this._messenger.prepareCommandMessage(e,t),a=new Promise(((e,t)=>{this._pendingPromises[r.messageGuid]={resolve:e,reject:t}}));return r.send(),a}registerNotificationHandler(e){this._notificationHandlers.push(e)}unregisterNotificationHandler(e){this._notificationHandlers=this._notificationHandlers.filter((t=>t!==e))}onCommandResponse(e){if(Object.keys(this._pendingPromises).indexOf(e.commandGuid)<0)return;const t=this._pendingPromises[e.commandGuid];e.error&&t.reject(e.error),e.data&&t.resolve({result:e.data}),delete this._pendingPromises[e.commandGuid]}onNotification(e){for(const t of this._notificationHandlers)try{t({notificationId:e.notificationId,data:e.data})}catch(e){if(e.errorCode===a.EmbeddingErrorCodes.IncompatibleVersionError)throw e}}}},8340:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataSource=class{constructor(e){this._dataSourceImpl=e}get name(){return this._dataSourceImpl.name}get id(){return this._dataSourceImpl.id}get fields(){return this._dataSourceImpl.fields}get extractUpdateTime(){return this._dataSourceImpl.extractUpdateTime}get isExtract(){return this._dataSourceImpl.isExtract}get isPublished(){return this._dataSourceImpl.isPublished}publishedUrl(){return this._dataSourceImpl.publishedUrl()}refreshAsync(){return this._dataSourceImpl.refreshAsync()}getActiveTablesAsync(){return console.warn("DataSource.getActiveTablesAsync is deprecated. Please use DataSource.getLogicalTablesAsync."),this._dataSourceImpl.getActiveTablesAsync()}getConnectionSummariesAsync(){return this._dataSourceImpl.getConnectionSummariesAsync()}getUnderlyingDataAsync(e){return console.warn("DataSource.getUnderlyingDataAsync is deprecated. Please use DataSource.getLogicalTablesAsync and DataSource.getLogicalTableDataAsync."),this._dataSourceImpl.getUnderlyingDataAsync(e)}getLogicalTablesAsync(){return this._dataSourceImpl.getLogicalTablesAsync()}getLogicalTableDataAsync(e,t){return this._dataSourceImpl.getLogicalTableDataAsync(e,t)}getLogicalTableDataReaderAsync(e,t,r){return this._dataSourceImpl.getLogicalTableDataReaderAsync(e,t,r)}}},1044:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(3448),n=r(5520);class s{}t.ExternalToInternalEnumMappings=s,s.filterDomainType=new n.EnumConverter({[a.FilterDomainType.Relevant]:i.FilterDomainType.Relevant,[a.FilterDomainType.Database]:i.FilterDomainType.Database}),s.nullOptions=new n.EnumConverter({[a.FilterNullOption.AllValues]:i.FilterNullOption.AllValues,[a.FilterNullOption.NonNullValues]:i.FilterNullOption.NonNullValues,[a.FilterNullOption.NullValues]:i.FilterNullOption.NullValues}),s.filterUpdateType=new n.EnumConverter({[a.FilterUpdateType.Add]:i.FilterUpdateType.Add,[a.FilterUpdateType.All]:i.FilterUpdateType.All,[a.FilterUpdateType.Remove]:i.FilterUpdateType.Remove,[a.FilterUpdateType.Replace]:i.FilterUpdateType.Replace}),s.setVisibilityType=new n.EnumConverter({[a.ZoneVisibilityType.Show]:!0,[a.ZoneVisibilityType.Hide]:!1}),s.setReplaySpeedType=new n.EnumConverter({[a.ReplaySpeedType.Slow]:2,[a.ReplaySpeedType.Normal]:1,[a.ReplaySpeedType.Fast]:.5}),s.sheetType=new n.EnumConverter({[a.SheetType.Dashboard]:i.SheetType.Dashboard,[a.SheetType.Worksheet]:i.SheetType.Worksheet,[a.SheetType.Story]:i.SheetType.Story}),s.showDataTableFormatType=new n.EnumConverter({[a.IncludeDataValuesOption.AllValues]:i.ApiShowDataTableFormat.NativeAndFormattedValues,[a.IncludeDataValuesOption.OnlyNativeValues]:i.ApiShowDataTableFormat.NativeValuesOnly,[a.IncludeDataValuesOption.OnlyFormattedValues]:i.ApiShowDataTableFormat.FormattedValuesOnly}),s.periodType=new n.EnumConverter({[a.PeriodType.Years]:i.DateStepPeriod.Years,[a.PeriodType.Quarters]:i.DateStepPeriod.Quarters,[a.PeriodType.Months]:i.DateStepPeriod.Months,[a.PeriodType.Weeks]:i.DateStepPeriod.Weeks,[a.PeriodType.Days]:i.DateStepPeriod.Days,[a.PeriodType.Hours]:i.DateStepPeriod.Hours,[a.PeriodType.Minutes]:i.DateStepPeriod.Minutes,[a.PeriodType.Seconds]:i.DateStepPeriod.Seconds}),s.dateRangeType=new n.EnumConverter({[a.DateRangeType.Last]:i.DateRangeType.Last,[a.DateRangeType.LastN]:i.DateRangeType.LastN,[a.DateRangeType.Next]:i.DateRangeType.Next,[a.DateRangeType.NextN]:i.DateRangeType.NextN,[a.DateRangeType.Current]:i.DateRangeType.Current,[a.DateRangeType.ToDate]:i.DateRangeType.ToDate}),s.dialogStyles=new n.EnumConverter({[a.DialogStyle.Window]:i.DialogStyle.Window,[a.DialogStyle.Modal]:i.DialogStyle.Modal,[a.DialogStyle.Modeless]:i.DialogStyle.Modeless})},6557:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(3448),n=r(5520);class s{}t.InternalToExternalEnumMappings=s,s.extensionContext=new n.EnumConverter({[i.ExtensionContext.Desktop]:a.ExtensionContext.Desktop,[i.ExtensionContext.Server]:a.ExtensionContext.Server,[i.ExtensionContext.PublicWeb]:a.ExtensionContext.PublicWeb,[i.ExtensionContext.PublicDesktop]:a.ExtensionContext.PublicDesktop,[i.ExtensionContext.Cloud]:a.ExtensionContext.Cloud}),s.extensionMode=new n.EnumConverter({[i.ExtensionMode.Authoring]:a.ExtensionMode.Authoring,[i.ExtensionMode.Viewing]:a.ExtensionMode.Viewing}),s.columnType=new n.EnumConverter({[i.ColumnType.Continuous]:a.ColumnType.Continuous,[i.ColumnType.Discrete]:a.ColumnType.Discrete,[i.ColumnType.Unknown]:a.ColumnType.Unknown}),s.fieldAggregationType=new n.EnumConverter({[i.FieldAggregationType.Attr]:a.FieldAggregationType.Attr,[i.FieldAggregationType.Avg]:a.FieldAggregationType.Avg,[i.FieldAggregationType.Collect]:a.FieldAggregationType.Collect,[i.FieldAggregationType.Count]:a.FieldAggregationType.Count,[i.FieldAggregationType.Countd]:a.FieldAggregationType.Countd,[i.FieldAggregationType.Day]:a.FieldAggregationType.Day,[i.FieldAggregationType.End]:a.FieldAggregationType.End,[i.FieldAggregationType.Hour]:a.FieldAggregationType.Hour,[i.FieldAggregationType.InOut]:a.FieldAggregationType.InOut,[i.FieldAggregationType.Kurtosis]:a.FieldAggregationType.Kurtosis,[i.FieldAggregationType.Max]:a.FieldAggregationType.Max,[i.FieldAggregationType.Mdy]:a.FieldAggregationType.Mdy,[i.FieldAggregationType.Median]:a.FieldAggregationType.Median,[i.FieldAggregationType.Min]:a.FieldAggregationType.Min,[i.FieldAggregationType.Minute]:a.FieldAggregationType.Minute,[i.FieldAggregationType.MonthYear]:a.FieldAggregationType.MonthYear,[i.FieldAggregationType.None]:a.FieldAggregationType.None,[i.FieldAggregationType.Qtr]:a.FieldAggregationType.Qtr,[i.FieldAggregationType.Quart1]:a.FieldAggregationType.Quart1,[i.FieldAggregationType.Quart3]:a.FieldAggregationType.Quart3,[i.FieldAggregationType.Second]:a.FieldAggregationType.Second,[i.FieldAggregationType.Skewness]:a.FieldAggregationType.Skewness,[i.FieldAggregationType.Stdev]:a.FieldAggregationType.Stdev,[i.FieldAggregationType.Stdevp]:a.FieldAggregationType.Stdevp,[i.FieldAggregationType.Sum]:a.FieldAggregationType.Sum,[i.FieldAggregationType.TruncDay]:a.FieldAggregationType.TruncDay,[i.FieldAggregationType.TruncHour]:a.FieldAggregationType.TruncHour,[i.FieldAggregationType.TruncMinute]:a.FieldAggregationType.TruncMinute,[i.FieldAggregationType.TruncMonth]:a.FieldAggregationType.TruncMonth,[i.FieldAggregationType.TruncQtr]:a.FieldAggregationType.TruncQtr,[i.FieldAggregationType.TruncSecond]:a.FieldAggregationType.TruncSecond,[i.FieldAggregationType.TruncWeek]:a.FieldAggregationType.TruncWeek,[i.FieldAggregationType.TruncYear]:a.FieldAggregationType.TruncYear,[i.FieldAggregationType.User]:a.FieldAggregationType.User,[i.FieldAggregationType.Var]:a.FieldAggregationType.Var,[i.FieldAggregationType.Varp]:a.FieldAggregationType.Varp,[i.FieldAggregationType.Week]:a.FieldAggregationType.Week,[i.FieldAggregationType.Weekday]:a.FieldAggregationType.Weekday,[i.FieldAggregationType.Year]:a.FieldAggregationType.Year}),s.fieldRoleType=new n.EnumConverter({[i.FieldRoleType.Dimension]:a.FieldRoleType.Dimension,[i.FieldRoleType.Measure]:a.FieldRoleType.Measure,[i.FieldRoleType.Unknown]:a.FieldRoleType.Unknown}),s.sheetType=new n.EnumConverter({[i.SheetType.Dashboard]:a.SheetType.Dashboard,[i.SheetType.Story]:a.SheetType.Story,[i.SheetType.Worksheet]:a.SheetType.Worksheet}),s.dashboardObjectType=new n.EnumConverter({[i.DashboardObjectType.Extension]:a.DashboardObjectType.Extension,[i.DashboardObjectType.Blank]:a.DashboardObjectType.Blank,[i.DashboardObjectType.Image]:a.DashboardObjectType.Image,[i.DashboardObjectType.Legend]:a.DashboardObjectType.Legend,[i.DashboardObjectType.PageFilter]:a.DashboardObjectType.PageFilter,[i.DashboardObjectType.ParameterControl]:a.DashboardObjectType.ParameterControl,[i.DashboardObjectType.QuickFilter]:a.DashboardObjectType.QuickFilter,[i.DashboardObjectType.Text]:a.DashboardObjectType.Text,[i.DashboardObjectType.Title]:a.DashboardObjectType.Title,[i.DashboardObjectType.WebPage]:a.DashboardObjectType.WebPage,[i.DashboardObjectType.Worksheet]:a.DashboardObjectType.Worksheet}),s.dataType=new n.EnumConverter({[i.DataType.Bool]:a.DataType.Bool,[i.DataType.Date]:a.DataType.Date,[i.DataType.DateTime]:a.DataType.DateTime,[i.DataType.Float]:a.DataType.Float,[i.DataType.Int]:a.DataType.Int,[i.DataType.Spatial]:a.DataType.Spatial,[i.DataType.String]:a.DataType.String}),s.filterUpdateType=new n.EnumConverter({[i.FilterUpdateType.Add]:a.FilterUpdateType.Add,[i.FilterUpdateType.All]:a.FilterUpdateType.All,[i.FilterUpdateType.Remove]:a.FilterUpdateType.Remove,[i.FilterUpdateType.Replace]:a.FilterUpdateType.Replace}),s.allowableValues=new n.EnumConverter({[i.DomainRestrictionType.All]:a.ParameterValueType.All,[i.DomainRestrictionType.List]:a.ParameterValueType.List,[i.DomainRestrictionType.Range]:a.ParameterValueType.Range}),s.dateStepPeriod=new n.EnumConverter({[i.DateStepPeriod.Years]:a.PeriodType.Years,[i.DateStepPeriod.Quarters]:a.PeriodType.Quarters,[i.DateStepPeriod.Months]:a.PeriodType.Months,[i.DateStepPeriod.Weeks]:a.PeriodType.Weeks,[i.DateStepPeriod.Days]:a.PeriodType.Days,[i.DateStepPeriod.Hours]:a.PeriodType.Hours,[i.DateStepPeriod.Minutes]:a.PeriodType.Minutes,[i.DateStepPeriod.Seconds]:a.PeriodType.Seconds}),s.dateRangeType=new n.EnumConverter({[i.DateRangeType.Current]:a.DateRangeType.Current,[i.DateRangeType.Last]:a.DateRangeType.Last,[i.DateRangeType.LastN]:a.DateRangeType.LastN,[i.DateRangeType.Next]:a.DateRangeType.Next,[i.DateRangeType.NextN]:a.DateRangeType.NextN,[i.DateRangeType.ToDate]:a.DateRangeType.ToDate}),s.errorCode=new n.EnumConverter({[i.ErrorCodes.INITIALIZATION_ERROR]:a.ErrorCodes.InternalError,[i.ErrorCodes.INTERNAL_ERROR]:a.ErrorCodes.InternalError,[i.ErrorCodes.MISSING_ENUM_MAPPING]:a.ErrorCodes.InternalError,[i.ErrorCodes.MISSING_PARAMETER]:a.ErrorCodes.InternalError,[i.ErrorCodes.PERMISSION_DENIED]:a.ErrorCodes.InternalError,[i.ErrorCodes.PRES_MODEL_PARSING_ERROR]:a.ErrorCodes.InternalError,[i.ErrorCodes.UNKNOWN_VERB_ID]:a.ErrorCodes.InternalError,[i.ErrorCodes.VERSION_NOT_CONFIGURED]:a.ErrorCodes.APINotInitialized,[i.ErrorCodes.VISIBILITY_ERROR]:a.ErrorCodes.VisibilityError},a.ErrorCodes.InternalError),s.filterType=new n.EnumConverter({[i.FilterType.Categorical]:a.FilterType.Categorical,[i.FilterType.Range]:a.FilterType.Range,[i.FilterType.RelativeDate]:a.FilterType.RelativeDate,[i.FilterType.Hierarchical]:a.FilterType.Hierarchical}),s.classNameKey=new n.EnumConverter({"tableau-dashboard-title":a.ClassNameKey.DashboardTitle,"tableau-story-title":a.ClassNameKey.StoryTitle,"tableau-tooltip":a.ClassNameKey.Tooltip,"tableau-worksheet":a.ClassNameKey.Worksheet,"tableau-worksheet-title":a.ClassNameKey.WorksheetTitle,"tableau-pane":a.ClassNameKey.Pane,"tableau-row-dividers":a.ClassNameKey.RowDividers,"tableau-column-dividers":a.ClassNameKey.ColumnDividers,"dashboard-title":a.ClassNameKey.DashboardTitle,"story-title":a.ClassNameKey.StoryTitle,tooltip:a.ClassNameKey.Tooltip,worksheet:a.ClassNameKey.Worksheet,"worksheet-title":a.ClassNameKey.WorksheetTitle,pane:a.ClassNameKey.Pane,"row-dividers":a.ClassNameKey.RowDividers,"column-dividers":a.ClassNameKey.ColumnDividers}),s.hierarchicalLevelSelectionState=new n.EnumConverter({[i.HierarchicalLevelSelectionState.AllSelected]:a.HierarchicalLevelSelectionState.AllSelected,[i.HierarchicalLevelSelectionState.NoneSelected]:a.HierarchicalLevelSelectionState.NoneSelected,[i.HierarchicalLevelSelectionState.SomeSelected]:a.HierarchicalLevelSelectionState.SomeSelected,[i.HierarchicalLevelSelectionState.UnknownSelected]:a.HierarchicalLevelSelectionState.UnknownSelected}),s.annotationType=new n.EnumConverter({[i.AnnotateEnum.Area]:a.AnnotationType.Area,[i.AnnotateEnum.Mark]:a.AnnotationType.Mark,[i.AnnotateEnum.Point]:a.AnnotationType.Point}),s.markType=new n.EnumConverter({[i.MarkType.Area]:a.MarkType.Area,[i.MarkType.Bar]:a.MarkType.Bar,[i.MarkType.Circle]:a.MarkType.Circle,[i.MarkType.GanttBar]:a.MarkType.GanttBar,[i.MarkType.Heatmap]:a.MarkType.Heatmap,[i.MarkType.Line]:a.MarkType.Line,[i.MarkType.Map]:a.MarkType.Map,[i.MarkType.Pie]:a.MarkType.Pie,[i.MarkType.Polygon]:a.MarkType.Polygon,[i.MarkType.Shape]:a.MarkType.Shape,[i.MarkType.Square]:a.MarkType.Square,[i.MarkType.Text]:a.MarkType.Text,[i.MarkType.VizExtension]:a.MarkType.VizExtension})},2680:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(6664);t.EventListenerManager=class{constructor(){this._eventListenerManagers={}}addEventListener(e,t){if(!this._eventListenerManagers.hasOwnProperty(e))throw new i.TableauError(a.ErrorCodes.UnsupportedEventName,`Cannot add event, unsupported event type: ${e}`);return this._eventListenerManagers[e].addEventListener(t)}removeEventListener(e,t){if(!this._eventListenerManagers.hasOwnProperty(e))throw new i.TableauError(a.ErrorCodes.UnsupportedEventName,`Cannot remove event, unsupported event type: ${e}`);return this._eventListenerManagers[e].removeEventListener(t)}addNewEventType(e){this._eventListenerManagers[e.eventType]=e}}},1072:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Field=class{constructor(e){this._fieldImpl=e}get name(){return this._fieldImpl.name}get id(){return this._fieldImpl.id}get description(){return this._fieldImpl.description}get dataType(){return this._fieldImpl.dataType}get aggregation(){return this._fieldImpl.aggregation}get dataSource(){return this._fieldImpl.dataSource}get role(){return this._fieldImpl.role}get columnType(){return this._fieldImpl.columnType}get isCalculatedField(){return this._fieldImpl.isCalculatedField}get isCombinedField(){return this._fieldImpl.isCombinedField}get isGenerated(){return this._fieldImpl.isGenerated}get isGeospatial(){return this._fieldImpl.isGeospatial}get isHidden(){return this._fieldImpl.isHidden}get isPresentOnPublishedDatasource(){return this._fieldImpl.isPresentOnPublishedDatasource}}},2520:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(5136);t.CustomViewImpl=class{constructor(e,t){this._registryId=t,this._luid=e.luid,this._name=e.name,this._shared=e.shared,this._isDefault=e.isDefault,this._ownerName=e.owner.userFriendlyName,this._url=e.url}get luid(){return this._luid}get name(){return this._name}set name(e){this._name=e}get shared(){return this._shared}set shared(e){this._shared=e}get isDefault(){return this._isDefault}set isDefault(e){this._isDefault=e}get ownerName(){return this._ownerName}get url(){return this._url}saveAsync(){return a.ApiServiceRegistry.get(this._registryId).getService("viz-service").saveAsync(this)}}},1940:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(7419),n=r(3448),s=r(6557),o=r(6368),l=r(3008),d=r(6664),c=r(7480),u=r(6488),h=r(8332),p=r(8736),m=r(6500);class g extends h.SheetImpl{constructor(e,t,r,a,i,n=0){super(e,a),this._zones=t,this._sheetPath=r,this._parentStoryPointImpl=i,this._activeDashboardObjectId=n}get worksheetsImpl(){return this._worksheetsImpl}get objects(){return this._objects}get parentStoryPoint(){return this._parentStoryPointImpl}get activeDashboardObjectId(){return this._activeDashboardObjectId}get activeDashboardName(){return this._sheetPath.sheetName}initializeWithPublicInterfaces(){this._worksheetsImpl=new Array,this._objects=new Array,this.zoneMap=new Map;for(const e of this._zones){let t;const r={width:e.width,height:e.height},a=!1;if(e.zoneType===n.DashboardObjectType.Worksheet||e.zoneType===n.DashboardObjectType.QuickFilter){let s="",o="",l=!1;e.sheetInfo?(s=e.sheetInfo.name,o=e.sheetInfo.url||"",l=""===o):s=e.name;const d=new p.SheetInfoImpl(s,i.SheetType.Worksheet,r,this._worksheetsImpl.length,a,l,o),c={worksheet:s,dashboard:this._sheetInfoImpl.name,storyboard:this._sheetPath.storyboard,flipboardZoneID:this._sheetPath.flipboardZoneID,storyPointID:this._sheetPath.storyPointID};t=new m.WorksheetImpl(d,this._registryId,c,this,this._parentStoryPointImpl),e.zoneType===n.DashboardObjectType.Worksheet&&this._worksheetsImpl.push(t)}const l=new o.Point(e.x,e.y),d=new u.DashboardObjectImpl(this,s.InternalToExternalEnumMappings.dashboardObjectType.convert(e.zoneType),l,r,t,e.name,void 0!==e.isFloating&&e.isFloating,void 0===e.isVisible||e.isVisible,e.zoneId,e.fieldId);this._objects.push(d),this.zoneMap.set(e.zoneId,d)}}setDashboardObjectVisibilityAsync(e){return l.ApiServiceRegistry.get(this._registryId).getService("zone-service").setVisibilityAsync(this.name,this.zoneMap,e)}getDashboardObjectById(e){return this.zoneMap.get(e)}updateZones(e,t=0,r=""){const a=this._objects,n=this.zoneMap,s=this._activeDashboardObjectId,o=this._sheetPath.sheetName;this._zones=e,this._activeDashboardObjectId=t,r&&(this._sheetPath.sheetName=r,this._sheetInfoImpl.name=r),this.initializeWithPublicInterfaces();const l=this._objects,d=this.zoneMap,c=new Map;return a.forEach((e=>{const t=e.id;if(!d.has(t))return void this.addChange(t,c,i.DashboardLayoutChange.Removed);const r=d.get(t);e.isFloating!==r.isFloating&&this.addChange(t,c,i.DashboardLayoutChange.IsFloatingChanged),e.isVisible!==r.isVisible&&this.addChange(t,c,i.DashboardLayoutChange.IsVisibleChanged),e.name!==r.name&&this.addChange(t,c,i.DashboardLayoutChange.NameChanged),e.position.x===r.position.x&&e.position.y===r.position.y||this.addChange(t,c,i.DashboardLayoutChange.PositionChanged),e.size.width===r.size.width&&e.size.height===r.size.height||this.addChange(t,c,i.DashboardLayoutChange.SizeChanged)})),l.forEach((e=>{n.has(e.id)||this.addChange(e.id,c,i.DashboardLayoutChange.Added)})),s!==t&&(0!==t&&this.addChange(t,c,i.DashboardLayoutChange.Selected),0!==s&&this.addChange(s,c,i.DashboardLayoutChange.Deselected)),r&&o!==r&&this.addChange(0,c,i.DashboardLayoutChange.DashboardChanged),c}addChange(e,t,r){t.has(e)||t.set(e,[]),t.get(e).push(r)}moveAndResizeDashboardObjectsAsync(e){return l.ApiServiceRegistry.get(this._registryId).getService("zone-service").moveAndResizeAsync(this.name,this.zoneMap,e)}replayAnimationAsync(e){return l.ApiServiceRegistry.get(this._registryId).getService("animation-service").replayAsync(e)}getFiltersAsync(){return this.verifyActiveSheetOrEmbeddedInActiveStoryPoint(),l.ApiServiceRegistry.get(this._registryId).getService("filter-service").getDashboardFiltersAsync()}applyFilterAsync(e,t,r,n){if(c.ErrorHelpers.verifyEnumValue(r,a.FilterUpdateType,"FilterUpdateType"),c.ErrorHelpers.verifyStringParameter(e,"fieldName"),!Array.isArray(t))throw new d.TableauError(i.ErrorCodes.InvalidParameter,"values parameter for applyDashboardFilterAsync must be an array");return this.verifyActiveSheetOrEmbeddedInActiveStoryPoint(),l.ApiServiceRegistry.get(this._registryId).getService("filter-service").applyDashboardFilterAsync(e,t,r,n)}getWorksheetNamesFromZones(){const e=[];for(const t of this._zones){if(t.zoneType!==n.DashboardObjectType.Worksheet)continue;const r=t.sheetInfo?t.sheetInfo.name:t.name;e.push(r)}return e}verifyActiveSheetOrEmbeddedInActiveStoryPoint(){const e=this.active,t=null!=this.parentStoryPoint&&this.parentStoryPoint.active;if(!e&&!t)throw new d.TableauError(i.SharedErrorCodes.NotActiveSheet,"Operation not allowed on non-active sheet")}}t.DashboardImpl=g},6488:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DashboardObjectImpl=class{constructor(e,t,r,a,i,n,s,o,l,d){this._dashboardImpl=e,this._type=t,this._position=r,this._size=a,this._worksheetImpl=i,this._name=n,this._isFloating=s,this._isVisible=o,this._id=l,this._fieldId=d}get dashboardImpl(){return this._dashboardImpl}get type(){return this._type}get position(){return this._position}get size(){return this._size}get worksheetImpl(){return this._worksheetImpl}get name(){return this._name}get isFloating(){return this._isFloating}get isVisible(){return this._isVisible}get id(){return this._id}get fieldId(){return this._fieldId}}},2180:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(716),n=r(1072),s=r(624),o=r(3008),l=r(7603),d=r(7480),c=r(5288);t.DataSourceImpl=class{constructor(e,t){this._dataSourceInfo=e,this._registryId=t,this._fields=e.fields.map((e=>{const t=new c.FieldImpl(e,this);return new n.Field(t)}))}get name(){return this._dataSourceInfo.name}get id(){return this._dataSourceInfo.id}get extractUpdateTime(){return this._dataSourceInfo.extractUpdateTime}get fields(){return this._fields}get isExtract(){return this._dataSourceInfo.isExtract}get isPublished(){return this._dataSourceInfo.isPublished}publishedUrl(){return this._dataSourceInfo.publishedUrl}getMaxPageRowLimit(){return 1e4}refreshAsync(){return o.ApiServiceRegistry.get(this._registryId).getService("data-source-service").refreshAsync(this._dataSourceInfo.id)}getConnectionSummariesAsync(){return o.ApiServiceRegistry.get(this._registryId).getService("data-source-service").getConnectionSummariesAsync(this._dataSourceInfo.id).then((e=>e.map((e=>new i.ConnectionSummary(e)))))}getActiveTablesAsync(){return o.ApiServiceRegistry.get(this._registryId).getService("data-source-service").getActiveTablesAsync(this._dataSourceInfo.id).then((e=>e.map((e=>new l.TableSummary(e)))))}getUnderlyingDataAsync(e){return e=e||{},o.ApiServiceRegistry.get(this._registryId).getService("get-data-service").getDataSourceDataAsync(this.id,!!e.ignoreAliases,e.maxRows||0,e.columnsToInclude||[],e.columnsToIncludeById||[],e.includeDataValuesOption||a.IncludeDataValuesOption.AllValues)}getLogicalTableDataAsync(e,t){return t=t||{},o.ApiServiceRegistry.get(this._registryId).getService("get-data-service").getLogicalTableDataAsync(this.id,e,!!t.ignoreAliases,t.maxRows||0,t.columnsToInclude||[],t.columnsToIncludeById||[],t.includeDataValuesOption||a.IncludeDataValuesOption.AllValues)}getLogicalTableDataReaderAsync(e,t,r){return r=r||{},o.ApiServiceRegistry.get(this._registryId).getService("get-data-service").getLogicalTableDataReaderAsync(this.id,e,t||this.getMaxPageRowLimit(),!!r.ignoreAliases,r.columnsToIncludeById||[],r.includeDataValuesOption||a.IncludeDataValuesOption.AllValues)}initializeWithPublicInterfaces(e){d.ErrorHelpers.verifyInternalValue(e,"dataSource"),this._fields=this._dataSourceInfo.fields.map((t=>{const r=new c.FieldImpl(t,e);return new n.Field(r)}))}getLogicalTablesAsync(){return o.ApiServiceRegistry.get(this._registryId).getService("data-source-service").getLogicalTablesAsync(this.id).then((e=>e.map((e=>new s.LogicalTable(e)))))}}},5288:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(3448),n=r(6557);t.FieldImpl=class{constructor(e,t){this._fieldInfo=e,this._parentDataSource=t}get name(){return this._fieldInfo.name}get id(){return this._fieldInfo.id}get description(){return this._fieldInfo.description}get dataType(){var e;return null!=(e=this._fieldInfo.dataType)?e:a.DataType.Unknown}get aggregation(){return n.InternalToExternalEnumMappings.fieldAggregationType.convert(this._fieldInfo.aggregation)}get dataSource(){if(!this._parentDataSource)throw new Error("Data source information is not available for this field. Please use getFieldAsync method to get field's data source information");return this._parentDataSource}get role(){return n.InternalToExternalEnumMappings.fieldRoleType.convert(this._fieldInfo.role)}get columnType(){let e=this._fieldInfo.columnType||i.ColumnType.Unknown;return n.InternalToExternalEnumMappings.columnType.convert(e)}get isCalculatedField(){return this._fieldInfo.isCalculatedField}get isCombinedField(){return this._fieldInfo.isCombinedField}get isGenerated(){return this._fieldInfo.isGenerated}get isGeospatial(){return this._fieldInfo.isGeospatial}get isHidden(){return this._fieldInfo.isHidden}get isPresentOnPublishedDatasource(){return this._fieldInfo.isPresentOnPublishedDatasource}}},8552:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(6557),n=r(3008),s=r(8052),o=r(7480),l=r(1172);t.ParameterImpl=class{constructor(e,t){this._registryId=t,this.setParameterInfo(e)}get name(){return this._parameterInfo.name}get currentValue(){return s.DataValueFactory.MakeParameterDataValue(this._parameterInfo.currentValue,this._parameterInfo.dataType)}get dataType(){return i.InternalToExternalEnumMappings.dataType.convert(this._parameterInfo.dataType)}get id(){return this._globalFieldName}get allowableValues(){return this._allowableValues}changeValueAsync(e){o.ErrorHelpers.verifyParameter(e,"newValue");const t=l.Param.serializeParameterValue(e);return n.ApiServiceRegistry.get(this._registryId).getService("parameters-service").changeParameterValueAsync(this._globalFieldName,t).then((e=>(this.setParameterInfo(e),this.currentValue)))}setParameterInfo(e){this._parameterInfo=e,this._globalFieldName=e.fieldName;const t=i.InternalToExternalEnumMappings.allowableValues.convert(e.allowableValuesType);let r,n,o,l,d;t===a.ParameterValueType.List?r=(e.allowableValues||[]).map((t=>s.DataValueFactory.MakeParameterDataValue(t,e.dataType))):t===a.ParameterValueType.Range&&(n=e.minValue&&s.DataValueFactory.MakeParameterDataValue(e.minValue,e.dataType),o=e.maxValue&&s.DataValueFactory.MakeParameterDataValue(e.maxValue,e.dataType),l=e.stepSize,d=e.dateStepPeriod&&i.InternalToExternalEnumMappings.dateStepPeriod.convert(e.dateStepPeriod)),this._allowableValues={type:t,allowableValues:r,minValue:n,maxValue:o,stepSize:l,dateStepPeriod:d}}}},8332:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(3008),n=r(6664),s=r(7480),o=r(1172),l=r(2780);class d{constructor(e,t){this._sheetInfoImpl=e,this._registryId=t}get name(){return this._sheetInfoImpl.name}get sheetType(){return this._sheetInfoImpl.sheetType}get sheetPath(){return this._sheetInfoImpl.sheetPath}get size(){return this._sheetInfoImpl.sheetSize}get hidden(){if(void 0!==this._sheetInfoImpl.isHidden)return this._sheetInfoImpl.isHidden;throw new n.TableauError(a.EmbeddingErrorCodes.ImplementationError,"isHidden not implemented")}get active(){if(void 0!==this._sheetInfoImpl.isActive)return this._sheetInfoImpl.isActive;throw new n.TableauError(a.EmbeddingErrorCodes.ImplementationError,"active not implemented")}set active(e){void 0!==this._sheetInfoImpl.isActive&&(this._sheetInfoImpl.active=e)}get index(){if(void 0!==this._sheetInfoImpl.index)return this._sheetInfoImpl.index;throw new n.TableauError(a.EmbeddingErrorCodes.ImplementationError,"index not implemented")}get url(){if(void 0!==this._sheetInfoImpl.url)return this._sheetInfoImpl.url;throw new n.TableauError(a.EmbeddingErrorCodes.ImplementationError,"url not implemented")}getSheetSize(){if(!l.SheetUtils.isValidSheetSize(this.size))throw new n.TableauError(a.EmbeddingErrorCodes.InternalError,"size is not of type SheetSize");return this.size}findParameterAsync(e){return s.ErrorHelpers.verifyParameter(e,"parameterName"),i.ApiServiceRegistry.get(this._registryId).getService("parameters-service").findParameterByNameAsync(e)}getParametersAsync(){return i.ApiServiceRegistry.get(this._registryId).getService("parameters-service").getParametersForSheetAsync(this.sheetPath)}changeSizeAsync(e){const t=new n.TableauError(a.EmbeddingErrorCodes.InvalidSize,"Invalid sheet size parameter");if(!e||!e.behavior)throw t;const r=this.normalizeSheetSize(e),s=r.behavior===a.SheetSizeBehavior.Automatic;if(!s&&!r.minSize&&!r.maxSize)throw t;if(!s&&this.sheetType===a.SheetType.Worksheet)throw new n.TableauError(a.EmbeddingErrorCodes.InvalidSizeBehaviorOnWorksheet,"Only SheetSizeBehavior.Automatic is allowed on Worksheets");if(s&&this.getSheetSize().behavior===r.behavior)return Promise.resolve(e);const o=this.processNewSize(r);return i.ApiServiceRegistry.get(this._registryId).getService("size-service").changeSizeAsync(this.name,o).then((()=>i.ApiServiceRegistry.get(this._registryId).getService("client-info-service").getClientInfoAsync().then((e=>{const t=e.publishedSheets.find((e=>e.name===this.name));if(!t)throw new n.TableauError(a.SharedErrorCodes.InternalError,`Can't find sheet with name ${this.name}`);const r=l.SheetUtils.getSheetSizeFromSizeConstraints(t.sizeConstraint);return this._sheetInfoImpl.sheetSize=r,r}))))}normalizeSheetSize(e){const{behavior:t}=e;return s.ErrorHelpers.verifyEnumValue(t,a.SheetSizeBehavior,"SheetSizeBehavior"),{behavior:t,minSize:d.parseDimensions(e.minSize),maxSize:d.parseDimensions(e.maxSize)}}processNewSize(e){var t,r,i,s;const{behavior:l,minSize:d,maxSize:c}=e,u=!o.Param.isNullOrUndefined(null===(t=d)||void 0===t?void 0:t.width),h=!o.Param.isNullOrUndefined(null===(r=d)||void 0===r?void 0:r.height),p=!o.Param.isNullOrUndefined(null===(i=c)||void 0===i?void 0:i.width),m=!o.Param.isNullOrUndefined(null===(s=c)||void 0===s?void 0:s.height),g=u&&h,y=p&&m;switch(l){case a.SheetSizeBehavior.Automatic:return{behavior:l};case a.SheetSizeBehavior.AtMost:{if(!c||!y)throw new n.TableauError(a.EmbeddingErrorCodes.MissingMaxSize,"Missing maxSize for SheetSizeBehavior.AtMost");const e={width:c.width,height:c.height};if(e.width<0||e.height<0)throw new n.TableauError(a.EmbeddingErrorCodes.InvalidSize,"Size value cannot be less than zero");return{behavior:l,maxSize:e}}case a.SheetSizeBehavior.AtLeast:{if(!d||!g)throw new n.TableauError(a.EmbeddingErrorCodes.MissingMinSize,"Missing minSize for SheetSizeBehavior.AtLeast");const e={width:d.width,height:d.height};if(e.width<0||e.height<0)throw new n.TableauError(a.EmbeddingErrorCodes.InvalidSize,"Size value cannot be less than zero");return{behavior:l,minSize:e}}case a.SheetSizeBehavior.Range:{if(!(d&&c&&g&&y))throw new n.TableauError(a.EmbeddingErrorCodes.MissingMinMaxSize,"Missing minSize or maxSize for SheetSizeBehavior.Range");const e={width:d.width,height:d.height},t={width:c.width,height:c.height};if(e.width<0||e.height<0||t.width<0||t.height<0||e.width>t.width||e.height>t.height)throw new n.TableauError(a.EmbeddingErrorCodes.InvalidSize,"Missing minSize or maxSize for SheetSizeBehavior.Range");return{behavior:l,minSize:e,maxSize:t}}case a.SheetSizeBehavior.Exactly:if(d&&c){if(g&&y){const e={width:d.width,height:d.height},t={width:c.width,height:c.height};if(e.width!==t.width||e.height!==t.height)throw new n.TableauError(a.EmbeddingErrorCodes.InvalidSize,"Conflicting size values for SheetSizeBehavior.Exactly");return{behavior:l,minSize:e,maxSize:t}}if(g){const e={width:d.width,height:d.height};return{behavior:l,minSize:e,maxSize:e}}if(y){const e={width:c.width,height:c.height};return{behavior:l,minSize:e,maxSize:e}}}throw new n.TableauError(a.EmbeddingErrorCodes.InvalidSize,"Invalid sheet size parameter");default:throw new n.TableauError(a.SharedErrorCodes.InternalError,`Unsupported sheet size behavior: ${l}`)}}}t.SheetImpl=d,d.parseDimensions=e=>{const t={width:void 0,height:void 0};if(!e)return t;const{success:r,parsed:a}=o.Param.tryParseNumber(e.width),{success:i,parsed:n}=o.Param.tryParseNumber(e.height);return r&&i?{width:a,height:n}:r?{width:a}:i?{height:n}:t}},8736:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419);t.SheetInfoImpl=class{constructor(e,t,r,a,i,n,s){this._name=e,this._sheetType=t,this._sheetSize=r,this._index=a,this._isActive=i,this._isHidden=n,this._url=s}get name(){return this._name}set name(e){this._name=e}get sheetSize(){return this._sheetSize}set sheetSize(e){this._sheetSize=e}get sheetType(){return this._sheetType}get sheetPath(){return{sheetName:this.name,isDashboard:this.sheetType===a.SheetType.Dashboard}}get index(){return this._index}get isActive(){return this._isActive}set active(e){this._isActive=e}get isHidden(){return this._isHidden}get url(){return this._url}}},5144:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SingleEventManagerImpl=class{constructor(e){this._eventType=e,this._handlers=[]}get eventType(){return this._eventType}addEventListener(e){return this._handlers.push(e),()=>this.removeEventListener(e)}removeEventListener(e){const t=this._handlers.length;return this._handlers=this._handlers.filter((t=>t!==e)),t>this._handlers.length}triggerEvent(e){for(const t of this._handlers)try{t(e())}catch(e){continue}}}},6804:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(3008),n=r(6664),s=r(7480),o=r(3036),l=r(8332),d=r(2608),c=r(6068);class u extends l.SheetImpl{constructor(e,t,r,a){super(e,a),this._sheetInfoImpl=e,this._publishedSheetInfos=r,this._registryId=a,this._storyPointInfoImpls=[],this._deferred=new o.ShortLivedDeferred,this.initializeStory(t)}initializeStory(e){e.storyPoints.forEach((t=>{const r=t.index===e.activeStoryPointIndex,a=new c.StoryPointInfoImpl(t.caption,t.index,t.storyPointId,r,t.updated,this);this._storyPointInfoImpls.push(a),r&&(this._activeStoryPointImpl=new d.StoryPointImpl(a,this._publishedSheetInfos,this._registryId,t.containedSheetInfo))}))}updateStoryInfo(e,t){if(!this._storyPointInfoImpls)return;let r=this._storyPointInfoImpls[e];if(r.storyPointId!==t.storyPointId)throw new n.TableauError(a.EmbeddingErrorCodes.StoryPointIdMismatch,`We should not be updating a story point when the IDs don't match. Existing storyPointID=${r.storyPointId}, newStoryPointID=${t.storyPointId}`);r.caption=t.caption,r.updated=t.updated,this._activeStoryPointImpl.storyPointId===t.storyPointId&&(this._activeStoryPointImpl.updated=r.updated)}updateStory(e){this._storyPointInfoImpls&&(this._storyPointInfoImpls.forEach((t=>{t.storyPointId===e.storyPointId?(t.caption=e.caption,t.index=e.index,t.active=!0,t.updated=e.updated,this._activeStoryPointImpl=new d.StoryPointImpl(t,this._publishedSheetInfos,this._registryId,e.containedSheetInfo)):t.active=!1})),this.activeStoryPoint&&this._deferred.resolve(this.activeStoryPoint))}get activeStoryPoint(){return this._activeStoryPointImpl}get storyPointsInfo(){return this._storyPointInfoImpls}get isActive(){return this._sheetInfoImpl.active}get isHidden(){return!!this._sheetInfoImpl.isHidden}activateNextStoryPointAsync(){if(this._activeStoryPointImpl.index===this._storyPointInfoImpls.length-1)return Promise.resolve(this._activeStoryPointImpl);let e=this._deferred.getNewPromiseOrThrowIfBusy();return i.ApiServiceRegistry.get(this._registryId).getService("story-activation-service").activateNextStoryPointAsync(),e}activatePreviousStoryPointAsync(){if(0===this._activeStoryPointImpl.index)return Promise.resolve(this._activeStoryPointImpl);let e=this._deferred.getNewPromiseOrThrowIfBusy();return i.ApiServiceRegistry.get(this._registryId).getService("story-activation-service").activatePreviousStoryPointAsync(),e}activateStoryPointAsync(e){if(s.ErrorHelpers.verifyParameter(e,"index"),s.ErrorHelpers.verifyParameterType(e,"number","index"),e<0||e>=this._storyPointInfoImpls.length)throw new n.TableauError(a.EmbeddingErrorCodes.IndexOutOfRange,"The index passed to this command is out of range.");if(e===this._activeStoryPointImpl.index)return Promise.resolve(this._activeStoryPointImpl);let t=this._deferred.getNewPromiseOrThrowIfBusy();return i.ApiServiceRegistry.get(this._registryId).getService("story-activation-service").activateStoryPointAsync(e),t}revertStoryPointAsync(e){if(s.ErrorHelpers.verifyParameter(e,"index"),s.ErrorHelpers.verifyParameterType(e,"number","index"),e<0||e>=this._storyPointInfoImpls.length)throw new n.TableauError(a.EmbeddingErrorCodes.IndexOutOfRange,"The index passed to this command is out of range.");return i.ApiServiceRegistry.get(this._registryId).getService("story-activation-service").revertStoryPointAsync(e).then((e=>(this.updateStoryInfo(e.index,e),new c.StoryPointInfoImpl(e.caption,e.index,e.storyPointId,!1,e.updated,this))))}clearPendingPromises(){this._deferred&&this._deferred.reject("All pending promises cleared")}}t.StoryImpl=u},2608:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(6664),n=r(2780),s=r(1940),o=r(8736),l=r(6500);t.StoryPointImpl=class{constructor(e,t,r,a){this._storyPointInfoImpl=e,a&&(this._containedSheetImpl=this.createContainedSheet(a,t,r))}get index(){return this._storyPointInfoImpl.index}get caption(){return this._storyPointInfoImpl.caption}get active(){return this._storyPointInfoImpl.active}get updated(){return this._storyPointInfoImpl.updated}set updated(e){this._storyPointInfoImpl.updated=e}get parentStory(){return this._storyPointInfoImpl.parentStory}get containedSheet(){return this._containedSheetImpl}get storyPointId(){return this._storyPointInfoImpl.storyPointId}createContainedSheet(e,t,r){const d=n.SheetUtils.getPublishedSheetInfoByName(e.name,t),c=n.SheetUtils.createAutomaticSize(),u=void 0===d,h=d?d.url:"",p=new o.SheetInfoImpl(e.name,n.SheetUtils.getSheetTypeEnum(e.sheetType),c,-1,!1,u,h);let m;switch(p.sheetType){case a.SheetType.Worksheet:{const e={worksheet:p.name};m=new l.WorksheetImpl(p,r,e,null,this);break}case a.SheetType.Dashboard:{const t={sheetName:p.name,isDashboard:!0};m=new s.DashboardImpl(p,e.dashboardZones,t,r,this);break}default:throw new i.TableauError(a.SharedErrorCodes.ServerError,"Invalid SheetType")}return m}}},6068:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StoryPointInfoImpl=class{constructor(e,t,r,a,i,n){this._caption=e,this._index=t,this._storyPointId=r,this._active=a,this._updated=i,this._parentStoryImpl=n}get caption(){return this._caption}set caption(e){this._caption=e}get index(){return this._index}set index(e){this._index=e}get storyPointId(){return this._storyPointId}get active(){return this._active}set active(e){this._active=e}get updated(){return this._updated}set updated(e){this._updated=e}get parentStory(){return this._parentStoryImpl}}},3044:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkbookImpl=class{}},6500:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(7419),n=r(8340),s=r(624),o=r(3483),l=r(3008),d=r(6664),c=r(7480),u=r(2180),h=r(8332);class p extends h.SheetImpl{constructor(e,t,r,a,i,n=null,s=null){super(e,t),this._visualId=r,this._parentDashboardImpl=a,this._parentStoryPointImpl=i,this._backgroundColor=n,this._formatting=s}get parentDashboard(){return this._parentDashboardImpl}get parentStoryPoint(){return this._parentStoryPointImpl}get visualId(){return this._visualId}getMaxPageRowLimit(){return 1e4}get backgroundColor(){return this._backgroundColor}get formatting(){return this._formatting}applyFilterAsync(e,t,r,i){return c.ErrorHelpers.verifyEnumValue(r,a.FilterUpdateType,"Contract.FilterUpdateType"),this.verifyActiveSheet(),l.ApiServiceRegistry.get(this._registryId).getService("filter-service").applyFilterAsync(this.visualId,e,t,r,i)}applyRangeFilterAsync(e,t){return c.ErrorHelpers.verifyParameter(e,"fieldName"),c.ErrorHelpers.verifyParameter(t,"filterOptions"),t.nullOption?c.ErrorHelpers.verifyEnumValue(t.nullOption,i.FilterNullOption,"FilterNullOption"):c.ErrorHelpers.verifyRangeParamType(t.min,t.max),this.verifyActiveSheet(),l.ApiServiceRegistry.get(this._registryId).getService("filter-service").applyRangeFilterAsync(this.visualId,e,t)}applyHierarchicalFilterAsync(e,t,r,n){if(c.ErrorHelpers.verifyParameter(e,"fieldName"),c.ErrorHelpers.verifyParameter(t,"values"),c.ErrorHelpers.verifyEnumValue(r,a.FilterUpdateType,"Contract.FilterUpdateType"),!Array.isArray(t)&&!t.levels)throw new d.TableauError(i.ErrorCodes.InvalidParameter,"values parameter for applyHierarchicalFilterAsync must be an array or contain a levels key");return this.verifyActiveSheet(),l.ApiServiceRegistry.get(this._registryId).getService("filter-service").applyHierarchicalFilterAsync(this.visualId,e,t,r,n)}clearFilterAsync(e){return c.ErrorHelpers.verifyParameter(e,"fieldName"),this.verifyActiveSheet(),l.ApiServiceRegistry.get(this._registryId).getService("filter-service").clearFilterAsync(this.visualId,e)}applyRelativeDateFilterAsync(e,t){return c.ErrorHelpers.verifyStringParameter(e,"fieldName"),c.ErrorHelpers.verifyParameter(t,"options"),c.ErrorHelpers.verifyEnumValue(t.periodType,i.PeriodType,"PeriodType"),c.ErrorHelpers.verifyEnumValue(t.rangeType,i.DateRangeType,"DateRangeType"),this.verifyActiveSheet(),l.ApiServiceRegistry.get(this._registryId).getService("filter-service").applyRelativeDateFilterAsync(this.visualId,e,t)}getDataSourcesAsync(){return this.verifyActiveSheet(),l.ApiServiceRegistry.get(this._registryId).getService("data-source-service").getDataSourcesAsync(this.visualId).then((e=>{const t=e,r=t.worksheetDataSchemaMap[this.name],a=[],i=r.primaryDataSource;a.push(this.createDataSourceFromInfo(t.dataSources[i]));for(const e of r.referencedDataSourceList)e!==i&&a.push(this.createDataSourceFromInfo(t.dataSources[e]));return a}))}getFiltersAsync(){return this.verifyActiveSheet(),l.ApiServiceRegistry.get(this._registryId).getService("filter-service").getFiltersAsync(this.visualId)}getSelectedMarksAsync(){return this.verifyActiveSheet(),l.ApiServiceRegistry.get(this._registryId).getService("get-data-service").getSelectedMarksAsync(this.visualId)}getHighlightedMarksAsync(){return this.verifyActiveSheet(),l.ApiServiceRegistry.get(this._registryId).getService("get-data-service").getHighlightedMarksAsync(this.visualId)}getSummaryDataAsync(e){var t;return this.verifyActiveSheet(),e=e||{},l.ApiServiceRegistry.get(this._registryId).getService("get-data-service").getUnderlyingDataAsync(this.visualId,o.GetDataType.Summary,!!e.ignoreAliases,!!e.ignoreSelection,!0,e.columnsToIncludeById||[],e.maxRows||0,e.includeDataValuesOption||i.IncludeDataValuesOption.AllValues,null!=(t=e.applyWorksheetFormatting)&&t)}getSummaryDataReaderAsync(e,t){var r;return this.verifyActiveSheet(),t=t||{},l.ApiServiceRegistry.get(this._registryId).getService("get-data-service").getSummaryDataReaderAsync(this.visualId,e||this.getMaxPageRowLimit(),!!t.ignoreAliases,!!t.ignoreSelection,!0,t.columnsToIncludeById||[],t.includeDataValuesOption||i.IncludeDataValuesOption.AllValues,null!=(r=t.applyWorksheetFormatting)&&r)}getVisualSpecificationAsync(){return this.verifyActiveSheet(),l.ApiServiceRegistry.get(this._registryId).getService("visual-model-service").getVisualSpecificationAsync(this.visualId)}addMarksCardFieldsAsync(e,t,r,a){return this.verifyActiveSheet(),l.ApiServiceRegistry.get(this._registryId).getService("visual-model-service").addMarksCardFieldsAsync(this.visualId,e,t,r,a)}moveMarksCardFieldAsync(e,t,r,a){return this.verifyActiveSheet(),l.ApiServiceRegistry.get(this._registryId).getService("visual-model-service").moveMarksCardFieldAsync(this.visualId,e,t,r,a)}spliceMarksCardFieldsAsync(e,t,r,a,i){return this.verifyActiveSheet(),l.ApiServiceRegistry.get(this._registryId).getService("visual-model-service").spliceMarksCardFieldsAsync(this.visualId,e,t,r,a,i)}getSummaryColumnsInfoAsync(){return this.verifyActiveSheet(),l.ApiServiceRegistry.get(this._registryId).getService("get-data-service").getSummaryColumnsInfoAsync(this.visualId)}getUnderlyingDataAsync(e){var t;return this.verifyActiveSheet(),e=e||{},l.ApiServiceRegistry.get(this._registryId).getService("get-data-service").getUnderlyingDataAsync(this.visualId,o.GetDataType.Underlying,!!e.ignoreAliases,!!e.ignoreSelection,!!e.includeAllColumns,e.columnsToIncludeById||[],e.maxRows||0,e.includeDataValuesOption||i.IncludeDataValuesOption.AllValues,null!=(t=e.applyWorksheetFormatting)&&t)}getUnderlyingTablesAsync(){return this.verifyActiveSheet(),l.ApiServiceRegistry.get(this._registryId).getService("data-source-service").getUnderlyingTablesAsync(this.visualId).then((e=>e.map((e=>new s.LogicalTable(e)))))}getUnderlyingTableDataAsync(e,t){var r;return this.verifyActiveSheet(),t=t||{},l.ApiServiceRegistry.get(this._registryId).getService("get-data-service").getUnderlyingTableDataAsync(this.visualId,e,!!t.ignoreAliases,!!t.ignoreSelection,!!t.includeAllColumns,t.columnsToIncludeById||[],t.maxRows||0,t.includeDataValuesOption||i.IncludeDataValuesOption.AllValues,null!=(r=t.applyWorksheetFormatting)&&r)}getUnderlyingTableDataReaderAsync(e,t,r){var a;return this.verifyActiveSheet(),r=r||{},l.ApiServiceRegistry.get(this._registryId).getService("get-data-service").getUnderlyingTableDataReaderAsync(this.visualId,e,t||this.getMaxPageRowLimit(),!!r.ignoreAliases,!!r.ignoreSelection,!!r.includeAllColumns,r.columnsToIncludeById||[],r.includeDataValuesOption||i.IncludeDataValuesOption.AllValues,null!=(a=r.applyWorksheetFormatting)&&a)}clearSelectedMarksAsync(){return this.verifyActiveSheet(),l.ApiServiceRegistry.get(this._registryId).getService("selection-service").clearSelectedMarksAsync(this.visualId)}selectMarksByValueAsync(e,t){return c.ErrorHelpers.verifyParameter(e,"fieldName"),c.ErrorHelpers.verifyEnumValue(t,i.SelectionUpdateType,"SelectionUpdateType"),this.verifyActiveSheet(),l.ApiServiceRegistry.get(this._registryId).getService("selection-service").selectMarksByValueAsync(this.visualId,e,t)}selectMarksByIdAsync(e,t){return c.ErrorHelpers.verifyParameter(e,"fieldName"),c.ErrorHelpers.verifyEnumValue(t,i.SelectionUpdateType,"SelectionUpdateType"),this.verifyActiveSheet(),l.ApiServiceRegistry.get(this._registryId).getService("selection-service").selectMarksByIdAsync(this.visualId,e,t)}annotateMarkAsync(e,t){return c.ErrorHelpers.verifyParameter(e,"mark"),this.verifyActiveSheet(),l.ApiServiceRegistry.get(this._registryId).getService("annotation-service").annotateMarkAsync(this.visualId,e,t)}getAnnotationsAsync(){return this.verifyActiveSheet(),l.ApiServiceRegistry.get(this._registryId).getService("annotation-service").getAnnotationsAsync(this.visualId)}removeAnnotationAsync(e){return c.ErrorHelpers.verifyParameter(e,"annotation"),this.verifyActiveSheet(),l.ApiServiceRegistry.get(this._registryId).getService("annotation-service").removeAnnotationAsync(this.visualId,e)}appendContextMenuAsync(e,t){return this.verifyActiveSheet(),l.ApiServiceRegistry.get(this._registryId).getService("external-context-menu-service").appendContextMenuAsync(this.visualId.worksheet,e,t)}removeContextMenuAsync(e,t){return this.verifyActiveSheet(),l.ApiServiceRegistry.get(this._registryId).getService("external-context-menu-service").removeContextMenuAsync(this.visualId.worksheet,e,t)}executeContextMenuAsync(e,t){return this.verifyActiveSheet(),l.ApiServiceRegistry.get(this._registryId).getService("external-context-menu-service").executeContextMenuAsync(this.visualId.worksheet,e,t)}renameContextMenuAsync(e,t,r){return this.verifyActiveSheet(),l.ApiServiceRegistry.get(this._registryId).getService("external-context-menu-service").renameContextMenuAsync(this.visualId.worksheet,e,t,r)}hoverTupleAsync(e,t,r){return this.isInsideDashboardExtension()?Promise.reject(new d.TableauError(a.SharedErrorCodes.ImplementationError,"hoverTupleAsync is not supported in dashboard extensions")):l.ApiServiceRegistry.get(this._registryId).getService("selection-service").hoverTupleAsync(this.visualId,e,t,r)}selectTuplesAsync(e,t,r){return this.isInsideDashboardExtension()?Promise.reject(new d.TableauError(a.SharedErrorCodes.ImplementationError,"selectTuplesAsync is not supported in dashboard extensions")):l.ApiServiceRegistry.get(this._registryId).getService("selection-service").selectTuplesAsync(this.visualId,e,t,r)}getTooltipTextAsync(e){return this.isInsideDashboardExtension()?Promise.reject(new d.TableauError(a.SharedErrorCodes.ImplementationError,"getTooltipTextAsync is not supported in dashboard extensions")):l.ApiServiceRegistry.get(this._registryId).getService("accessibility").getTooltipTextAsync(this.visualId,e)}leaveMarkNavigationAsync(){return this.isInsideDashboardExtension()?Promise.reject(new d.TableauError(a.SharedErrorCodes.ImplementationError,"leaveMarkNavigationAsync is not supported in dashboard extensions")):l.ApiServiceRegistry.get(this._registryId).getService("accessibility").leaveMarkNavigationAsync(this.visualId)}editAliasesDialogAsync(e){return l.ApiServiceRegistry.get(this._registryId).getService("visual-model-service").editAliasesDialogAsync(e)}createDataSourceFromInfo(e){const t=new u.DataSourceImpl(e,this._registryId),r=new n.DataSource(t);return t.initializeWithPublicInterfaces(r),r}verifyActiveSheet(){const e=this.active,t=this.isInsideActiveDashboard(),r=this.isInsideActiveStoryPoint();if(!e&&!t&&!r)throw new d.TableauError(i.SharedErrorCodes.NotActiveSheet,"Operation not allowed on non-active sheet")}isInsideActiveStoryPoint(){return this._parentStoryPointImpl&&this._parentStoryPointImpl.active}isInsideActiveDashboard(){return this._parentDashboardImpl&&this._parentDashboardImpl.active}isInsideDashboardExtension(){return null!==this._parentDashboardImpl}}t.WorksheetImpl=p},624:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogicalTable=class{constructor(e){this._logicalTable=e}get id(){return this._logicalTable.id}get caption(){return this._logicalTable.caption}}},5064:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TooltipTextRequestModel=class{constructor(e,t){this.visualIdPresModel=e,this.tupleId=t}}},6296:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(3008),n=r(7480);class s{constructor(e,t,r,a,i){this._worksheetName=e,this._fieldName=t,this._filterType=r,this._fieldId=a,this._registryId=i}get worksheetName(){return this._worksheetName}get fieldName(){return this._fieldName}get fieldId(){return this._fieldId}get filterType(){return this._filterType}getFieldAsync(){return i.ApiServiceRegistry.get(this._registryId).getService("data-source-service").getFieldAsync(this._fieldId)}getAppliedWorksheetsAsync(){return i.ApiServiceRegistry.get(this._registryId).getService("filter-service").getAppliedWorksheetsAsync(this._worksheetName,this._fieldId)}setAppliedWorksheetsAsync(e){n.ErrorHelpers.verifyParameter(e,"applyToWorksheets");const t=new Set(e);return i.ApiServiceRegistry.get(this._registryId).getService("filter-service").setAppliedWorksheetsAsync(this._worksheetName,this._fieldName,this._fieldId,Array.from(t))}}t.Filter=s,t.CategoricalFilter=class extends s{constructor(e,t,r,a,i,n,s,o){super(e,t,a,r,i),this._appliedValues=n,this._isExcludeMode=s,this._isAllSelected=o}get isAllSelected(){return this._isAllSelected}get appliedValues(){return this._appliedValues}get isExcludeMode(){return this._isExcludeMode}getDomainAsync(e){return e||(e=a.FilterDomainType.Relevant),n.ErrorHelpers.verifyEnumValue(e,a.FilterDomainType,"FilterDomainType"),i.ApiServiceRegistry.get(this._registryId).getService("filter-service").getCategoricalDomainAsync(this._worksheetName,this._fieldId,e)}},t.HierarchicalDataValue=class{constructor(e,t,r){this._value=e,this._hierarchicalPath=t,this._level=r}get value(){return this._value}get hierarchicalPath(){return this._hierarchicalPath}get level(){return this._level}},t.HierarchicalLevelDetail=class{constructor(e,t){this._name=e,this._levelSelectionState=t}get name(){return this._name}get levelSelectionState(){return this._levelSelectionState}},t.HierarchicalFilter=class extends s{constructor(e,t,r,a,i,n,s,o,l,d,c){super(e,t,a,r,i),this._dimensionName=n,this._hierarchyCaption=s,this._numberOfLevels=o,this._levelDetails=l,this._appliedValues=d,this._isAllSelected=c}getDomainAsync(e){throw new Error("Method not implemented.")}get dimensionName(){return this._dimensionName}get hierarchyCaption(){return this._hierarchyCaption}get numberOfLevels(){return this._numberOfLevels}get levelDetails(){return this._levelDetails}get isAllSelected(){return this._isAllSelected}get appliedValues(){return this._appliedValues}},t.RangeFilter=class extends s{constructor(e,t,r,a,i,n,s,o){super(e,t,a,r,i),this._min=n,this._max=s,this._includeNullValues=o}get minValue(){return this._min}get maxValue(){return this._max}get includeNullValues(){return this._includeNullValues}getDomainAsync(e){const t=i.ApiServiceRegistry.get(this._registryId).getService("filter-service");return e||(e=a.FilterDomainType.Relevant),n.ErrorHelpers.verifyEnumValue(e,a.FilterDomainType,"FilterDomainType"),t.getRangeDomainAsync(this._worksheetName,this._fieldId,e)}},t.RelativeDateFilter=class extends s{constructor(e,t,r,a,i,n,s,o,l){super(e,t,a,r,i),this._anchorDate=n,this._periodType=s,this._rangeType=o,this._rangeN=l}get anchorDate(){return this._anchorDate}get periodType(){return this._periodType}get rangeType(){return this._rangeType}get rangeN(){return this._rangeN}},t.CategoricalDomain=class{constructor(e,t){this._values=e,this._domainType=t}get values(){return this._values}get type(){return this._domainType}},t.RangeDomain=class{constructor(e,t,r){this._min=e,this._max=t,this._domainType=r}get type(){return this._domainType}get min(){return this._min}get max(){return this._max}}},5068:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataTable=class{constructor(e,t,r,a,i,n){this._data=e,this._columns=t,this._totalRowCount=r,this._isTotalRowCountLimited=a,this._isSummaryData=i,this._marksInfo=n,this._name=i?"Summary Data Table":"Underlying Data Table"}get name(){return this._name}get data(){return this._data}get columns(){return this._columns}get marksInfo(){return this._marksInfo}get totalRowCount(){return this._totalRowCount}get isTotalRowCountLimited(){return this._isTotalRowCountLimited}get isSummaryData(){return this._isSummaryData}},t.MarkInfo=class{constructor(e,t,r){this._type=e,this._color=t,this._tupleId=r}get type(){return this._type}get color(){return this._color}get tupleId(){return this._tupleId}},t.Column=class{constructor(e,t,r,a,i){this._fieldName=e,this._fieldId=t,this._dataType=r,this._isReferenced=a,this._index=i}get fieldName(){return this._fieldName}get fieldId(){return this._fieldId}get dataType(){return this._dataType}get isReferenced(){return this._isReferenced}get index(){return this._index}},t.DataValue=class{constructor(e,t,r,a,i){this._value=e,this._nativeValue=t,this._formattedValue=r,this._aliasValue=a,this._hasAlias=i}get value(){return this._value}get nativeValue(){return this._nativeValue}get formattedValue(){return this._formattedValue}get aliasValue(){return this._aliasValue}get hasAlias(){return this._hasAlias}}},7968:function(e,t,r){"use strict";var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(i,n){function s(e){try{l(a.next(e))}catch(e){n(e)}}function o(e){try{l(a.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((a=a.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=r(3008),n=r(7480);t.DataTableReader=class{constructor(e,t,r,a){this._id=e,this._totalRowCount=t,this._pageRowCount=r,this._registryId=a,this._pageCount=Math.ceil(t/r)}get totalRowCount(){return this._totalRowCount}get pageCount(){return this._pageCount}getPageAsync(e){return n.ErrorHelpers.verifyRange(e,0,this._pageCount),i.ApiServiceRegistry.get(this._registryId).getService("get-data-service").getPageAsync(this._id,e,this._pageRowCount)}getAllPagesAsync(e){return a(this,void 0,void 0,(function*(){const t=yield this.getPageAsync(0);e=e||this.totalRowCount;const r=Math.min(e,this.totalRowCount),a=Math.ceil(r/this._pageRowCount),i=Math.min(a,400),n=i<a;let s=[];for(let e=1;e<i;e++){const t=yield this.getPageAsync(e);s.push(t.data)}let o=t.data.concat(...s);return o.length=r,{name:t.name,data:o,columns:t.columns,totalRowCount:n?i*this._pageRowCount:r,isTotalRowCountLimited:n,isSummaryData:t.isSummaryData}}))}releaseAsync(){return i.ApiServiceRegistry.get(this._registryId).getService("get-data-service").releaseAsync(this._id)}}},7104:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{}t.SelectionModel=r;class a extends r{constructor(){super(...arguments),this.selectValues=[]}}t.ValueSelectionModel=a,t.HierarchicalSelectionModel=class extends a{},t.RangeSelectionModel=class extends r{},t.DimensionSelectionModel=class extends a{},t.TupleSelectionModel=class{constructor(){this.objectIds=[]}},t.SelectionModelsContainer=class{constructor(){this.hierModelArr=[],this.dimModelArr=[],this.quantModelArr=[]}},t.SelectTuplesInteractionModel=class{constructor(e,t=[],r,a){this.visualIdPresModel=e,this.tupleIds=t,this.selectOptions=r,this.tooltipContext=a}},t.HoverTupleInteractionModel=class{constructor(e,t,r,a){this.visualIdPresModel=e,this.tupleId=t,this.tooltipContext=r,this.allowHoverActions=a}}},6368:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Point=class{constructor(e,t){this._x=e,this._y=t}get x(){return this._x}get y(){return this._y}}},3483:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),(r=t.GetDataType||(t.GetDataType={})).Summary="summary",r.Underlying="underlying"},8672:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(3008),i=r(3964),n=r(8028),s=r(1384),o=r(9196),l=r(4924),d=r(3851),c=r(8864),u=r(7712),h=r(1288),p=r(7260),m=r(8784),g=r(4109),y=r(6096),I=r(744),v=r(8856);t.registerAllSharedServices=function(e,t){a.ApiServiceRegistry.get(t).registerService(new n.AnimationServiceImpl(e,t)),a.ApiServiceRegistry.get(t).registerService(new o.DataSourceServiceImpl(e,t)),a.ApiServiceRegistry.get(t).registerService(new l.ExportServiceImpl(e,t)),a.ApiServiceRegistry.get(t).registerService(new u.GetDataServiceImpl(e,t)),a.ApiServiceRegistry.get(t).registerService(new c.FilterServiceImpl(e,t)),a.ApiServiceRegistry.get(t).registerService(new h.NotificationServiceImpl(e)),a.ApiServiceRegistry.get(t).registerService(new p.ParametersServiceImpl(e,t)),a.ApiServiceRegistry.get(t).registerService(new m.SelectionServiceImpl(e,t)),a.ApiServiceRegistry.get(t).registerService(new s.AnnotationServiceImpl(e,t)),a.ApiServiceRegistry.get(t).registerService(new v.ZoneServiceImpl(e,t)),a.ApiServiceRegistry.get(t).registerService(new g.SizeServiceImpl(e,t)),a.ApiServiceRegistry.get(t).registerService(new y.VisualModelServiceImpl(e,t)),a.ApiServiceRegistry.get(t).registerService(new I.VizServiceImpl(e,t)),a.ApiServiceRegistry.get(t).registerService(new d.ExternalContextMenuServiceImpl(e,t)),a.ApiServiceRegistry.get(t).registerService(new i.AccessibilityServiceImpl(e,t))}},3008:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(6664);"undefined"!=typeof window&&(window.__tableauApiServiceRegistry=window.__tableauApiServiceRegistry||{});class n{constructor(){this._services={}}registerService(e){this._services[e.serviceName]=e}getService(e){if(!this._services.hasOwnProperty(e))throw new i.TableauError(a.ErrorCodes.InternalError,`Service not registered: ${e}`);return this._services[e]}}class s{static get(e){if(window.__tableauApiServiceRegistry&&window.__tableauApiServiceRegistry[e]||s.setInstance(e,new n),!window.__tableauApiServiceRegistry[e])throw new i.TableauError(a.ErrorCodes.InternalError,"Service registry failed");return window.__tableauApiServiceRegistry[e]}static setInstance(e,t){window.__tableauApiServiceRegistry||(window.__tableauApiServiceRegistry={}),window.__tableauApiServiceRegistry[e]=t}static clearRegistry(){window.__tableauApiServiceRegistry={}}constructor(){}}t.ApiServiceRegistry=s},3964:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(3448),i=r(5064),n=r(1776);class s extends n.ServiceImplBase{get serviceName(){return"accessibility"}getTooltipTextAsync(e,t){let r=new i.TooltipTextRequestModel(e,t);const n={[a.ParameterId.FunctionName]:"getTooltipTextAsync",[a.ParameterId.TooltipTextRequest]:r};return this.execute(a.VerbId.GetTooltipText,n).then((e=>e.result))}leaveMarkNavigationAsync(e){const t={[a.ParameterId.FunctionName]:"leaveMarkNavigationAsync",[a.ParameterId.VisualId]:e};return this.execute(a.VerbId.RaiseLeaveMarkNavNotification,t).then((e=>{}))}}t.AccessibilityServiceImpl=s},8028:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(3448),n=r(1044),s=r(7480),o=r(1776);class l extends o.ServiceImplBase{get serviceName(){return"animation-service"}replayAsync(e){const t={[i.ParameterId.ReplaySpeed]:1};return s.ErrorHelpers.verifyEnumValue(e,a.ReplaySpeedType,"ReplaySpeedType"),t[i.ParameterId.ReplaySpeed]=n.ExternalToInternalEnumMappings.setReplaySpeedType.convert(e),this.execute(i.VerbId.ReplayAnimation,t).then((e=>{}))}}t.AnimationServiceImpl=l},1384:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(3448),n=r(6557),s=r(7104),o=r(6664),l=r(1776);class d extends l.ServiceImplBase{get serviceName(){return"annotation-service"}annotateMarkAsync(e,t,r){const a=this.parseMarkSelectionIds([t]),n=`<formatted-text><run>${r}</run></formatted-text>`,s={[i.ParameterId.FunctionName]:"annotateMarkAsync",[i.ParameterId.VisualId]:e,[i.ParameterId.AnnotateEnum]:i.AnnotateEnum.Mark,[i.ParameterId.TargetPoint]:{x:0,y:0},[i.ParameterId.SelectionList]:[a.selection],[i.ParameterId.FormattedText]:n};return this.execute(i.VerbId.CreateAnnotation,s).then((e=>{}))}getAnnotationsAsync(e){const t={[i.ParameterId.FunctionName]:"getAnnotationsAsync",[i.ParameterId.VisualId]:e};return this.execute(i.VerbId.GetAnnotations,t).then((e=>{const t=e.result;return this.annotationFilterMap(t)}))}removeAnnotationAsync(e,t){const r=this.parseAnnotationSelectionIds([t]),a={[i.ParameterId.FunctionName]:"removeAnnotationAsync",[i.ParameterId.VisualId]:e,[i.ParameterId.SelectionList]:[r.selection]};return this.execute(i.VerbId.RemoveAnnotation,a).then((e=>{}))}parseMarkSelectionIds(e){const t=[],r=new s.SelectionModelsContainer;if(e.forEach((e=>{const r=e.tupleId;if(!(null!=r&&r>0))throw new o.TableauError(a.ErrorCodes.InternalError,"invalid tupleId");t.push(r.toString())})),0!==t.length){const e=new s.TupleSelectionModel;e.selectionType="tuples",e.objectIds=t,r.selection=e}return r}parseAnnotationSelectionIds(e){const t=[],r=new s.SelectionModelsContainer;if(e.forEach((e=>{const r=e.annotationId;if(!(null!=r&&r>=0))throw new o.TableauError(a.ErrorCodes.InternalError,"invalid annotationId");t.push(r.toString())})),0!==t.length){const e=new s.TupleSelectionModel;e.selectionType="annotations",e.objectIds=t,r.selection=e}return r}mapAnnotation(e){return{annotationHTML:e.annotationText,annotationId:e.annotationId,annotationText:e.annotationPlainText,annotationType:n.InternalToExternalEnumMappings.annotationType.convert(e.annotateEnum),tupleId:e.tupleId}}annotationFilterMap(e){return e.map((e=>this.mapAnnotation(e)))}}t.AnnotationServiceImpl=d},1832:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(3448),i=r(1776);class n extends i.ServiceImplBase{get serviceName(){return"client-info-service"}getClientInfoAsync(){const e=a.VerbId.GetEmbeddingClientInfo,t={[a.ParameterId.FunctionName]:"getClientInfoAsync"};return this.execute(e,t).then((e=>e.result))}}t.ClientInfoServiceImpl=n},9196:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(3448),n=r(8340),s=r(1072),o=r(2180),l=r(5288),d=r(6664),c=r(1776);class u extends c.ServiceImplBase{constructor(e,t){super(e,t)}get serviceName(){return"data-source-service"}refreshAsync(e){const t={[i.ParameterId.FunctionName]:"refreshAsync",[i.ParameterId.DeltaTimeMs]:0,[i.ParameterId.ShouldRefreshDS]:!0};return e&&(t[i.ParameterId.DataSourceId]=e),this.execute(i.VerbId.RefreshDataSource,t).then((e=>{}))}getActiveTablesAsync(e){const t={[i.ParameterId.FunctionName]:"getActiveTablesAsync",[i.ParameterId.DataSourceId]:e};return this.execute(i.VerbId.GetActiveTables,t).then((t=>{const r=t.result;if(0===r.tables.length)throw new d.TableauError(a.ErrorCodes.UnsupportedMethodForDataSourceType,`getActiveTables is not supported for: ${e}`);return r.tables}))}getDataSourcesAsync(e){const t={[i.ParameterId.FunctionName]:"getDataSourcesAsync",[i.ParameterId.VisualId]:e};return this.execute(i.VerbId.GetDataSources,t).then((e=>e.result))}getAllDataSourcesAsync(){const e={[i.ParameterId.FunctionName]:"getAllDataSourcesAsync"};return this.execute(i.VerbId.GetAllDataSources,e).then((e=>e.result))}getConnectionSummariesAsync(e){const t={[i.ParameterId.FunctionName]:"getConnectionSummariesAsync",[i.ParameterId.DataSourceId]:e};return this.execute(i.VerbId.GetConnectionDescriptionSummaries,t).then((e=>e.result))}getFieldAsync(e){const t=i.VerbId.GetFieldAndDataSource,r={[i.ParameterId.FunctionName]:"getFieldAsync",[i.ParameterId.FieldId]:e};return this.execute(t,r).then((e=>{const t=e.result[i.ParameterId.DataSource],r=e.result[i.ParameterId.Field];return this.convertField(r,this.convertDataSource(t))}))}getLogicalTablesAsync(e){const t={[i.ParameterId.FunctionName]:"getLogicalTablesAsync",[i.ParameterId.DataSourceId]:e};return this.execute(i.VerbId.GetLogicalTables,t).then((e=>e.result))}getUnderlyingTablesAsync(e){const t={[i.ParameterId.FunctionName]:"getUnderlyingTablesAsync",[i.ParameterId.VisualId]:e};return this.execute(i.VerbId.GetUnderlyingTables,t).then((e=>e.result))}convertField(e,t){return new s.Field(new l.FieldImpl(e,t))}convertDataSource(e){return new n.DataSource(new o.DataSourceImpl(e,this._registryId))}}t.DataSourceServiceImpl=u},4924:function(e,t,r){"use strict";var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(i,n){function s(e){try{l(a.next(e))}catch(e){n(e)}}function o(e){try{l(a.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((a=a.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=r(3448),n=r(7419),s=r(1044),o=r(5044),l=r(7480),d=r(6664),c=r(1776);class u extends c.ServiceImplBase{get serviceName(){return"export-service"}getExportCrosstabSheetMapAsync(e){const t=i.VerbId.GetExportCrosstabSheetMap,r={[i.ParameterId.FunctionName]:"getExportCrosstabSheetMapAsync",[i.ParameterId.CurrentSheetType]:s.ExternalToInternalEnumMappings.sheetType.convert(e)};return this.execute(t,r).then((e=>e.result))}exportCrosstabAsync(e,t,r,s){return a(this,void 0,void 0,(function*(){l.ErrorHelpers.verifySheetName(r,e),l.ErrorHelpers.verifyEnumValue(t,n.CrosstabFileFormat,"CrosstabFileFormat");const a=yield this.getExportCrosstabSheetMapAsync(s);if(!a[e])throw new d.TableauError(n.SharedErrorCodes.InternalError,"missing sheet doc id from sheetMap");const o={[i.ParameterId.FunctionName]:"exportCrosstabAsync",[i.ParameterId.SheetIdentifier]:a[e],[i.ParameterId.SendNotifications]:!0};let c;switch(t){case n.CrosstabFileFormat.CSV:c=i.VerbId.ExportCrosstabCsvDownload,o[i.ParameterId.UseTabDelimiters]=!0;break;case n.CrosstabFileFormat.Excel:c=i.VerbId.ExportCrosstabExcelDownload;break;default:throw new d.TableauError(n.SharedErrorCodes.InternalError,"unsupported Crosstab file format.")}return this.execute(c,o).then((e=>e.result)).catch((()=>{throw new d.TableauError(n.SharedErrorCodes.CrosstabCreationError,"An unexpected error occurred while generating the document.")}))}))}exportDataAsync(e,t){var r;l.ErrorHelpers.verifyExportDataOptions(t);const a=new Set(t.columnsToIncludeById),s=Array.from(a),o=i.VerbId.ExportDataDownload,c={[i.ParameterId.FunctionName]:"exportDataAsync",[i.ParameterId.VisualId]:e,[i.ParameterId.IgnoreAliases]:(r=t.ignoreAliases,null!=r&&r),[i.ParameterId.ColumnsToIncludeById]:s};return this.execute(o,c).then((()=>{})).catch((()=>{throw new d.TableauError(n.SharedErrorCodes.DataCreationError,"An unexpected error occurred while generating the document.")}))}exportPowerPointAsync(e,t){l.ErrorHelpers.verifySheetNamesForPDFAndPPT(e,t);const r=i.VerbId.ExportPowerpointDownload,a={[i.ParameterId.FunctionName]:"exportPowerPointAsync",[i.ParameterId.ExportOriginUrl]:"",[i.ParameterId.SelectedSheetNames]:e};return this.execute(r,a).then((e=>e.result)).catch((()=>{throw new d.TableauError(n.SharedErrorCodes.PowerPointCreationError,"An error occured while attempting to generate the PowerPoint file.")}))}exportPDFAsync(e,t,r){return a(this,void 0,void 0,(function*(){l.ErrorHelpers.verifyExportPDFOptions(t),l.ErrorHelpers.verifySheetNamesForPDFAndPPT(e,r);const a=yield this.getExportPDFOptionsAsync();o.ExportHelpers.updateInternalExportPDFOptions(a,t,e);const s=i.VerbId.ExportPdfDownload,c={[i.ParameterId.FunctionName]:"exportPDFAsync",[i.ParameterId.ExportPdfOptions]:a};return this.execute(s,c).then((e=>e.result)).catch((()=>{throw new d.TableauError(n.SharedErrorCodes.PDFCreationError,"Unable to create PDF because something went wrong. Try again.")}))}))}getExportPDFOptionsAsync(){const e=i.VerbId.GetExportPdfOptions,t={[i.ParameterId.FunctionName]:"getExportPdfOptionsAsync"};return this.execute(e,t).then((e=>e.result))}}t.ExportServiceImpl=u},3851:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(3448),i=r(1776);class n extends i.ServiceImplBase{get serviceName(){return"external-context-menu-service"}appendContextMenuAsync(e,t,r){const i=a.VerbId.AppendExternalMenuItem,n={[a.ParameterId.FunctionName]:"appendContextMenuAsync",[a.ParameterId.WorksheetName]:e,[a.ParameterId.ExternalMenuItemDisplayName]:r.displayName};return this.execute(i,n).then((e=>e.result))}removeContextMenuAsync(e,t,r){const i=a.VerbId.RemoveExternalMenuItem,n={[a.ParameterId.FunctionName]:"removeContextMenuAsync",[a.ParameterId.WorksheetName]:e,[a.ParameterId.ExternalMenuItemId]:r};return this.execute(i,n).then((e=>{}))}executeContextMenuAsync(e,t,r){const i=a.VerbId.ExecuteExternalMenuItem,n={[a.ParameterId.FunctionName]:"executeContextMenuAsync",[a.ParameterId.WorksheetName]:e,[a.ParameterId.ExternalMenuItemId]:r};return this.execute(i,n).then((e=>{}))}renameContextMenuAsync(e,t,r,i){const n=a.VerbId.RenameExternalMenu,s={[a.ParameterId.FunctionName]:"renameContextMenuAsync",[a.ParameterId.WorksheetName]:e,[a.ParameterId.ExternalMenuHeader]:r,[a.ParameterId.ExternalMenuDescription]:i};return this.execute(n,s).then((e=>{}))}}t.ExternalContextMenuServiceImpl=n},8864:function(e,t,r){"use strict";var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(i,n){function s(e){try{l(a.next(e))}catch(e){n(e)}}function o(e){try{l(a.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((a=a.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=r(7419),n=r(3448),s=r(3448),o=r(5136),l=r(1044),d=r(6557),c=r(6296),u=r(8052),h=r(1172),p=r(1776);class m extends p.ServiceImplBase{get serviceName(){return"filter-service"}applyFilterAsync(e,t,r,a,n){const d=s.VerbId.ApplyCategoricalFilter,c={[s.ParameterId.FunctionName]:"applyFilterAsync"};if(c[s.ParameterId.VisualId]=e,c[s.ParameterId.FieldName]=t,!Array.isArray(r))throw new o.TableauError(i.ErrorCodes.InvalidParameter,"values parameter for applyFilterAsync must be an array");return c[s.ParameterId.FilterValues]=r,c[s.ParameterId.FilterUpdateType]=l.ExternalToInternalEnumMappings.filterUpdateType.convert(a),c[s.ParameterId.IsExcludeMode]=void 0!==n&&void 0!==n.isExcludeMode&&n.isExcludeMode,this.execute(d,c).then((e=>t))}applyRangeFilterAsync(e,t,r){const a=s.VerbId.ApplyRangeFilter,i={[s.ParameterId.FunctionName]:"applyRangeFilterAsync"};if(void 0!==r.min&&null!==r.min){let e;e=r.min instanceof Date?h.Param.serializeDateForPlatform(r.min):r.min,i[s.ParameterId.FilterRangeMin]=e}if(void 0!==r.max&&null!==r.max){let e;e=r.max instanceof Date?h.Param.serializeDateForPlatform(r.max):r.max,i[s.ParameterId.FilterRangeMax]=e}return r.nullOption&&(i[s.ParameterId.FilterRangeNullOption]=l.ExternalToInternalEnumMappings.nullOptions.convert(r.nullOption)),i[s.ParameterId.FieldName]=t,i[s.ParameterId.VisualId]=e,this.execute(a,i).then((e=>(this.apiFilterHandlerCheckForCommandError(e.result),t)))}applyHierarchicalFilterAsync(e,t,r,a,i){const n=s.VerbId.HierarchicalFilter,o={[s.ParameterId.FunctionName]:"applyHierarchicalFilterAsync"};o[s.ParameterId.VisualId]=e,o[s.ParameterId.FieldName]=t;const d=r.levels;return Array.isArray(d)&&d.length>0?o[s.ParameterId.FilterLevels]=d:r.length>0?o[s.ParameterId.FilterValues]=r:o[s.ParameterId.FilterLevels]=[],o[s.ParameterId.FilterUpdateType]=l.ExternalToInternalEnumMappings.filterUpdateType.convert(a),o[s.ParameterId.IsExcludeMode]=i&&!!i.isExcludeMode,this.execute(n,o).then((e=>t))}clearFilterAsync(e,t){const r=s.VerbId.ClearFilter,a={[s.ParameterId.FunctionName]:"clearFilterAsync"};return a[s.ParameterId.VisualId]=e,a[s.ParameterId.FieldName]=t,this.execute(r,a).then((e=>t))}applyRelativeDateFilterAsync(e,t,r){const a=s.VerbId.ApplyRelativeDateFilter,n={[s.ParameterId.FunctionName]:"applyRelativeDateFilterAsync"};if(n[s.ParameterId.VisualId]=e,n[s.ParameterId.FieldName]=t,n[s.ParameterId.PeriodType]=l.ExternalToInternalEnumMappings.periodType.convert(r.periodType),n[s.ParameterId.DateRangeType]=l.ExternalToInternalEnumMappings.dateRangeType.convert(r.rangeType),r.rangeType===i.DateRangeType.LastN||r.rangeType===i.DateRangeType.NextN){if(void 0===r.rangeN||null===r.rangeN)throw new o.TableauError(i.EmbeddingErrorCodes.MissingRangeNForRelativeDateFilters,"Missing rangeN field for a relative date filter of LASTN or NEXTN.");n[s.ParameterId.RangeN]=r.rangeN}return void 0!==r.anchorDate&&null!==r.anchorDate&&(n[s.ParameterId.AnchorDate]=this.convertAnchorDate(r.anchorDate)),this.execute(a,n).then((e=>e.result))}getFiltersAsync(e){const t=s.VerbId.GetFilters,r={[s.ParameterId.FunctionName]:"getFiltersAsync"};return r[s.ParameterId.VisualId]=e,this.execute(t,r).then((e=>{const t=e.result;return this.convertDomainFilters(t)}))}getCategoricalDomainAsync(e,t,r){const a=s.VerbId.GetCategoricalDomain,i={[s.ParameterId.FunctionName]:"getCategoricalDomainAsync"};return i[s.ParameterId.VisualId]={worksheet:e},i[s.ParameterId.FieldId]=t,i[s.ParameterId.DomainType]=l.ExternalToInternalEnumMappings.filterDomainType.convert(r),this.execute(a,i).then((e=>{const t=e.result;return this.convertCategoricalDomain(t,r)}))}getRangeDomainAsync(e,t,r){const a=s.VerbId.GetRangeDomain,i={[s.ParameterId.FunctionName]:"getRangeDomainAsync"};return i[s.ParameterId.VisualId]={worksheet:e},i[s.ParameterId.FieldId]=t,i[s.ParameterId.DomainType]=l.ExternalToInternalEnumMappings.filterDomainType.convert(r),this.execute(a,i).then((e=>{const t=e.result;return this.convertRangeDomain(t,r)}))}getDashboardFiltersAsync(){const e=s.VerbId.GetDashboardFilters,t={[s.ParameterId.FunctionName]:"getDashboardFiltersAsync"};return this.execute(e,t).then((e=>{const t=e.result;return this.convertDomainFilters(t)}))}applyDashboardFilterAsync(e,t,r,a){const i=s.VerbId.DashboardCategoricalFilter,n={[s.ParameterId.FunctionName]:"applyDashboardFilterAsync"};return n[s.ParameterId.FieldName]=e,n[s.ParameterId.FilterValues]=t,n[s.ParameterId.FilterUpdateType]=l.ExternalToInternalEnumMappings.filterUpdateType.convert(r),n[s.ParameterId.IsExcludeMode]=a&&!!a.isExcludeMode,this.execute(i,n).then((e=>e.result))}getAppliedWorksheetsAsync(e,t){var r;return a(this,void 0,void 0,(function*(){const a=yield this.executeGetAppliedWorksheets(e,t,"getAppliedWorksheetsAsync"),i=[];return null===(r=a.worksheets)||void 0===r||r.map((e=>{e.isSelected&&i.push(e.worksheetName)})),i}))}setAppliedWorksheetsAsync(e,t,r,n){return a(this,void 0,void 0,(function*(){const a=yield this.executeGetAppliedWorksheets(e,r,"getAppliedWorksheetsAsyncInternal");if(!a||!a.worksheets)throw new o.TableauError(i.SharedErrorCodes.InternalError,"This filter does not apply to multiple worksheets");const l=[];let d="";if(a.worksheets.forEach((e=>{e.isActive&&(d=e.worksheetName),(e.isSelected||e.isEnabled)&&l.push(e.worksheetName)})),""===d)throw new o.TableauError(i.SharedErrorCodes.InternalError,"No active worksheet");if(!n.includes(d))throw new o.TableauError(i.SharedErrorCodes.InternalError,`${d} must be included in the applied worksheets`);n.forEach((e=>{if(!l.includes(e))throw new o.TableauError(i.SharedErrorCodes.InternalError,`The field ${t} isn't applicable to the worksheet ${e}`)}));const c=s.VerbId.ChangeSharedFilter,u={};return u[s.ParameterId.FunctionName]="setAppliedWorksheetsAsync",u[s.ParameterId.VisualId]={worksheet:e},u[s.ParameterId.FieldId]=r,u[s.ParameterId.SharedFilterSheets]=n,this.execute(c,u).then((e=>n))}))}executeGetAppliedWorksheets(e,t,r){const a=s.VerbId.GetSharedFilter,i={};return i[s.ParameterId.FunctionName]=r,i[s.ParameterId.VisualId]={worksheet:e},i[s.ParameterId.FieldId]=t,this.execute(a,i).then((e=>e.result))}convertDomainFilters(e){const t=[];return e.forEach((e=>{switch(e.filterType){case s.FilterType.Categorical:{const r=e;if(!r)throw new Error("Invalid Categorical Filter");t.push(this.convertCategoricalFilter(r));break}case s.FilterType.Hierarchical:{const r=e;if(!r)throw new Error("Invalid Hierarchical Filter");t.push(this.convertHierarchicalFilter(r));break}case s.FilterType.Range:{const r=e;if(!r)throw new Error("Invalid Range Filter");t.push(this.convertRangeFilter(r));break}case s.FilterType.RelativeDate:{const r=e;if(!r)throw new Error("Invalid Relative Date Filter");t.push(this.convertRelativeDateFilter(r));break}}})),t}convertCategoricalFilter(e){const t=e.values.map((e=>u.DataValueFactory.MakeFilterDataValue(e)));return new c.CategoricalFilter(e.visualId.worksheet,e.fieldCaption,e.fieldName,s.FilterType.Categorical,this._registryId,t,e.isExclude,e.isAllSelected)}convertHierarchicalFilter(e){const t=e.values.map((e=>new c.HierarchicalDataValue(u.DataValueFactory.MakeFilterDataValue(e.value),e.hierarchicalPath,e.level))),r=e.levelInfo.map((e=>new c.HierarchicalLevelDetail(e.name,d.InternalToExternalEnumMappings.hierarchicalLevelSelectionState.convert(e.levelSelectionState))));return new c.HierarchicalFilter(e.visualId.worksheet,e.fieldCaption,e.fieldName,s.FilterType.Hierarchical,this._registryId,e.dimensionName,e.hierarchyCaption,e.levels,r,t,e.isAllSelected)}convertRangeFilter(e){const t=u.DataValueFactory.MakeFilterDataValue(e.min),r=u.DataValueFactory.MakeFilterDataValue(e.max);return new c.RangeFilter(e.visualId.worksheet,e.fieldCaption,e.fieldName,s.FilterType.Range,this._registryId,t,r,e.includeNullValues)}convertRelativeDateFilter(e){const t=u.DataValueFactory.MakeFilterDataValue(e.anchorDate);return new c.RelativeDateFilter(e.visualId.worksheet,e.fieldCaption,e.fieldName,i.FilterType.RelativeDate,this._registryId,t,d.InternalToExternalEnumMappings.dateStepPeriod.convert(e.periodType),d.InternalToExternalEnumMappings.dateRangeType.convert(e.rangeType),e.rangeN)}convertCategoricalDomain(e,t){const r=e.values.map((e=>u.DataValueFactory.MakeFilterDataValue(e)));return new c.CategoricalDomain(r,t)}convertRangeDomain(e,t){const r=u.DataValueFactory.MakeFilterDataValue(e.min),a=u.DataValueFactory.MakeFilterDataValue(e.max);return new c.RangeDomain(r,a,t)}convertAnchorDate(e){const t=e.getUTCFullYear(),r=e.getUTCMonth()+1,a=e.getUTCDate(),n=e.getUTCHours(),s=e.getUTCMinutes(),l=e.getUTCSeconds();if(isNaN(t)||isNaN(r)||isNaN(a)||isNaN(n)||isNaN(s)||isNaN(l))throw new o.TableauError(i.EmbeddingErrorCodes.InvalidDateParameter,"Invalid date parameter: anchorDate");return`${t}-${r}-${a} ${n}:${s}:${l}`}apiFilterHandlerCheckForCommandError(e){if(e[n.ParameterId.ParameterError]){if(e[n.ParameterId.InvalidFieldCaption])throw new o.TableauError(i.SharedErrorCodes.InvalidFilterFieldName,e[n.ParameterId.InvalidFieldCaption]);if(e[n.ParameterId.InvalidValues])throw new o.TableauError(i.SharedErrorCodes.InvalidFilterFieldValue,e[n.ParameterId.InvalidValues]);if(e[n.ParameterId.InvalidAggFieldName])throw new o.TableauError(i.SharedErrorCodes.InvalidAggregationFieldName,e[n.ParameterId.InvalidAggFieldName]);throw new o.TableauError(i.SharedErrorCodes.ServerError,"Server Error")}}}t.FilterServiceImpl=m},7712:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(3448),n=r(6680),s=r(5136),o=r(1044),l=r(5068),d=r(7968),c=r(8052),u=r(3483),h=r(1776);class p extends h.ServiceImplBase{constructor(){super(...arguments),this.viewDataTableCacheId=n.v4()}get serviceName(){return"get-data-service"}getMaxRowLimit(){return 1e4}getViewDataTableCacheId(){return this.viewDataTableCacheId}getLimitedMaxRows(e,t){return e>0&&e<t?e:t}getUnderlyingDataAsync(e,t,r,a,n,s,l,d,c){const h=t===u.GetDataType.Summary,p=h?"getSummaryDataAsync":"getUnderlyingDataAsync",m=h?i.VerbId.GetDataSummaryData:i.VerbId.GetUnderlyingData,g=m===i.VerbId.GetUnderlyingData?this.getLimitedMaxRows(l,this.getMaxRowLimit()+1):l,y={[i.ParameterId.FunctionName]:p};return y[i.ParameterId.VisualId]=e,y[i.ParameterId.IgnoreAliases]=r,y[i.ParameterId.IgnoreSelection]=a,y[i.ParameterId.IncludeAllColumns]=n,y[i.ParameterId.ColumnsToIncludeById]=this.verifyIncludeColumnArray(s),y[i.ParameterId.MaxRows]=g,y[i.ParameterId.ShowDataTableFormat]=o.ExternalToInternalEnumMappings.showDataTableFormatType.convert(d),y[i.ParameterId.ApplyWorksheetFormatting]=c,this.execute(m,y).then((e=>{const t=e.result;return this.processResultsTable(t.data,t.isSummary)}))}getSummaryDataReaderAsync(e,t,r,a,n,s,l,c){const u={[i.ParameterId.FunctionName]:"getSummaryDataReaderAsync",[i.ParameterId.ViewDataTableCacheId]:this.getViewDataTableCacheId(),[i.ParameterId.VisualId]:e,[i.ParameterId.PageRowCount]:t,[i.ParameterId.IgnoreAliases]:r,[i.ParameterId.IgnoreSelection]:a,[i.ParameterId.IncludeAllColumns]:n,[i.ParameterId.ColumnsToIncludeById]:this.verifyIncludeColumnArray(s),[i.ParameterId.ShowDataTableFormat]:o.ExternalToInternalEnumMappings.showDataTableFormatType.convert(l),[i.ParameterId.ApplyWorksheetFormatting]:c};return this.execute(i.VerbId.GetDataSummaryDataReader,u).then((e=>{const r=e.result;return new d.DataTableReader(r.id,r.totalRowCount,t,this._registryId)}))}getSummaryColumnsInfoAsync(e){const t=i.VerbId.GetDataSummaryData,r={[i.ParameterId.FunctionName]:"getSummaryColumnsInfoAsync",[i.ParameterId.VisualId]:e,[i.ParameterId.IgnoreAliases]:!0,[i.ParameterId.IgnoreSelection]:!0,[i.ParameterId.IncludeAllColumns]:!0,[i.ParameterId.MaxRows]:1,[i.ParameterId.ShowDataTableFormat]:i.ApiShowDataTableFormat.NativeValuesOnly};return this.execute(t,r).then((e=>e.result.data.headers.map((e=>new l.Column(e.fieldCaption,e.fieldName,e.dataType,e.isReferenced,e.index)))))}getSelectedMarksAsync(e){const t={[i.ParameterId.FunctionName]:"getSelectedMarksAsync",[i.ParameterId.VisualId]:e};return this.execute(i.VerbId.GetSelectedMarks,t).then((e=>({data:e.result.data.map((e=>this.processResultsTable(e,!0)))})))}getHighlightedMarksAsync(e){const t={[i.ParameterId.FunctionName]:"getHighlightedMarksAsync",[i.ParameterId.VisualId]:e};return this.execute(i.VerbId.GetHighlightedMarks,t).then((e=>({data:e.result.data.map((e=>this.processResultsTable(e,!0)))})))}getDataSourceDataAsync(e,t,r,a,n,s){const l={[i.ParameterId.FunctionName]:"getDataSourceDataAsync",[i.ParameterId.DataSourceId]:e,[i.ParameterId.IgnoreAliases]:t,[i.ParameterId.MaxRows]:this.getLimitedMaxRows(r,this.getMaxRowLimit()+1),[i.ParameterId.ColumnsToInclude]:this.verifyIncludeColumnArray(a),[i.ParameterId.ColumnsToIncludeById]:this.verifyIncludeColumnArray(n),[i.ParameterId.ShowDataTableFormat]:o.ExternalToInternalEnumMappings.showDataTableFormatType.convert(s)};return this.execute(i.VerbId.GetDataSourceData,l).then((e=>{const t=e.result;return this.processResultsTable(t.data,!1)}))}getLogicalTableDataAsync(e,t,r,a,n,s,l){const d={[i.ParameterId.FunctionName]:"getLogicalTableDataAsync",[i.ParameterId.ColumnsToInclude]:n,[i.ParameterId.ColumnsToIncludeById]:this.verifyIncludeColumnArray(s),[i.ParameterId.DataSourceId]:e,[i.ParameterId.IgnoreAliases]:r,[i.ParameterId.LogicalTableId]:t,[i.ParameterId.MaxRows]:this.getLimitedMaxRows(a,this.getMaxRowLimit()+1),[i.ParameterId.ShowDataTableFormat]:o.ExternalToInternalEnumMappings.showDataTableFormatType.convert(l)};return this.execute(i.VerbId.GetLogicalTableData,d).then((e=>{const t=e.result;return this.processResultsTable(t.data,!1)}))}getLogicalTableDataReaderAsync(e,t,r,a,n,s){r=this.getLimitedMaxRows(r,this.getMaxRowLimit());const l={[i.ParameterId.FunctionName]:"getLogicalTableDataReaderAsync",[i.ParameterId.ViewDataTableCacheId]:this.getViewDataTableCacheId(),[i.ParameterId.DataSourceId]:e,[i.ParameterId.LogicalTableId]:t,[i.ParameterId.PageRowCount]:r,[i.ParameterId.IgnoreAliases]:a,[i.ParameterId.ColumnsToIncludeById]:this.verifyIncludeColumnArray(n),[i.ParameterId.ShowDataTableFormat]:o.ExternalToInternalEnumMappings.showDataTableFormatType.convert(s)};return this.execute(i.VerbId.GetLogicalTableDataReader,l).then((e=>{const t=e.result;return new d.DataTableReader(t.id,t.totalRowCount,r,this._registryId)}))}getUnderlyingTableDataAsync(e,t,r,a,n,s,l,d,c){const u={[i.ParameterId.FunctionName]:"getUnderlyingTableDataAsync",[i.ParameterId.VisualId]:e,[i.ParameterId.LogicalTableId]:t,[i.ParameterId.IgnoreAliases]:r,[i.ParameterId.IgnoreSelection]:a,[i.ParameterId.IncludeAllColumns]:n,[i.ParameterId.ColumnsToIncludeById]:this.verifyIncludeColumnArray(s),[i.ParameterId.MaxRows]:this.getLimitedMaxRows(l,this.getMaxRowLimit()+1),[i.ParameterId.ShowDataTableFormat]:o.ExternalToInternalEnumMappings.showDataTableFormatType.convert(d),[i.ParameterId.ApplyWorksheetFormatting]:c};return this.execute(i.VerbId.GetUnderlyingTableData,u).then((e=>{const t=e.result;return this.processResultsTable(t.data,!1)}))}getUnderlyingTableDataReaderAsync(e,t,r,a,n,s,l,c,u){r=this.getLimitedMaxRows(r,this.getMaxRowLimit());const h={[i.ParameterId.FunctionName]:"getUnderlyingTableDataReaderAsync",[i.ParameterId.ViewDataTableCacheId]:this.getViewDataTableCacheId(),[i.ParameterId.VisualId]:e,[i.ParameterId.LogicalTableId]:t,[i.ParameterId.IgnoreAliases]:a,[i.ParameterId.IgnoreSelection]:n,[i.ParameterId.IncludeAllColumns]:s,[i.ParameterId.ColumnsToIncludeById]:this.verifyIncludeColumnArray(l),[i.ParameterId.ShowDataTableFormat]:o.ExternalToInternalEnumMappings.showDataTableFormatType.convert(c),[i.ParameterId.PageRowCount]:r,[i.ParameterId.ApplyWorksheetFormatting]:u};return this.execute(i.VerbId.GetUnderlyingTableDataReader,h).then((e=>{const t=e.result;return new d.DataTableReader(t.id,t.totalRowCount,r,this._registryId)}))}getPageAsync(e,t,r){const a={[i.ParameterId.FunctionName]:"getPageAsync",[i.ParameterId.ViewDataTableCacheId]:this.getViewDataTableCacheId(),[i.ParameterId.ViewDataTableId]:e,[i.ParameterId.DataRowIndex]:t*r};return this.execute(i.VerbId.GetDataTableReaderPage,a).then((t=>{const r=t.result;return this.processResultsPage(r,e===p.summaryTableId)}))}releaseAsync(e){const t={[i.ParameterId.FunctionName]:"release",[i.ParameterId.ViewDataTableCacheId]:this.getViewDataTableCacheId(),[i.ParameterId.ViewDataTableId]:e};return this.execute(i.VerbId.ReleaseDataTableReader,t).then((e=>{}))}verifyIncludeColumnArray(e){if(!Array.isArray(e))throw new s.TableauError(a.ErrorCodes.InvalidParameter,"columnsToInclude and columnsToIncludeById must be valid arrays");const t=new Set(e);return Array.from(t)}processResultsTable(e,t){const r=e.headers.map((e=>new l.Column(e.fieldCaption,e.fieldName,e.dataType,e.isReferenced,e.index)));let a;e.marks&&(a=e.marks.map((e=>new l.MarkInfo(e.type,e.color,e.tupleId))));const i=!1===t&&e.dataTable.length===this.getMaxRowLimit()+1;i&&(e.dataTable.length-=1);const n=e.dataTable.map((e=>e.map(((e,t)=>c.DataValueFactory.MakeTableDataValue(e,r[t].dataType)))));return a?new l.DataTable(n,r,n.length,i,t,a):new l.DataTable(n,r,n.length,i,t)}processResultsPage(e,t){const r=e.headers.map((e=>new l.Column(e.fieldCaption,e.fieldName,e.dataType,e.isReferenced,e.index)));let a;e.marks&&(a=e.marks.map((e=>new l.MarkInfo(e.type,e.color,e.tupleId))));const i=e.dataTable.map((e=>e.map(((e,t)=>c.DataValueFactory.MakeTableDataValue(e,r[t].dataType)))));return a?new l.DataTable(i,r,i.length,!1,t,a):new l.DataTable(i,r,i.length,!1,t)}}t.GetDataServiceImpl=p,p.summaryTableId=""},1288:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(8808);class i extends a.NotificationServiceImplBase{get serviceName(){return"notification-service"}}t.NotificationServiceImpl=i},8808:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(e,t){this._filterFn=e,this._callbackFn=t}onNotification(e){this._filterFn(e)&&this._callbackFn(e)}}t.Registration=r,t.NotificationServiceImplBase=class{constructor(e){this.dispatcher=e,this._handlers={},this.dispatcher.registerNotificationHandler(this.onNotification.bind(this))}registerHandler(e,t,a){const i=this._handlers[e]||new Array,n=new r(t,a);return i.push(n),this._handlers[e]=i,()=>this.removeRegistration(e,n)}hasHandlersForNotificationType(e){return this._handlers.hasOwnProperty(e)}onNotification(e){this.hasHandlersForNotificationType(e.notificationId)&&this._handlers[e.notificationId].forEach((t=>t.onNotification(e.data)))}removeRegistration(e,t){this.hasHandlersForNotificationType(e)&&(this._handlers[e]=this._handlers[e].filter((e=>e!==t)))}}},7260:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(3448),n=r(8552),s=r(6664),o=r(1776);class l extends o.ServiceImplBase{get serviceName(){return"parameters-service"}getParametersForSheetAsync(e){const t={[i.ParameterId.FunctionName]:"getParametersForSheetAsync",[i.ParameterId.SheetPath]:e};return this.getParametersAsync(t)}getAllParametersAsync(){const e={[i.ParameterId.FunctionName]:"getParametersForSheetAsync"};return this.getParametersAsync(e)}getParametersAsync(e){return this.execute(i.VerbId.GetParametersForSheet,e).then((e=>e.result.map((e=>new n.ParameterImpl(e,this._registryId)))))}changeParameterValueAsync(e,t){const r={[i.ParameterId.FunctionName]:"changeParameterValueAsync",[i.ParameterId.ParameterFieldName]:e,[i.ParameterId.ParameterValue]:t};return this.execute(i.VerbId.ChangeParameterValue,r).then((e=>e.result))}findParameterByNameAsync(e){return this.findParameterAsync(e,void 0)}findParameterByGlobalFieldNameAsync(e){return this.findParameterAsync(void 0,e)}findParameterAsync(e,t){const r={[i.ParameterId.FunctionName]:"findParameterAsync"};if(void 0!==e)r[i.ParameterId.ParameterCaption]=e;else{if(void 0===t)throw new s.TableauError(a.ErrorCodes.InvalidParameter,"name or fieldName must be provided to find parameter");r[i.ParameterId.ParameterFieldName]=t}return this.execute(i.VerbId.FindParameter,r).then((e=>{if("fieldName"in e.result){const t=e.result;return new n.ParameterImpl(t,this._registryId)}}))}}t.ParametersServiceImpl=l},8784:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(3448),n=r(7104),s=r(6664),o=r(1172),l=r(1776);class d extends l.ServiceImplBase{get serviceName(){return"selection-service"}clearSelectedMarksAsync(e){const t={[i.ParameterId.FunctionName]:"clearSelectedMarksAsync",[i.ParameterId.VisualId]:e};return this.execute(i.VerbId.ClearSelectedMarks,t).then((e=>{}))}selectMarksByValueAsync(e,t,r){if(0===t.length)throw new s.TableauError(a.ErrorCodes.InvalidParameter,"Selection criteria missing for selecting marks by value");const n=this.validateSelectionUpdateType(r),o=this.parseSelectionMarks(t),l={[i.ParameterId.FunctionName]:"selectMarksByValueAsync",[i.ParameterId.VisualId]:e,[i.ParameterId.SelectionUpdateType]:n};return o.hierModelArr&&o.hierModelArr.length&&(l[i.ParameterId.HierValSelectionModels]=o.hierModelArr),o.quantModelArr&&o.quantModelArr.length&&(l[i.ParameterId.QuantRangeSelectionModels]=o.quantModelArr),o.dimModelArr&&o.dimModelArr.length&&(l[i.ParameterId.DimValSelectionModels]=o.dimModelArr),this.execute(i.VerbId.SelectByValue,l).then((e=>{this.apiFilterHandlerCheckForCommandError(e.result)}))}hoverTupleAsync(e,t,r,a){let s=new n.HoverTupleInteractionModel(e,this.ensureTupleIDIsNonNegative(t),r,a);const o={[i.ParameterId.FunctionName]:"hoverTupleAsync",[i.ParameterId.HoverTupleInteraction]:s};return this.execute(i.VerbId.RaiseHoverTupleNotification,o).then((e=>{}))}selectTuplesAsync(e,t,r,a){let s=new n.SelectTuplesInteractionModel(e,t,r,a);const o={[i.ParameterId.FunctionName]:"selectTuplesAsync",[i.ParameterId.SelectTuplesInteraction]:s};return this.execute(i.VerbId.RaiseSelectTuplesNotification,o).then((e=>{}))}apiFilterHandlerCheckForCommandError(e){if(e[i.ParameterId.ParameterError]){if(e[i.ParameterId.InvalidFields])throw new s.TableauError(a.SharedErrorCodes.InvalidSelectionFieldName,e[i.ParameterId.InvalidFields]);if(e[i.ParameterId.InvalidValues])throw new s.TableauError(a.SharedErrorCodes.InvalidSelectionValue,e[i.ParameterId.InvalidValues]);if(e[i.ParameterId.InvalidDates])throw new s.TableauError(a.SharedErrorCodes.InvalidSelectionDate,e[i.ParameterId.InvalidDates])}}selectMarksByIdAsync(e,t,r){if(0===t.length)throw new s.TableauError(a.ErrorCodes.InvalidParameter,"Marks info missing for selecting marks by Id");const n=this.validateSelectionUpdateType(r),o=this.parseSelectionIds(t),l={[i.ParameterId.FunctionName]:"selectMarksByIdAsync",[i.ParameterId.VisualId]:e,[i.ParameterId.SelectionUpdateType]:n,[i.ParameterId.Selection]:o.selection};return this.execute(i.VerbId.SelectByValue,l).then((e=>{}))}parseSelectionIds(e){const t=[],r=new n.SelectionModelsContainer;for(let r=0;r<e.length;r++){const i=e[r].tupleId;if(null==i)throw new s.TableauError(a.ErrorCodes.InternalError,"tupleId parsing error");t.push(i.toString())}if(0!==t.length){const e=new n.TupleSelectionModel;e.selectionType="tuples",e.objectIds=t,r.selection=e}return r}parseSelectionMarks(e){const t=new n.SelectionModelsContainer;for(let r=0;r<e.length;r++){const i=e[r];if(!i.fieldName||void 0===i.value||null===i.value)throw new s.TableauError(a.ErrorCodes.InternalError,"Selection Criteria parsing error");const n=new RegExp("([[A-Za-z0-9]+]).*","g"),o=i.value;if(n.test(i.fieldName)){const e=this.addToParamsList(i.fieldName,i.value);t.hierModelArr.push(e)}else if(void 0!==o.min&&void 0!==o.max){const e=this.addToRangeParamsList(i.fieldName,o);t.quantModelArr.push(e)}else{const e=this.addToParamsList(i.fieldName,i.value);t.dimModelArr.push(e)}}return t}addToParamsList(e,t){const r=new n.ValueSelectionModel,a=[];if(t instanceof Array){const e=t;for(let t=0;t<e.length;t++)a.push(o.Param.serializeParameterValue(e[t]))}else a.push(o.Param.serializeParameterValue(t));return r.qualifiedFieldCaption=e,r.selectValues=a,r}addToRangeParamsList(e,t){const r=new n.RangeSelectionModel;return r.qualifiedFieldCaption=e,void 0!==t.max&&null!==t.max&&(r.maxValue=o.Param.serializeParameterValue(t.max)),void 0!==t.min&&null!==t.min&&(r.minValue=o.Param.serializeParameterValue(t.min)),r.included=this.validateNullOptionType(t.nullOption),r}validateSelectionUpdateType(e){return e===a.SelectionUpdateType.Replace?i.SelectionUpdateType.Replace:e===a.SelectionUpdateType.Add?i.SelectionUpdateType.Add:e===a.SelectionUpdateType.Remove?i.SelectionUpdateType.Remove:i.SelectionUpdateType.Replace}validateNullOptionType(e){if(e){if(e===a.FilterNullOption.NullValues)return i.QuantitativeIncludedValues.IncludeNull;if(e===a.FilterNullOption.NonNullValues)return i.QuantitativeIncludedValues.IncludeNonNull;if(e===a.FilterNullOption.AllValues)return i.QuantitativeIncludedValues.IncludeAll}return i.QuantitativeIncludedValues.IncludeAll}ensureTupleIDIsNonNegative(e){return e&&e>0?e:0}}t.SelectionServiceImpl=d},1776:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(6557),i=r(6664),n=r(5520);t.ServiceImplBase=class{constructor(e,t){this._dispatcher=e,this._registryId=t}execute(e,t){return this._dispatcher.execute(e,t).catch((e=>{const t=e,r=a.InternalToExternalEnumMappings.errorCode.convert(t.errorCode,n.ShouldThrow.No);throw new i.TableauError(r,t.message)}))}}},4109:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(3448),i=r(1776);class n extends i.ServiceImplBase{get serviceName(){return"size-service"}changeSizeAsync(e,t){var r,i,n,s;const o={[a.ParameterId.FunctionName]:"changeSizeAsync",[a.ParameterId.SheetName]:e,[a.ParameterId.MinHeight]:(null===(r=t.minSize)||void 0===r?void 0:r.height)||0,[a.ParameterId.MinWidth]:(null===(i=t.minSize)||void 0===i?void 0:i.width)||0,[a.ParameterId.MaxHeight]:(null===(n=t.maxSize)||void 0===n?void 0:n.height)||0,[a.ParameterId.MaxWidth]:(null===(s=t.maxSize)||void 0===s?void 0:s.width)||0};return this.execute(a.VerbId.SetSheetSize,o).then((e=>{}))}}t.SizeServiceImpl=n},2248:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(3448),i=r(1776);class n extends i.ServiceImplBase{get serviceName(){return"story-activation-service"}activateNextStoryPointAsync(){const e=a.VerbId.ActivateNextStoryPoint,t={[a.ParameterId.FunctionName]:"activateNextStoryPointAsync"};return this.execute(e,t).then((e=>{}))}activatePreviousStoryPointAsync(){const e=a.VerbId.ActivatePreviousStoryPoint,t={[a.ParameterId.FunctionName]:"activatePreviousStoryPointAsync"};return this.execute(e,t).then((e=>{}))}activateStoryPointAsync(e){const t=a.VerbId.ActivateStoryPoint,r={[a.ParameterId.FunctionName]:"activateStoryPointAsync"};return r[a.ParameterId.StoryPointIndex]=e,this.execute(t,r).then((e=>{}))}revertStoryPointAsync(e){const t=a.VerbId.RevertStoryPoint,r={[a.ParameterId.FunctionName]:"revertStoryPointAsync"};return r[a.ParameterId.StoryPointIndex]=e,this.execute(t,r).then((e=>e.result))}}t.StoryActivationServiceImpl=n},6096:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(3448),i=r(1776);class n extends i.ServiceImplBase{get serviceName(){return"visual-model-service"}getVisualSpecificationAsync(e){const t={[a.ParameterId.FunctionName]:"getVisualSpecificationAsync",[a.ParameterId.WorksheetName]:e.worksheet};return this.execute(a.VerbId.GetVisualSpecification,t).then((e=>e.result))}addMarksCardFieldsAsync(e,t,r,i,n){const s={[a.ParameterId.FunctionName]:"addMarksCardFieldsAsync",[a.ParameterId.WorksheetName]:e.worksheet,[a.ParameterId.MarksCardIndex]:t,[a.ParameterId.EncodingType]:r,[a.ParameterId.Columns]:i,[a.ParameterId.StartIndex]:n};return this.execute(a.VerbId.AddMarksCardFields,s).then((()=>{}))}moveMarksCardFieldAsync(e,t,r,i,n=1){const s={[a.ParameterId.FunctionName]:"addMarksCardFieldsAsync",[a.ParameterId.WorksheetName]:e.worksheet,[a.ParameterId.MarksCardIndex]:t,[a.ParameterId.FromIndex]:r,[a.ParameterId.ToIndex]:i,[a.ParameterId.FieldCount]:n};return this.execute(a.VerbId.MoveMarksCardField,s).then((()=>{}))}spliceMarksCardFieldsAsync(e,t,r,i,n,s){const o={[a.ParameterId.FunctionName]:"spliceMarksCardFieldsAsync",[a.ParameterId.WorksheetName]:e.worksheet,[a.ParameterId.MarksCardIndex]:t,[a.ParameterId.EncodingType]:r,[a.ParameterId.StartIndex]:i,[a.ParameterId.DeleteCount]:n,[a.ParameterId.Columns]:s};return this.execute(a.VerbId.SpliceMarksCardFields,o).then((()=>{}))}editAliasesDialogAsync(e){const t={[a.ParameterId.FunctionName]:"editAliasesDialogAsync",[a.ParameterId.FieldId]:e};return this.execute(a.VerbId.EditAliasesDialog,t).then((()=>{}))}}t.VisualModelServiceImpl=n},744:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(3448),i=r(2520),n=r(1776);class s extends n.ServiceImplBase{get serviceName(){return"viz-service"}createVizImageAsync(e){const t={[a.ParameterId.FunctionName]:"createVizImageAsync",[a.ParameterId.VizAPIInputJson]:JSON.stringify(e)};return this.execute(a.VerbId.VizAPI,t).then((e=>e.result))}activateSheetAsync(e){const t={[a.ParameterId.FunctionName]:"activateSheetAsync",[a.ParameterId.SwitchToSheetName]:e};return this.execute(a.VerbId.ActivateSheet,t).then((()=>{}))}getCustomViewsAsync(){const e={[a.ParameterId.FunctionName]:"getCustomViewsAsync"};return this.execute(a.VerbId.GetCustomViews,e).then((e=>e.result.map((e=>new i.CustomViewImpl(e,this._registryId)))))}showCustomViewAsync(e){const t={[a.ParameterId.FunctionName]:"showCustomViewAsync",[a.ParameterId.CustomViewName]:e||""};return this.execute(a.VerbId.ShowCustomView,t).then((e=>{var t;const r=e.result;return(null===(t=r)||void 0===t?void 0:t.luid)?new i.CustomViewImpl(r,this._registryId):void 0}))}removeCustomViewAsync(e){const t={[a.ParameterId.FunctionName]:"removeCustomViewAsync",[a.ParameterId.CustomViewName]:e};return this.execute(a.VerbId.RemoveCustomView,t).then((e=>{const t=e.result;return new i.CustomViewImpl(t,this._registryId)}))}saveCustomViewAsync(e){const t={[a.ParameterId.FunctionName]:"saveCustomViewAsync",[a.ParameterId.CustomViewName]:e,[a.ParameterId.CustomViewIsDefault]:!1};return this.execute(a.VerbId.SaveWorkbookAsCustomView,t).then((e=>{const t=e.result;return new i.CustomViewImpl(t,this._registryId)}))}setActiveCustomViewAsDefaultAsync(){const e={[a.ParameterId.FunctionName]:"setActiveCustomViewAsDefaultAsync"};return this.execute(a.VerbId.SetActiveCustomViewAsDefault,e).then((()=>{}))}saveAsync(e){const t={[a.ParameterId.FunctionName]:"saveAsync",[a.ParameterId.CustomViewLuid]:e.luid,[a.ParameterId.CustomViewName]:e.name,[a.ParameterId.CustomViewIsDefault]:e.isDefault,[a.ParameterId.CustomViewIsPublic]:e.shared};return this.execute(a.VerbId.UpdateCustomView,t).then((e=>{const t=e.result;return new i.CustomViewImpl(t,this._registryId)}))}getCurrentSrcAsync(){const e={[a.ParameterId.FunctionName]:"getCurrentSrcAsync"};return this.execute(a.VerbId.GetCurrentSrc,e).then((e=>e.result))}}t.VizServiceImpl=s},8856:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(3448),n=r(1044),s=r(7480),o=r(1172),l=r(1776);class d extends l.ServiceImplBase{get serviceName(){return"zone-service"}setVisibilityAsync(e,t,r){const l={[i.ParameterId.FunctionName]:"setVisibilityAsync",[i.ParameterId.Dashboard]:e,[i.ParameterId.ZoneIdsVisibilityMap]:{}};return o.Param.convertParameterToMap(r,"zoneVisibilityMap").forEach(((e,r)=>{s.ErrorHelpers.verifyZoneIsValid(t,Number.parseInt(r,10)),s.ErrorHelpers.verifyEnumValue(e,a.DashboardObjectVisibilityType,"DashboardObjectVisibilityType"),l[i.ParameterId.ZoneIdsVisibilityMap][r]=n.ExternalToInternalEnumMappings.setVisibilityType.convert(e)})),this.execute(i.VerbId.SetZoneVisibility,l).then((e=>{}))}moveAndResizeAsync(e,t,r){const a={[i.ParameterId.Dashboard]:e,[i.ParameterId.DashboardObjectPositionAndSizeUpdateList]:r};return r.forEach((e=>{s.ErrorHelpers.verifyZoneIsValidAndFloating(t,e.dashboardObjectID),s.ErrorHelpers.verifyWidthAndHeightOfDashboardObjectPositionAndSizeUpdate(e)})),this.execute(i.VerbId.MoveAndResizeZones,a).then((e=>{}))}}t.ZoneServiceImpl=d},7603:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableSummary=class{constructor(e){this._tableInfo=e}get name(){return this._tableInfo.name}get id(){return this._tableInfo.id}get connectionId(){return this._tableInfo.connectionId}get customSQL(){return this._tableInfo.customSQL}}},6664:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r extends Error{constructor(e,t){super(`${e}: ${t}`),this._errorCode=e,Object.setPrototypeOf(this,r.prototype)}get errorCode(){return this._errorCode}}t.TableauError=r},8052:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(3448),i=r(5068);t.DataValueFactory=class{static MakeParameterDataValue(e,t){return new i.DataValue(e.value,a.DataTypeConverter.convertStringValueToNativeValue(e.value,t),e.formattedValue,e.aliasedValue,e.hasAlias)}static MakeFilterDataValue(e){return new i.DataValue(e.value,e.value,e.formattedValue)}static MakeTableDataValue(e,t){return new i.DataValue(e.value,void 0!==e.value?a.DataTypeConverter.convertValueToNativeValue(e.value,t):void 0,e.formattedValue)}}},1724:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Deferred=class{constructor(){this._promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t}))}get promise(){return this._promise}resolve(e){this._resolve&&this._resolve(e)}reject(e){this._reject&&this._reject(e)}},t.UnregisterTimeoutInMilliseconds=3e4},5520:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(6664);var n;t.EnumConverter=class{constructor(e,t){this._mappings=e,this._defaultVal=t}convert(e,t=n.Yes){if(this._mappings.hasOwnProperty(e))return this._mappings[e];if(void 0!==this._defaultVal&&t!==n.Yes)return this._defaultVal;throw new i.TableauError(a.ErrorCodes.InternalError,`Enum Mapping not found for: ${e}`)}},function(e){e.Yes="yes",e.No="no"}(n=t.ShouldThrow||(t.ShouldThrow={}))},7480:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(6664),n=r(1172);class s{static apiNotImplemented(e){return new i.TableauError(a.SharedErrorCodes.InternalError,`${e} API not yet implemented.`)}static verifyInternalValue(e,t){if(null==e)throw new i.TableauError(a.SharedErrorCodes.InternalError,`${e} is invalid value for: ${t}`)}static verifyParameter(e,t){if(null==e)throw new i.TableauError(a.SharedErrorCodes.InvalidParameter,`${e} is invalid value for parameter: ${t}`)}static verifyParameterType(e,t,r){if(typeof e!==t)throw new i.TableauError(a.SharedErrorCodes.InvalidParameter,`${e} has invalid type for parameter: ${r}.`)}static verifyStringParameter(e,t){if(null==e||""===e)throw new i.TableauError(a.SharedErrorCodes.InvalidParameter,`${e} is invalid value for paramter: ${t}`)}static isValidEnumValue(e,t){let r=!1;return Object.keys(t).forEach((a=>{t[a]===e.toString()&&(r=!0)})),r}static verifyEnumValue(e,t,r){if(!s.isValidEnumValue(e,t))throw new i.TableauError(a.SharedErrorCodes.InvalidParameter,`${e} is invalid value for enum: ${r}.`)}static verifyRange(e,t,r){if(!(t<=e&&e<r))throw new i.TableauError(a.SharedErrorCodes.InvalidParameter,`${e} is invalid value for range: [${t}..${r})`)}static verifyRangeParamType(e,t){const r=void 0!==e,s=void 0!==t;if(!r&&!s)throw new i.TableauError(a.SharedErrorCodes.InvalidParameter,"Unexpected invalid param value, at least one of min or max is required.");if(r&&!n.Param.isTypeNumber(e)&&!n.Param.isTypeDate(e))throw new i.TableauError(a.SharedErrorCodes.InvalidParameter,"Unexpected invalid param value, only Date and number are allowed for parameter min.");if(s&&!n.Param.isTypeNumber(t)&&!n.Param.isTypeDate(t))throw new i.TableauError(a.SharedErrorCodes.InvalidParameter,"Unexpected invalid param value, only Date and number are allowed for parameter max.");if(r&&s&&typeof e!=typeof t)throw new i.TableauError(a.SharedErrorCodes.InvalidParameter,"Unexpected invalid param value, parameters min and max should be of the same type.")}static verifyZoneIsValid(e,t){if(!e.has(t))throw new i.TableauError(a.SharedErrorCodes.InvalidParameter,`Unexpected invalid param value, Dashboard Object Id: ${t} is not present in dashboard.`)}static verifyZoneIsValidAndFloating(e,t){if(!e.has(t)||!e.get(t).isFloating)throw new i.TableauError(a.SharedErrorCodes.InvalidParameter,`Unexpected invalid param value, Dashboard Object Id: ${t} is not present or is a fixed zone in the dashboard.`)}static verifyWidthAndHeightOfDashboardObjectPositionAndSizeUpdate(e){if(e.width<0||e.height<0)throw new i.TableauError(a.SharedErrorCodes.InvalidParameter,`Unexpected invalid param value for dashboard object ID ${e.dashboardObjectID}: negative widths and heights are not allowed.`)}static verifySheetName(e,t){if(!e.includes(t))throw new i.TableauError(a.SharedErrorCodes.InvalidSelectionSheet,"sheetName parameter must belong to a worksheet within the current view")}static verifyExportDataOptions(e){if(!n.Param.isNullOrUndefined(e.ignoreAliases)&&!n.Param.isTypeBool(e.ignoreAliases)||!n.Param.isNullOrUndefined(e.columnsToIncludeById)&&!Array.isArray(e.columnsToIncludeById))throw new i.TableauError(a.SharedErrorCodes.InvalidParameter,"options paramater must be of type ExportDataOptions")}static verifySheetNamesForPDFAndPPT(e,t){if(!Array.isArray(e))throw new i.TableauError(a.SharedErrorCodes.InvalidParameter,"sheetNames parameter must be an array");if(0===e.length)throw new i.TableauError(a.SharedErrorCodes.InternalError,"sheetNames should not be empty");if(!(e.every((e=>t.exportableSheetNamesFromDashboard.includes(e)))||e.every((e=>t.exportableSheetNamesFromWorkbook.includes(e)))||1===e.length&&e[0]===t.currentSheetName))throw new i.TableauError(a.SharedErrorCodes.InvalidSelectionSheet,"sheetNames parameter must have all its entries be exportable sheet names from the dashboard or all its entries be exportable sheet names from the workbook")}static verifyExportPDFOptions(e){try{this.verifyEnumValue(e.orientation,a.PrintOrientation,"PrintOrientation"),this.verifyEnumValue(e.pageSize,a.PrintPageSize,"PrintPageSize"),this.verifyEnumValue(e.scaling,a.PrintScaling,"PrintScaling")}catch(e){throw new i.TableauError(a.SharedErrorCodes.InvalidParameter,"options parameter must be of type ExportPDFOptions")}}}t.ErrorHelpers=s},5044:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(3448),i=r(7419),n=r(6664);class s{static updateInternalExportPDFOptions(e,t,r){e.currentSheet=r[0],this.updateExportLayoutOptions(e,t),this.updateSheetOptions(e,r)}static updateExportLayoutOptions(e,t){const r=e.exportLayoutOptions;switch(r.imageHeight=this.DefaultLayoutOptions.imageHeight,r.imageWidth=this.DefaultLayoutOptions.imageWidth,t.orientation){case i.PrintOrientation.Landscape:r.pageOrientationOption=a.PageOrientation.Landscape;break;case i.PrintOrientation.Portrait:r.pageOrientationOption=a.PageOrientation.Portrait;break;default:throw new n.TableauError(i.SharedErrorCodes.InternalError,"invalid orientation for ExportPDFOption")}switch(t.pageSize){case i.PrintPageSize.A3:r.pageSizeOption=a.PageSizeOption.A3;break;case i.PrintPageSize.A4:r.pageSizeOption=a.PageSizeOption.A4;break;case i.PrintPageSize.A5:r.pageSizeOption=a.PageSizeOption.A5;break;case i.PrintPageSize.B4:r.pageSizeOption=a.PageSizeOption.B4;break;case i.PrintPageSize.B5:r.pageSizeOption=a.PageSizeOption.B5;break;case i.PrintPageSize.Executive:r.pageSizeOption=a.PageSizeOption.Executive;break;case i.PrintPageSize.Folio:r.pageSizeOption=a.PageSizeOption.Folio;break;case i.PrintPageSize.Ledger:r.pageSizeOption=a.PageSizeOption.Ledger;break;case i.PrintPageSize.Legal:r.pageSizeOption=a.PageSizeOption.Legal;break;case i.PrintPageSize.Letter:r.pageSizeOption=a.PageSizeOption.Letter;break;case i.PrintPageSize.Note:r.pageSizeOption=a.PageSizeOption.Note;break;case i.PrintPageSize.Quarto:r.pageSizeOption=a.PageSizeOption.Quarto;break;case i.PrintPageSize.Statement:r.pageSizeOption=a.PageSizeOption.Statement;break;case i.PrintPageSize.Tabloid:r.pageSizeOption=a.PageSizeOption.Tabloid;break;case i.PrintPageSize.Unspecified:r.pageSizeOption=a.PageSizeOption.Unspecified;break;default:throw new n.TableauError(i.SharedErrorCodes.InternalError,"invalid pageSize for ExportPDFOption")}switch(t.scaling){case i.PrintScaling.AtMost1PageHigh:this.setFitAndScaleValues(r,a.FitPages.FitOneHigh);break;case i.PrintScaling.AtMost1PageWide:this.setFitAndScaleValues(r,a.FitPages.FitOneWide);break;case i.PrintScaling.AtMost2PagesHigh:this.setFitAndScaleValues(r,a.FitPages.FitTwoHigh);break;case i.PrintScaling.AtMost2PagesWide:this.setFitAndScaleValues(r,a.FitPages.FitTwoWide);break;case i.PrintScaling.Automatic:this.setFitAndScaleValues(r,a.PageScalingOption.ScalePctAuto);break;case i.PrintScaling.Perc100:this.setFitAndScaleValues(r,a.PageScalingOption.ScalePct100);break;case i.PrintScaling.Perc200:this.setFitAndScaleValues(r,a.PageScalingOption.ScalePct200);break;case i.PrintScaling.Perc25:this.setFitAndScaleValues(r,a.PageScalingOption.ScalePct25);break;case i.PrintScaling.Perc400:this.setFitAndScaleValues(r,a.PageScalingOption.ScalePct400);break;case i.PrintScaling.Perc50:this.setFitAndScaleValues(r,a.PageScalingOption.ScalePct50);break;case i.PrintScaling.Perc60:this.setFitAndScaleValues(r,a.PageScalingOption.ScalePct60);break;case i.PrintScaling.Perc75:this.setFitAndScaleValues(r,a.PageScalingOption.ScalePct75);break;case i.PrintScaling.Perc80:this.setFitAndScaleValues(r,a.PageScalingOption.ScalePct80);break;case i.PrintScaling.Perc90:this.setFitAndScaleValues(r,a.PageScalingOption.ScalePct90);break;default:throw new n.TableauError(i.SharedErrorCodes.InternalError,"invalid scaling for ExportPDFOption")}}static updateSheetOptions(e,t){const{exportLayoutOptions:r,sheetOptions:a}=e;for(const e of a)e.exportLayoutOptions=r,e.isSelected=t.includes(e.sheet)}static setFitAndScaleValues(e,t){let{pageFitHorizontal:r,pageFitVertical:i,pageScaleMode:n,pageScalePercent:s}=this.DefaultLayoutOptions;const o=this.fitRegex.exec(t),l=this.pctRegex.exec(t);o?([r,i]=o.slice(1).map((e=>Number(e))),n=a.ScaleMode.ScaleFitPages):l&&([s]=l.slice(1).map((e=>Number(e))),n=a.ScaleMode.ScalePercentage),e.pageFitHorizontal=r,e.pageFitVertical=i,e.pageScaleMode=n,e.pageScalePercent=s}}t.ExportHelpers=s,s.DefaultDataOptions={ignoreAliases:!1,columnsToIncludeById:[]},s.DefaultPDFOptions={scaling:i.PrintScaling.Automatic,pageSize:i.PrintPageSize.Letter,orientation:i.PrintOrientation.Portrait},s.DefaultLayoutOptions={imageHeight:0,imageWidth:0,pageFitHorizontal:1,pageFitVertical:1,pageOrientationOption:a.PageOrientation.Portrait,pageScaleMode:a.ScaleMode.ScaleAuto,pageScalePercent:100,pageSizeOption:a.PageSizeOption.Letter},s.fitRegex=new RegExp("fit([0-9]+)x([0-9]+)"),s.pctRegex=new RegExp("pct([0-9]+)")},1172:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(6664),n=r(7480);class s{static serializeDateForPlatform(e){return`${e.getUTCFullYear()}-${e.getUTCMonth()+1}-${e.getUTCDate()} ${e.getUTCHours()}:${e.getUTCMinutes()}:${e.getUTCSeconds()}`}static serializeBooleanForPlatform(e){return e?"true":"false"}static serializeNumberForPlatform(e){return e.toString(10)}static isTypeNumber(e){return"number"==typeof e||e instanceof Number}static isTypeDate(e){return e instanceof Date}static isTypeString(e){return"string"==typeof e||e instanceof String}static isTypeBool(e){return"boolean"==typeof e||e instanceof Boolean}static isNullOrUndefined(e){return null==e}static serializeParameterValue(e){if(s.isTypeNumber(e))return s.serializeNumberForPlatform(e);if(s.isTypeDate(e))return s.serializeDateForPlatform(e);if(s.isTypeBool(e))return s.serializeBooleanForPlatform(e);if(s.isTypeString(e))return e;throw new i.TableauError(a.ErrorCodes.InternalError,`Unexpected invalid value for: ${e}`)}static convertParameterToMap(e,t){if(n.ErrorHelpers.verifyParameterType(e,"object",t),Array.isArray(e))throw new i.TableauError(a.ErrorCodes.InvalidParameter,`Expecting object or Map for: ${t}.`);return e instanceof Map?e:new Map(Object.entries(e))}static tryParseNumber(e){if(s.isNullOrUndefined(e))return{success:!1};if(s.isTypeNumber(e))return{parsed:e,success:!0};const t=e.toString();if("NaN"===t)return{parsed:NaN,success:!0};const r=parseFloat(t);return isNaN(r)?{success:!1}:{parsed:r,success:!0}}}t.Param=s},2780:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(3448),n=r(6664);t.SheetUtils=class{static getSheetSizeFromSizeConstraints(e){const{minWidth:t,minHeight:r,maxWidth:i,maxHeight:n}=e;if(0===r&&0===t)return 0===n&&0===i?{behavior:a.SheetSizeBehavior.Automatic}:{behavior:a.SheetSizeBehavior.AtMost,maxSize:{width:i,height:n}};if(0===n&&0===i)return{behavior:a.SheetSizeBehavior.AtLeast,minSize:{width:t,height:r}};if(n===r&&i===t&&t>0)return{behavior:a.SheetSizeBehavior.Exactly,minSize:{width:t,height:r},maxSize:{width:t,height:r}};const s=0===t&&0===i;return{behavior:a.SheetSizeBehavior.Range,minSize:{width:t,height:r},maxSize:{width:s?2147483647:i,height:n}}}static createAutomaticSize(){return{behavior:a.SheetSizeBehavior.Automatic,minSize:{width:0,height:0},maxSize:{width:0,height:0}}}static getPublishedSheetInfoByName(e,t){return t.find((t=>t.name===e))}static getSheetTypeEnum(e){let t;switch(e){case i.SheetType.Worksheet:t=a.SheetType.Worksheet;break;case i.SheetType.Dashboard:t=a.SheetType.Dashboard;break;case i.SheetType.Story:t=a.SheetType.Story;break;default:throw new n.TableauError(a.SharedErrorCodes.ServerError,"Invalid SheetType")}return t}static isValidSheetSize(e){return void 0!==e.behavior}}},3036:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(6664),n=r(1724);t.ShortLivedDeferred=class{constructor(e=n.UnregisterTimeoutInMilliseconds){this._timeoutInMilliseconds=e}getNewPromiseOrThrowIfBusy(){if(this._deferred)throw new i.TableauError(a.SharedErrorCodes.ApiExecutionError,"This api cannot be executed till previous call is resolved.");return this._deferred=new n.Deferred,this._timeoutId=setTimeout((()=>{const e=new i.TableauError(a.SharedErrorCodes.Timeout,`Api failed to complete in ${this._timeoutInMilliseconds/1e3} seconds`);this.reject(e)}),this._timeoutInMilliseconds),this._deferred.promise}resolve(e){this._deferred&&(clearTimeout(this._timeoutId),this._deferred.resolve(e),this._deferred=void 0)}reject(e){this._deferred&&(clearTimeout(this._timeoutId),this._deferred.reject(e),this._deferred=void 0)}}},1576:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(7419),i=r(6664);t.VersionNumber=class{constructor(e,t){const r=e.split("-");this.build=this.getBuildNumber(r[1]);const n=(e=r[0]).split(".").map((e=>parseInt(e,10)));if(3!==n.length)throw new i.TableauError(a.ErrorCodes.InternalError,`Invalid version number: ${e}`);this.major=n[0],this.minor=n[1],this.fix=n[2],this.isAlpha=t}getBuildNumber(e){if(!e)return-1;const t=e.split(".");return t[1]?parseInt(t[1],10):-1}get formattedValue(){return`${this.major}.${this.minor}.${this.fix}`}get fullFormattedValue(){return`${this.major}.${this.minor}.${this.fix}-pre.${this.build}`}}},8648:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(3448);t.VersionedExternalApiDispatcher=class{constructor(e,t){this._apiDelegateDispatcher=e,this._versionConverter=a.CreateExternalCompatibleVersionConverter(a.INTERNAL_CONTRACT_VERSION,t),this._notificationHandlers=[],e.registerNotificationHandler((e=>{if(0===this._notificationHandlers.length)return;const t=this._versionConverter.upgradeNotification(e);this._notificationHandlers.forEach((e=>{e(t)}))}))}static needsVersionConverter(e){return a.VersionLessThan(e,a.INTERNAL_CONTRACT_VERSION)}execute(e,t){try{const r=this._versionConverter.downgradeExecuteCall(e,t);return this._apiDelegateDispatcher.execute(r.verb,r.parameters).then((r=>this._versionConverter.upgradeExecuteReturn(r,e,t)))}catch(e){return Promise.reject(e)}}registerNotificationHandler(e){this._notificationHandlers.push(e)}unregisterNotificationHandler(e){this._notificationHandlers=this._notificationHandlers.filter((t=>t!==e))}}},6680:(e,t,r)=>{"use strict";var a;r.r(t),r.d(t,{NIL:()=>F,parse:()=>y,stringify:()=>c,v1:()=>g,v3:()=>P,v4:()=>_,v5:()=>C,validate:()=>o,version:()=>x});var i=new Uint8Array(16);function n(){if(!a&&!(a="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(i)}const s=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,o=function(e){return"string"==typeof e&&s.test(e)};for(var l=[],d=0;d<256;++d)l.push((d+256).toString(16).substr(1));const c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(l[e[t+0]]+l[e[t+1]]+l[e[t+2]]+l[e[t+3]]+"-"+l[e[t+4]]+l[e[t+5]]+"-"+l[e[t+6]]+l[e[t+7]]+"-"+l[e[t+8]]+l[e[t+9]]+"-"+l[e[t+10]]+l[e[t+11]]+l[e[t+12]]+l[e[t+13]]+l[e[t+14]]+l[e[t+15]]).toLowerCase();if(!o(r))throw TypeError("Stringified UUID is invalid");return r};var u,h,p=0,m=0;const g=function(e,t,r){var a=t&&r||0,i=t||new Array(16),s=(e=e||{}).node||u,o=void 0!==e.clockseq?e.clockseq:h;if(null==s||null==o){var l=e.random||(e.rng||n)();null==s&&(s=u=[1|l[0],l[1],l[2],l[3],l[4],l[5]]),null==o&&(o=h=16383&(l[6]<<8|l[7]))}var d=void 0!==e.msecs?e.msecs:Date.now(),g=void 0!==e.nsecs?e.nsecs:m+1,y=d-p+(g-m)/1e4;if(y<0&&void 0===e.clockseq&&(o=o+1&16383),(y<0||d>p)&&void 0===e.nsecs&&(g=0),g>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");p=d,m=g,h=o;var I=(1e4*(268435455&(d+=122192928e5))+g)%4294967296;i[a++]=I>>>24&255,i[a++]=I>>>16&255,i[a++]=I>>>8&255,i[a++]=255&I;var v=d/4294967296*1e4&268435455;i[a++]=v>>>8&255,i[a++]=255&v,i[a++]=v>>>24&15|16,i[a++]=v>>>16&255,i[a++]=o>>>8|128,i[a++]=255&o;for(var S=0;S<6;++S)i[a+S]=s[S];return t||c(i)},y=function(e){if(!o(e))throw TypeError("Invalid UUID");var t,r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r};function I(e,t,r){function a(e,a,i,n){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof a&&(a=y(a)),16!==a.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var s=new Uint8Array(16+e.length);if(s.set(a),s.set(e,a.length),(s=r(s))[6]=15&s[6]|t,s[8]=63&s[8]|128,i){n=n||0;for(var o=0;o<16;++o)i[n+o]=s[o];return i}return c(s)}try{a.name=e}catch(e){}return a.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",a.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",a}function v(e){return 14+(e+64>>>9<<4)+1}function S(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function T(e,t,r,a,i,n){return S((s=S(S(t,e),S(a,n)))<<(o=i)|s>>>32-o,r);var s,o}function b(e,t,r,a,i,n,s){return T(t&r|~t&a,e,t,i,n,s)}function f(e,t,r,a,i,n,s){return T(t&a|r&~a,e,t,i,n,s)}function E(e,t,r,a,i,n,s){return T(t^r^a,e,t,i,n,s)}function A(e,t,r,a,i,n,s){return T(r^(t|~a),e,t,i,n,s)}const P=I("v3",48,(function(e){if("string"==typeof e){var t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(var r=0;r<t.length;++r)e[r]=t.charCodeAt(r)}return function(e){for(var t=[],r=32*e.length,a="0123456789abcdef",i=0;i<r;i+=8){var n=e[i>>5]>>>i%32&255,s=parseInt(a.charAt(n>>>4&15)+a.charAt(15&n),16);t.push(s)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[v(t)-1]=t;for(var r=1732584193,a=-271733879,i=-1732584194,n=271733878,s=0;s<e.length;s+=16){var o=r,l=a,d=i,c=n;r=b(r,a,i,n,e[s],7,-680876936),n=b(n,r,a,i,e[s+1],12,-389564586),i=b(i,n,r,a,e[s+2],17,606105819),a=b(a,i,n,r,e[s+3],22,-1044525330),r=b(r,a,i,n,e[s+4],7,-176418897),n=b(n,r,a,i,e[s+5],12,1200080426),i=b(i,n,r,a,e[s+6],17,-1473231341),a=b(a,i,n,r,e[s+7],22,-45705983),r=b(r,a,i,n,e[s+8],7,1770035416),n=b(n,r,a,i,e[s+9],12,-1958414417),i=b(i,n,r,a,e[s+10],17,-42063),a=b(a,i,n,r,e[s+11],22,-1990404162),r=b(r,a,i,n,e[s+12],7,1804603682),n=b(n,r,a,i,e[s+13],12,-40341101),i=b(i,n,r,a,e[s+14],17,-1502002290),r=f(r,a=b(a,i,n,r,e[s+15],22,1236535329),i,n,e[s+1],5,-165796510),n=f(n,r,a,i,e[s+6],9,-1069501632),i=f(i,n,r,a,e[s+11],14,643717713),a=f(a,i,n,r,e[s],20,-373897302),r=f(r,a,i,n,e[s+5],5,-701558691),n=f(n,r,a,i,e[s+10],9,38016083),i=f(i,n,r,a,e[s+15],14,-660478335),a=f(a,i,n,r,e[s+4],20,-405537848),r=f(r,a,i,n,e[s+9],5,568446438),n=f(n,r,a,i,e[s+14],9,-1019803690),i=f(i,n,r,a,e[s+3],14,-187363961),a=f(a,i,n,r,e[s+8],20,1163531501),r=f(r,a,i,n,e[s+13],5,-1444681467),n=f(n,r,a,i,e[s+2],9,-51403784),i=f(i,n,r,a,e[s+7],14,1735328473),r=E(r,a=f(a,i,n,r,e[s+12],20,-1926607734),i,n,e[s+5],4,-378558),n=E(n,r,a,i,e[s+8],11,-2022574463),i=E(i,n,r,a,e[s+11],16,1839030562),a=E(a,i,n,r,e[s+14],23,-35309556),r=E(r,a,i,n,e[s+1],4,-1530992060),n=E(n,r,a,i,e[s+4],11,1272893353),i=E(i,n,r,a,e[s+7],16,-155497632),a=E(a,i,n,r,e[s+10],23,-1094730640),r=E(r,a,i,n,e[s+13],4,681279174),n=E(n,r,a,i,e[s],11,-358537222),i=E(i,n,r,a,e[s+3],16,-722521979),a=E(a,i,n,r,e[s+6],23,76029189),r=E(r,a,i,n,e[s+9],4,-640364487),n=E(n,r,a,i,e[s+12],11,-421815835),i=E(i,n,r,a,e[s+15],16,530742520),r=A(r,a=E(a,i,n,r,e[s+2],23,-995338651),i,n,e[s],6,-198630844),n=A(n,r,a,i,e[s+7],10,1126891415),i=A(i,n,r,a,e[s+14],15,-1416354905),a=A(a,i,n,r,e[s+5],21,-57434055),r=A(r,a,i,n,e[s+12],6,1700485571),n=A(n,r,a,i,e[s+3],10,-1894986606),i=A(i,n,r,a,e[s+10],15,-1051523),a=A(a,i,n,r,e[s+1],21,-2054922799),r=A(r,a,i,n,e[s+8],6,1873313359),n=A(n,r,a,i,e[s+15],10,-30611744),i=A(i,n,r,a,e[s+6],15,-1560198380),a=A(a,i,n,r,e[s+13],21,1309151649),r=A(r,a,i,n,e[s+4],6,-145523070),n=A(n,r,a,i,e[s+11],10,-1120210379),i=A(i,n,r,a,e[s+2],15,718787259),a=A(a,i,n,r,e[s+9],21,-343485551),r=S(r,o),a=S(a,l),i=S(i,d),n=S(n,c)}return[r,a,i,n]}(function(e){if(0===e.length)return[];for(var t=8*e.length,r=new Uint32Array(v(t)),a=0;a<t;a+=8)r[a>>5]|=(255&e[a/8])<<a%32;return r}(e),8*e.length))})),_=function(e,t,r){var a=(e=e||{}).random||(e.rng||n)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){r=r||0;for(var i=0;i<16;++i)t[r+i]=a[i];return t}return c(a)};function w(e,t,r,a){switch(e){case 0:return t&r^~t&a;case 1:case 3:return t^r^a;case 2:return t&r^t&a^r&a}}function D(e,t){return e<<t|e>>>32-t}const C=I("v5",80,(function(e){var t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var a=unescape(encodeURIComponent(e));e=[];for(var i=0;i<a.length;++i)e.push(a.charCodeAt(i))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var n=e.length/4+2,s=Math.ceil(n/16),o=new Array(s),l=0;l<s;++l){for(var d=new Uint32Array(16),c=0;c<16;++c)d[c]=e[64*l+4*c]<<24|e[64*l+4*c+1]<<16|e[64*l+4*c+2]<<8|e[64*l+4*c+3];o[l]=d}o[s-1][14]=8*(e.length-1)/Math.pow(2,32),o[s-1][14]=Math.floor(o[s-1][14]),o[s-1][15]=8*(e.length-1)&4294967295;for(var u=0;u<s;++u){for(var h=new Uint32Array(80),p=0;p<16;++p)h[p]=o[u][p];for(var m=16;m<80;++m)h[m]=D(h[m-3]^h[m-8]^h[m-14]^h[m-16],1);for(var g=r[0],y=r[1],I=r[2],v=r[3],S=r[4],T=0;T<80;++T){var b=Math.floor(T/20),f=D(g,5)+w(b,y,I,v)+S+t[b]+h[T]>>>0;S=v,v=I,I=D(y,30)>>>0,y=g,g=f}r[0]=r[0]+g>>>0,r[1]=r[1]+y>>>0,r[2]=r[2]+I>>>0,r[3]=r[3]+v>>>0,r[4]=r[4]+S>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]})),F="00000000-0000-0000-0000-000000000000",x=function(e){if(!o(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}},5892:e=>{"use strict";e.exports=JSON.parse('{"major":1,"minor":188,"fix":0}')}},t={};function r(a){var i=t[a];if(void 0!==i)return i.exports;var n=t[a]={exports:{}};return e[a].call(n.exports,n,n.exports,r),n.exports}r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};(()=>{"use strict";var e=a;Object.defineProperty(e,"__esModule",{value:!0});const t=r(5136),i=r(976),n=r(5408),s="undefined"!=typeof VERSION_IS_ALPHA&&VERSION_IS_ALPHA;t.ApiVersion.SetVersionNumber("1.15.0-pre.15",s);const o=new i.ExtensionsImpl;e.extensions=new n.Extensions(o);var l=r(7419);e.AnalyticsObjectType=l.AnalyticsObjectType,e.AnnotationType=l.AnnotationType,e.ClassNameKey=l.ClassNameKey,e.ColumnType=l.ColumnType,e.DashboardLayoutChange=l.DashboardLayoutChange,e.DashboardObjectType=l.DashboardObjectType,e.DashboardObjectVisibilityType=l.DashboardObjectVisibilityType,e.DataType=l.DataType,e.DateRangeType=l.DateRangeType,e.DialogStyle=l.DialogStyle,e.EncodingType=l.EncodingType,e.ErrorCodes=l.ErrorCodes,e.ExtensionContext=l.ExtensionContext,e.ExtensionMode=l.ExtensionMode,e.FieldAggregationType=l.FieldAggregationType,e.FieldRoleType=l.FieldRoleType,e.FilterDomainType=l.FilterDomainType,e.FilterNullOption=l.FilterNullOption,e.FilterType=l.FilterType,e.FilterUpdateType=l.FilterUpdateType,e.HierarchicalLevelSelectionState=l.HierarchicalLevelSelectionState,e.IncludeDataValuesOption=l.IncludeDataValuesOption,e.MarkType=l.MarkType,e.ParameterValueType=l.ParameterValueType,e.PeriodType=l.PeriodType,e.QuickTableCalcType=l.QuickTableCalcType,e.ReplaySpeedType=l.ReplaySpeedType,e.SelectionUpdateType=l.SelectionUpdateType,e.SelectOptions=l.SelectOptions,e.SheetType=l.SheetType,e.SortDirection=l.SortDirection,e.TableauEventType=l.TableauEventType,e.TrendLineModelType=l.TrendLineModelType,e.VizImageEncodingType=l.VizImageEncodingType,e.VizImagePaletteType=l.VizImagePaletteType,e.VizImageSizeSettingAlignmentType=l.VizImageSizeSettingAlignmentType,e.VizImageSizeSettingType=l.VizImageSizeSettingType,e.VizImageSortDirectionType=l.VizImageSortDirectionType,e.ZoneVisibilityType=l.ZoneVisibilityType})(),window.tableau=a})();
//# sourceMappingURL=tableau.extensions.1.15.0-pre.15.min.js.map